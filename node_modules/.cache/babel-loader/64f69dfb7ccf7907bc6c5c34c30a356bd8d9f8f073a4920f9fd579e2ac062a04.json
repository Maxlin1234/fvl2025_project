{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { gsap } from 'gsap';\nimport { ScrollTrigger } from 'gsap/ScrollTrigger';\nimport { onMounted, ref, nextTick } from 'vue';\ngsap.registerPlugin(ScrollTrigger);\nexport default {\n  name: 'PortfolioSection',\n  props: {\n    portfolioList: {\n      type: Array,\n      default: () => []\n    },\n    isEnglish: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup() {\n    const grid = ref(null);\n    const buildRowFadeIn = () => {\n      const container = grid.value;\n      if (!container) return;\n      const items = Array.from(container.querySelectorAll('.portfolio-item'));\n      if (!items.length) return;\n\n      // 初始狀態\n      gsap.set(items, {\n        opacity: 0,\n        y: 24\n      });\n\n      // 依 offsetTop 分組為各「行」\n      const rows = [];\n      const rowMap = new Map();\n      items.forEach(el => {\n        const top = Math.round(el.offsetTop);\n        if (!rowMap.has(top)) rowMap.set(top, []);\n        rowMap.get(top).push(el);\n      });\n      // 由上到下排序\n      Array.from(rowMap.keys()).sort((a, b) => a - b).forEach(k => rows.push(rowMap.get(k)));\n\n      // 建立逐行淡入動畫\n      const tl = gsap.timeline({\n        scrollTrigger: {\n          trigger: '#portfolio',\n          start: 'top 80%',\n          once: true\n        }\n      });\n      rows.forEach((rowEls, i) => {\n        tl.to(rowEls, {\n          opacity: 1,\n          y: 0,\n          duration: 0.6,\n          ease: 'power2.out',\n          stagger: 0.08\n        }, i * 0.18); // 每行間隔\n      });\n    };\n    onMounted(async () => {\n      await nextTick();\n      // 等圖片載入以取得正確 offsetTop\n      const images = grid.value ? Array.from(grid.value.querySelectorAll('img')) : [];\n      const waitAll = images.map(img => new Promise(resolve => {\n        if (img.complete) return resolve();\n        img.addEventListener('load', resolve, {\n          once: true\n        });\n        img.addEventListener('error', resolve, {\n          once: true\n        });\n      }));\n      Promise.all(waitAll).then(() => buildRowFadeIn());\n      // 視窗尺寸改變時重新建立（避免斷行變化）\n      window.addEventListener('resize', buildRowFadeIn, {\n        passive: true\n      });\n    });\n    return {\n      grid\n    };\n  },\n  methods: {\n    cacheWork(item) {\n      try {\n        const key = `work_${item.id}`;\n        localStorage.setItem(key, JSON.stringify(item));\n        const lang = localStorage.getItem('lang');\n        if (!lang) {\n          localStorage.setItem('lang', this.isEnglish ? 'en' : 'zh');\n        }\n      } catch (e) {\n        console.error('Failed to cache work detail:', e);\n      }\n    }\n  }\n};","map":{"version":3,"names":["gsap","ScrollTrigger","onMounted","ref","nextTick","registerPlugin","name","props","portfolioList","type","Array","default","isEnglish","Boolean","setup","grid","buildRowFadeIn","container","value","items","from","querySelectorAll","length","set","opacity","y","rows","rowMap","Map","forEach","el","top","Math","round","offsetTop","has","get","push","keys","sort","a","b","k","tl","timeline","scrollTrigger","trigger","start","once","rowEls","i","to","duration","ease","stagger","images","waitAll","map","img","Promise","resolve","complete","addEventListener","all","then","window","passive","methods","cacheWork","item","key","id","localStorage","setItem","JSON","stringify","lang","getItem","e","console","error"],"sources":["/Users/linhankuan/fvl2025/src/components/PortfolioSection.vue"],"sourcesContent":["<template>\n  <section id=\"portfolio\" class=\"portfolio\">\n    <div class=\"container\">\n      <h2 class=\"section-title\">{{ isEnglish ? 'Screening Works' : '播映作品' }}</h2>\n      <div class=\"portfolio-grid\" ref=\"grid\">\n        <div class=\"portfolio-item\" v-for=\"(item, idx) in portfolioList\" :key=\"idx\">\n          <a :href=\"`/works/${item.id}`\" target=\"_blank\" rel=\"noopener\" @click=\"cacheWork(item)\">\n            <div class=\"portfolio-image\" style=\"height: 100%;\">\n              <img :src=\"'https://unzip-clab-api.clab.org.tw/' + item.photo_1\" :alt=\"item.title\" style=\"width: 100%;height: 100%;\">\n            </div>\n            <div class=\"portfolio-overlay\">\n              <h3>{{ isEnglish ? item.work_en.title : item.work_zh.title }}</h3>\n              <p>{{ isEnglish ? item.work_zh.title : item.work_en.title }}</p>\n            </div>\n          </a>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport { gsap } from 'gsap';\nimport { ScrollTrigger } from 'gsap/ScrollTrigger';\nimport { onMounted, ref, nextTick } from 'vue';\n\ngsap.registerPlugin(ScrollTrigger);\n\nexport default {\n  name: 'PortfolioSection',\n  props: {\n    portfolioList: {\n      type: Array,\n      default: () => []\n    },\n    isEnglish: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup() {\n    const grid = ref(null);\n\n    const buildRowFadeIn = () => {\n      const container = grid.value;\n      if (!container) return;\n      const items = Array.from(container.querySelectorAll('.portfolio-item'));\n      if (!items.length) return;\n\n      // 初始狀態\n      gsap.set(items, { opacity: 0, y: 24 });\n\n      // 依 offsetTop 分組為各「行」\n      const rows = [];\n      const rowMap = new Map();\n      items.forEach((el) => {\n        const top = Math.round(el.offsetTop);\n        if (!rowMap.has(top)) rowMap.set(top, []);\n        rowMap.get(top).push(el);\n      });\n      // 由上到下排序\n      Array.from(rowMap.keys()).sort((a,b)=>a-b).forEach((k)=> rows.push(rowMap.get(k)));\n\n      // 建立逐行淡入動畫\n      const tl = gsap.timeline({\n        scrollTrigger: {\n          trigger: '#portfolio',\n          start: 'top 80%',\n          once: true\n        }\n      });\n\n      rows.forEach((rowEls, i) => {\n        tl.to(rowEls, {\n          opacity: 1,\n          y: 0,\n          duration: 0.6,\n          ease: 'power2.out',\n          stagger: 0.08\n        }, i * 0.18); // 每行間隔\n      });\n    };\n\n    onMounted(async () => {\n      await nextTick();\n      // 等圖片載入以取得正確 offsetTop\n      const images = grid.value ? Array.from(grid.value.querySelectorAll('img')) : [];\n      const waitAll = images.map(img => new Promise(resolve => {\n        if (img.complete) return resolve();\n        img.addEventListener('load', resolve, { once: true });\n        img.addEventListener('error', resolve, { once: true });\n      }));\n      Promise.all(waitAll).then(() => buildRowFadeIn());\n      // 視窗尺寸改變時重新建立（避免斷行變化）\n      window.addEventListener('resize', buildRowFadeIn, { passive: true });\n    });\n\n    return { grid };\n  },\n  methods: {\n    cacheWork(item) {\n      try {\n        const key = `work_${item.id}`;\n        localStorage.setItem(key, JSON.stringify(item));\n        const lang = localStorage.getItem('lang');\n        if (!lang) {\n          localStorage.setItem('lang', this.isEnglish ? 'en' : 'zh');\n        }\n      } catch (e) {\n        console.error('Failed to cache work detail:', e);\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.portfolio {\n  background: #000000;\n  padding: 80px 0;\n}\n\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 30px 20px 120px;\n  color: #fff;\n}\n\n.section-title {\n  text-align: center;\n  font-size: 2.5rem;\n  margin-bottom: 40px;\n  color: #ffffff;\n}\n\n.portfolio-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 30px;\n}\n\n.portfolio-item {\n  height: 350px;\n  position: relative;\n  border-radius: 15px;\n  overflow: hidden;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n  /* 初始淡入狀態由JS設定 */\n}\n\n.portfolio-image img {\n  width: 100%;\n  object-fit: cover;\n}\n\n.portfolio-overlay {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));\n  color: white;\n  padding: 30px 20px 20px;\n  transform: translateY(100%);\n  transition: transform 0.3s ease;\n}\n\n.portfolio-item.portfolio-overlay {\n  transform: translateY(0);\n}\n\n.portfolio-overlay h3 {\n  margin-bottom: 10px;\n}\n\n.portfolio-overlay p {\n  margin: 0;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}