{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*!\n * PathEditor 3.13.0\n * https://gsap.com\n *\n * Copyright 2008-2025, GreenSock. All rights reserved.\n * Subject to the terms at https://gsap.com/standard-license\n * @author: Jack Doyle, jack@greensock.com\n*/\n/* eslint-disable */\n\nimport { stringToRawPath, rawPathToString, bezierToPoints, simplifyPoints, pointsToSegment, subdivideSegment, getClosestData, copyRawPath, transformRawPath } from \"./paths.js\";\nimport { getGlobalMatrix, Matrix2D } from \"./matrix.js\";\nlet _numbersExp = /(?:(-)?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[0-9]/ig,\n  _doc,\n  _supportsPointer,\n  _win,\n  _body,\n  gsap,\n  _context,\n  _selectionColor = \"#4e7fff\",\n  _minimumMovement = 1,\n  _DEG2RAD = Math.PI / 180,\n  _getTime = Date.now || (() => new Date().getTime()),\n  _lastInteraction = 0,\n  _isPressed = 0,\n  _emptyFunc = () => false,\n  _interacted = () => _lastInteraction = _getTime(),\n  _CTRL,\n  _ALT,\n  _SHIFT,\n  _CMD,\n  _recentlyAddedAnchor,\n  _editingAxis = {},\n  //stores the x/y of the most recently-selected anchor point's x and y axis. We tap into this for snapping horizontally and vertically.\n  _history = [],\n  _point = {},\n  //reuse to minimize memory and maximize performance (mostly for snapping)\n  _temp = [],\n  //reuse this in places like getNormalizedSVG() to conserve memory\n  _comma = \",\",\n  _selectedPaths = [],\n  _preventDefault = event => {\n    if (event.preventDefault) {\n      event.preventDefault();\n      if (event.preventManipulation) {\n        event.preventManipulation(); //for some Microsoft browsers\n      }\n    }\n  },\n  _createElement = type => _doc.createElementNS ? _doc.createElementNS(\"http://www.w3.org/1999/xhtml\", type) : _doc.createElement(type),\n  _createSVG = (type, container, attributes) => {\n    let element = _doc.createElementNS(\"http://www.w3.org/2000/svg\", type),\n      reg = /([a-z])([A-Z])/g,\n      p;\n    attributes = attributes || {};\n    attributes.class = attributes.class || \"path-editor\";\n    for (p in attributes) {\n      if (element.style[p] !== undefined) {\n        element.style[p] = attributes[p];\n      } else {\n        element.setAttributeNS(null, p.replace(reg, \"$1-$2\").toLowerCase(), attributes[p]);\n      }\n    }\n    container.appendChild(element);\n    return element;\n  },\n  _identityMatrixObject = {\n    matrix: new Matrix2D()\n  },\n  _getConsolidatedMatrix = target => (target.transform && target.transform.baseVal.consolidate() || _identityMatrixObject).matrix,\n  _getConcatenatedTransforms = target => {\n    let m = _getConsolidatedMatrix(target),\n      owner = target.ownerSVGElement;\n    while ((target = target.parentNode) && target.ownerSVGElement === owner) {\n      m.multiply(_getConsolidatedMatrix(target));\n    }\n    return \"matrix(\" + m.a + \",\" + m.b + \",\" + m.c + \",\" + m.d + \",\" + m.e + \",\" + m.f + \")\";\n  },\n  _addHistory = pathEditor => {\n    let selectedIndexes = [],\n      a = pathEditor._selectedAnchors,\n      i;\n    for (i = 0; i < a.length; i++) {\n      selectedIndexes[i] = a[i].i;\n    }\n    _history.unshift({\n      path: pathEditor,\n      d: pathEditor.path.getAttribute(\"d\"),\n      transform: pathEditor.path.getAttribute(\"transform\") || \"\",\n      selectedIndexes: selectedIndexes\n    });\n    if (_history.length > 30) {\n      _history.length = 30;\n    }\n  },\n  _round = value => ~~(value * 1000 + (value < 0 ? -.5 : .5)) / 1000,\n  _getSquarePathData = size => {\n    size = _round(size);\n    return [\"M-\" + size, -size, size, -size, size, size, -size, size + \"z\"].join(_comma);\n  },\n  _getCirclePathData = size => {\n    let circ = 0.552284749831,\n      rcirc = _round(size * circ);\n    size = _round(size);\n    return \"M\" + size + \",0C\" + [size, rcirc, rcirc, size, 0, size, -rcirc, size, -size, rcirc, -size, 0, -size, -rcirc, -rcirc, -size, 0, -size, rcirc, -size, size, -rcirc, size, 0].join(_comma) + \"z\";\n  },\n  _checkDeselect = function (e) {\n    if (!e.target._gsSelection && !_isPressed && _getTime() - _lastInteraction > 100) {\n      let i = _selectedPaths.length;\n      while (--i > -1) {\n        _selectedPaths[i].deselect();\n      }\n      _selectedPaths.length = 0;\n    }\n  },\n  _tempDiv,\n  _touchEventLookup,\n  _isMultiTouching = 0,\n  _addListener = (element, type, func, capture) => {\n    if (element.addEventListener) {\n      let touchType = _touchEventLookup[type];\n      capture = capture || {\n        passive: false\n      };\n      element.addEventListener(touchType || type, func, capture);\n      if (touchType && type !== touchType && touchType.substr(0, 7) !== \"pointer\") {\n        //some browsers actually support both, so must we. But pointer events cover all.\n        element.addEventListener(type, func, capture);\n      }\n    } else if (element.attachEvent) {\n      element.attachEvent(\"on\" + type, func);\n    }\n  },\n  _removeListener = (element, type, func) => {\n    if (element.removeEventListener) {\n      let touchType = _touchEventLookup[type];\n      element.removeEventListener(touchType || type, func);\n      if (touchType && type !== touchType && touchType.substr(0, 7) !== \"pointer\") {\n        element.removeEventListener(type, func);\n      }\n    } else if (element.detachEvent) {\n      element.detachEvent(\"on\" + type, func);\n    }\n  },\n  _hasTouchID = (list, ID) => {\n    let i = list.length;\n    while (--i > -1) {\n      if (list[i].identifier === ID) {\n        return true;\n      }\n    }\n    return false;\n  },\n  _onMultiTouchDocumentEnd = e => {\n    _isMultiTouching = e.touches && _dragCount < e.touches.length;\n    _removeListener(e.target, \"touchend\", _onMultiTouchDocumentEnd);\n  },\n  _onMultiTouchDocument = e => {\n    _isMultiTouching = e.touches && _dragCount < e.touches.length;\n    _addListener(e.target, \"touchend\", _onMultiTouchDocumentEnd);\n  },\n  _bind = (func, scope) => e => func.call(scope, e),\n  _callback = (type, self, param) => {\n    let callback = self.vars[type];\n    if (callback) {\n      callback.call(self.vars.callbackScope || self, param || self);\n    }\n    return self;\n  },\n  _copyElement,\n  _resetSelection = () => {\n    _copyElement.style.display = \"block\";\n    _copyElement.select();\n    _copyElement.style.display = \"none\";\n  },\n  _coreInitted,\n  _initCore = core => {\n    _doc = document;\n    _win = window;\n    _body = _doc.body;\n    gsap = gsap || core || _win.gsap || console.warn(\"Please gsap.registerPlugin(PathEditor)\");\n    _context = gsap && gsap.core.context || function () {};\n    _tempDiv = _createElement(\"div\");\n    _copyElement = _createElement(\"textarea\");\n    _copyElement.style.display = \"none\";\n    _body && _body.appendChild(_copyElement);\n    _touchEventLookup = function (types) {\n      //we create an object that makes it easy to translate touch event types into their \"pointer\" counterparts if we're in a browser that uses those instead. Like IE10 uses \"MSPointerDown\" instead of \"touchstart\", for example.\n      let standard = types.split(\",\"),\n        converted = (_tempDiv.onpointerdown !== undefined ? \"pointerdown,pointermove,pointerup,pointercancel\" : _tempDiv.onmspointerdown !== undefined ? \"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel\" : types).split(\",\"),\n        obj = {},\n        i = 4;\n      while (--i > -1) {\n        obj[standard[i]] = converted[i];\n        obj[converted[i]] = standard[i];\n      }\n      return obj;\n    }(\"touchstart,touchmove,touchend,touchcancel\");\n    SVGElement.prototype.getTransformToElement = SVGElement.prototype.getTransformToElement || function (e) {\n      //adds Chrome support\n      return e.getScreenCTM().inverse().multiply(this.getScreenCTM());\n    };\n    _doc.addEventListener(\"keydown\", function (e) {\n      let key = e.keyCode || e.which,\n        keyString = e.key || key,\n        i,\n        state,\n        a,\n        path;\n      if (keyString === \"Shift\" || key === 16) {\n        _SHIFT = true;\n      } else if (keyString === \"Control\" || key === 17) {\n        _CTRL = true;\n      } else if (keyString === \"Meta\" || key === 91) {\n        _CMD = true;\n      } else if (keyString === \"Alt\" || key === 18) {\n        _ALT = true;\n        i = _selectedPaths.length;\n        while (--i > -1) {\n          _selectedPaths[i]._onPressAlt();\n        }\n      } else if ((keyString === \"z\" || key === 90) && (_CTRL || _CMD) && _history.length > 1) {\n        //UNDO\n        _history.shift();\n        state = _history[0];\n        if (state) {\n          path = state.path;\n          path.path.setAttribute(\"d\", state.d);\n          path.path.setAttribute(\"transform\", state.transform);\n          path.init();\n          a = path._anchors;\n          for (i = 0; i < a.length; i++) {\n            if (state.selectedIndexes.indexOf(a[i].i) !== -1) {\n              path._selectedAnchors.push(a[i]);\n            }\n          }\n          path._updateAnchors();\n          path.update();\n          if (path.vars.onUndo) {\n            path.vars.onUndo.call(path);\n          }\n        }\n      } else if (keyString === \"Delete\" || keyString === \"Backspace\" || key === 8 || key === 46 || key === 63272 || key === \"d\" && (_CTRL || _CMD)) {\n        //DELETE\n        i = _selectedPaths.length;\n        while (--i > -1) {\n          _selectedPaths[i]._deleteSelectedAnchors();\n        }\n      } else if ((keyString === \"a\" || key === 65) && (_CMD || _CTRL)) {\n        //SELECT ALL\n        i = _selectedPaths.length;\n        while (--i > -1) {\n          _selectedPaths[i].select(true);\n        }\n      }\n    }, true);\n    _doc.addEventListener(\"keyup\", function (e) {\n      let key = e.key || e.keyCode || e.which;\n      if (key === \"Shift\" || key === 16) {\n        _SHIFT = false;\n      } else if (key === \"Control\" || key === 17) {\n        _CTRL = false;\n      } else if (key === \"Meta\" || key === 91) {\n        _CMD = false;\n      } else if (key === \"Alt\" || key === 18) {\n        _ALT = false;\n        let i = _selectedPaths.length;\n        while (--i > -1) {\n          _selectedPaths[i]._onReleaseAlt();\n        }\n      }\n    }, true);\n    _supportsPointer = !!_win.PointerEvent;\n    _addListener(_doc, \"mouseup\", _checkDeselect);\n    _addListener(_doc, \"touchend\", _checkDeselect);\n    _addListener(_doc, \"touchcancel\", _emptyFunc); //some older Android devices intermittently stop dispatching \"touchmove\" events if we don't listen for \"touchcancel\" on the document. Very strange indeed.\n    _addListener(_win, \"touchmove\", _emptyFunc); //works around Safari bugs that still allow the page to scroll even when we preventDefault() on the touchmove event.\n    _body && _body.addEventListener(\"touchstart\", _emptyFunc); //works around Safari bug: https://gsap.com/forums/topic/21450-draggable-in-iframe-on-mobile-is-buggy/\n    _coreInitted = 1;\n  },\n  _onPress = function (e) {\n    let self = this,\n      ctm = getGlobalMatrix(self.target.parentNode, true),\n      //previously used self.target.parentNode.getScreenCTM().inverse() but there's a major bug in Firefox that prevents it from working properly when there's an ancestor with a transform applied, so we bootstrapped our own solution that seems to work great across all browsers.\n      touchEventTarget,\n      temp;\n    this._matrix = this.target.transform.baseVal.getItem(0).matrix;\n    this._ctm = ctm;\n    if (_touchEventLookup[e.type]) {\n      //note: on iOS, BOTH touchmove and mousemove are dispatched, but the mousemove has pageY and pageX of 0 which would mess up the calculations and needlessly hurt performance.\n      touchEventTarget = e.type.indexOf(\"touch\") !== -1 ? e.currentTarget || e.target : _doc; //pointer-based touches (for Microsoft browsers) don't remain locked to the original target like other browsers, so we must use the document instead. The event type would be \"MSPointerDown\" or \"pointerdown\".\n      _addListener(touchEventTarget, \"touchend\", self._onRelease);\n      _addListener(touchEventTarget, \"touchmove\", self._onMove);\n      _addListener(touchEventTarget, \"touchcancel\", self._onRelease);\n      _addListener(_doc, \"touchstart\", _onMultiTouchDocument);\n      _addListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n    } else {\n      touchEventTarget = null;\n      _addListener(_doc, \"mousemove\", self._onMove); //attach these to the document instead of the box itself so that if the user's mouse moves too quickly (and off of the box), things still work.\n    }\n    if (!_supportsPointer) {\n      _addListener(_doc, \"mouseup\", self._onRelease);\n    }\n    _preventDefault(e);\n    _resetSelection(); // when a PathEditor is in an iframe in an environment like codepen, this helps avoid situations where the DELETE key won't actually work because the parent frame is intercepting the event.\n    if (e.changedTouches) {\n      //touch events store the data slightly differently\n      e = self.touch = e.changedTouches[0];\n      self.touchID = e.identifier;\n    } else if (e.pointerId) {\n      self.touchID = e.pointerId; //for some Microsoft browsers\n    } else {\n      self.touch = self.touchID = null;\n    }\n    self._startPointerY = self.pointerY = e.pageY; //record the starting x and y so that we can calculate the movement from the original in _onMouseMove\n    self._startPointerX = self.pointerX = e.pageX;\n    self._startElementX = self._matrix.e;\n    self._startElementY = self._matrix.f;\n    if (this._ctm.a === 1 && this._ctm.b === 0 && this._ctm.c === 0 && this._ctm.d === 1) {\n      this._ctm = null;\n    } else {\n      temp = self._startPointerX * this._ctm.a + self._startPointerY * this._ctm.c + this._ctm.e;\n      self._startPointerY = self._startPointerX * this._ctm.b + self._startPointerY * this._ctm.d + this._ctm.f;\n      self._startPointerX = temp;\n    }\n    self.isPressed = _isPressed = true;\n    self.touchEventTarget = touchEventTarget;\n    if (self.vars.onPress) {\n      self.vars.onPress.call(self.vars.callbackScope || self, self.pointerEvent);\n    }\n  },\n  _onMove = function (e) {\n    let self = this,\n      originalEvent = e,\n      touches,\n      i;\n    if (!self._enabled || _isMultiTouching || !self.isPressed || !e) {\n      return;\n    }\n    self.pointerEvent = e;\n    touches = e.changedTouches;\n    if (touches) {\n      //touch events store the data slightly differently\n      e = touches[0];\n      if (e !== self.touch && e.identifier !== self.touchID) {\n        //Usually changedTouches[0] will be what we're looking for, but in case it's not, look through the rest of the array...(and Android browsers don't reuse the event like iOS)\n        i = touches.length;\n        while (--i > -1 && (e = touches[i]).identifier !== self.touchID) {}\n        if (i < 0) {\n          return;\n        }\n      }\n    } else if (e.pointerId && self.touchID && e.pointerId !== self.touchID) {\n      //for some Microsoft browsers, we must attach the listener to the doc rather than the trigger so that when the finger moves outside the bounds of the trigger, things still work. So if the event we're receiving has a pointerId that doesn't match the touchID, ignore it (for multi-touch)\n      return;\n    }\n    _preventDefault(originalEvent);\n    self.setPointerPosition(e.pageX, e.pageY);\n    if (self.vars.onDrag) {\n      self.vars.onDrag.call(self.vars.callbackScope || self, self.pointerEvent);\n    }\n  },\n  _onRelease = function (e, force) {\n    let self = this;\n    if (!self._enabled || !self.isPressed || e && self.touchID != null && !force && (e.pointerId && e.pointerId !== self.touchID || e.changedTouches && !_hasTouchID(e.changedTouches, self.touchID))) {\n      //for some Microsoft browsers, we must attach the listener to the doc rather than the trigger so that when the finger moves outside the bounds of the trigger, things still work. So if the event we're receiving has a pointerId that doesn't match the touchID, ignore it (for multi-touch)\n      return;\n    }\n    _interacted();\n    self.isPressed = _isPressed = false; //TODO: if we want to accommodate multi-touch, we'd need to introduce a counter to track how many touches there are and only toggle this when they're all off.\n    let originalEvent = e,\n      wasDragging = self.isDragging,\n      touchEventTarget = self.touchEventTarget,\n      touches,\n      i;\n    if (touchEventTarget) {\n      _removeListener(touchEventTarget, \"touchend\", self._onRelease);\n      _removeListener(touchEventTarget, \"touchmove\", self._onMove);\n      _removeListener(touchEventTarget, \"touchcancel\", self._onRelease);\n      _removeListener(_doc, \"touchstart\", _onMultiTouchDocument);\n    } else {\n      _removeListener(_doc, \"mousemove\", self._onMove);\n    }\n    if (!_supportsPointer) {\n      _removeListener(_doc, \"mouseup\", self._onRelease);\n      if (e && e.target) {\n        _removeListener(e.target, \"mouseup\", self._onRelease);\n      }\n    }\n    if (wasDragging) {\n      self.isDragging = false;\n    } else if (self.vars.onClick) {\n      self.vars.onClick.call(self.vars.callbackScope || self, originalEvent);\n    }\n    if (e) {\n      touches = e.changedTouches;\n      if (touches) {\n        //touch events store the data slightly differently\n        e = touches[0];\n        if (e !== self.touch && e.identifier !== self.touchID) {\n          //Usually changedTouches[0] will be what we're looking for, but in case it's not, look through the rest of the array...(and Android browsers don't reuse the event like iOS)\n          i = touches.length;\n          while (--i > -1 && (e = touches[i]).identifier !== self.touchID) {}\n          if (i < 0) {\n            return;\n          }\n        }\n      }\n      self.pointerEvent = originalEvent;\n      self.pointerX = e.pageX;\n      self.pointerY = e.pageY;\n    }\n    if (originalEvent && !wasDragging && self.vars.onDragRelease) {\n      self.vars.onDragRelease.call(self, self.pointerEvent);\n    } else {\n      if (originalEvent) {\n        _preventDefault(originalEvent);\n      }\n      if (self.vars.onRelease) {\n        self.vars.onRelease.call(self.vars.callbackScope || self, self.pointerEvent);\n      }\n    }\n    if (wasDragging && self.vars.onDragEnd) {\n      self.vars.onDragEnd.call(self.vars.callbackScope || self, self.pointerEvent);\n    }\n    return true;\n  },\n  _createSegmentAnchors = (rawPath, j, editor, vars) => {\n    let segment = rawPath[j],\n      l = segment.length - (segment.closed ? 6 : 0),\n      a = [],\n      i;\n    for (i = 0; i < l; i += 6) {\n      a.push(new Anchor(editor, rawPath, j, i, vars));\n    }\n    segment.closed && (a[0].isClosedStart = true);\n    return a;\n  },\n  _getLength = (segment, i, i2) => {\n    //i is the starting index, and it'll return the length to the next x/y pair. So if you're looking for the length to handle1, you'd feed in the index of the handle control point x whereas if you're looking for the length to handle2, i would be the x of the anchor.\n    let x = segment[i2] - segment[i],\n      y = segment[i2 + 1] - segment[i + 1];\n    return Math.sqrt(x * x + y * y);\n  };\nclass DraggableSVG {\n  constructor(target, vars) {\n    this.target = typeof target === \"string\" ? _doc.querySelectorAll(target)[0] : target;\n    this.vars = vars || {};\n    this._onPress = _bind(_onPress, this);\n    this._onMove = _bind(_onMove, this);\n    this._onRelease = _bind(_onRelease, this);\n    this.target.setAttribute(\"transform\", (this.target.getAttribute(\"transform\") || \"\") + \" translate(0,0)\");\n    this._matrix = _getConsolidatedMatrix(this.target);\n    this.x = this._matrix.e;\n    this.y = this._matrix.f;\n    this.snap = vars.snap;\n    if (!isNaN(vars.maxX) || !isNaN(vars.minX)) {\n      this._bounds = 1;\n      this.maxX = +vars.maxX;\n      this.minX = +vars.minX;\n    } else {\n      this._bounds = 0;\n    }\n    this.enabled(true);\n  }\n  setPointerPosition(pointerX, pointerY) {\n    let rnd = 1000,\n      xChange,\n      yChange,\n      x,\n      y,\n      temp;\n    this.pointerX = pointerX;\n    this.pointerY = pointerY;\n    if (this._ctm) {\n      temp = pointerX * this._ctm.a + pointerY * this._ctm.c + this._ctm.e;\n      pointerY = pointerX * this._ctm.b + pointerY * this._ctm.d + this._ctm.f;\n      pointerX = temp;\n    }\n    yChange = pointerY - this._startPointerY;\n    xChange = pointerX - this._startPointerX;\n    if (yChange < _minimumMovement && yChange > -_minimumMovement) {\n      yChange = 0;\n    }\n    if (xChange < _minimumMovement && xChange > -_minimumMovement) {\n      xChange = 0;\n    }\n    x = ((this._startElementX + xChange) * rnd | 0) / rnd;\n    y = ((this._startElementY + yChange) * rnd | 0) / rnd;\n    if (this.snap && !_SHIFT) {\n      _point.x = x;\n      _point.y = y;\n      this.snap.call(this, _point);\n      x = _point.x;\n      y = _point.y;\n    }\n    if (this.x !== x || this.y !== y) {\n      this._matrix.f = this.y = y;\n      this._matrix.e = this.x = x;\n      if (!this.isDragging && this.isPressed) {\n        this.isDragging = true;\n        _callback(\"onDragStart\", this, this.pointerEvent);\n      }\n    }\n  }\n  enabled(enabled) {\n    if (!arguments.length) {\n      return this._enabled;\n    }\n    let dragging;\n    this._enabled = enabled;\n    if (enabled) {\n      if (!_supportsPointer) {\n        _addListener(this.target, \"mousedown\", this._onPress);\n      }\n      _addListener(this.target, \"touchstart\", this._onPress);\n      _addListener(this.target, \"click\", this._onClick, true); //note: used to pass true for capture but it prevented click-to-play-video functionality in Firefox.\n    } else {\n      dragging = this.isDragging;\n      _removeListener(this.target, \"mousedown\", this._onPress);\n      _removeListener(this.target, \"touchstart\", this._onPress);\n      _removeListener(_win, \"touchforcechange\", _preventDefault);\n      _removeListener(this.target, \"click\", this._onClick);\n      if (this.touchEventTarget) {\n        _removeListener(this.touchEventTarget, \"touchcancel\", this._onRelease);\n        _removeListener(this.touchEventTarget, \"touchend\", this._onRelease);\n        _removeListener(this.touchEventTarget, \"touchmove\", this._onMove);\n      }\n      _removeListener(_doc, \"mouseup\", this._onRelease);\n      _removeListener(_doc, \"mousemove\", this._onMove);\n      this.isDragging = this.isPressed = false;\n      if (dragging) {\n        _callback(\"onDragEnd\", this, this.pointerEvent);\n      }\n    }\n    return this;\n  }\n  endDrag(e) {\n    this._onRelease(e);\n  }\n}\nclass Anchor {\n  constructor(editor, rawPath, j, i, vars) {\n    this.editor = editor;\n    this.element = _createSVG(\"path\", editor._selection, {\n      fill: _selectionColor,\n      stroke: _selectionColor,\n      strokeWidth: 2,\n      vectorEffect: \"non-scaling-stroke\"\n    });\n    this.update(rawPath, j, i);\n    this.element._gsSelection = true;\n    this.vars = vars || {};\n    this._draggable = new DraggableSVG(this.element, {\n      callbackScope: this,\n      onDrag: this.onDrag,\n      snap: this.vars.snap,\n      onPress: this.onPress,\n      onRelease: this.onRelease,\n      onClick: this.onClick,\n      onDragEnd: this.onDragEnd\n    });\n  }\n  onPress() {\n    _callback(\"onPress\", this);\n  }\n  onClick() {\n    _callback(\"onClick\", this);\n  }\n  onDrag() {\n    let s = this.segment;\n    this.vars.onDrag.call(this.vars.callbackScope || this, this, this._draggable.x - s[this.i], this._draggable.y - s[this.i + 1]);\n  }\n  onDragEnd() {\n    _callback(\"onDragEnd\", this);\n  }\n  onRelease() {\n    _callback(\"onRelease\", this);\n  }\n  update(rawPath, j, i) {\n    if (rawPath) {\n      this.rawPath = rawPath;\n    }\n    if (arguments.length <= 1) {\n      j = this.j;\n      i = this.i;\n    } else {\n      this.j = j;\n      this.i = i;\n    }\n    let prevSmooth = this.smooth,\n      segment = this.rawPath[j],\n      pi = i === 0 && segment.closed ? segment.length - 4 : i - 2;\n    this.segment = segment;\n    this.smooth = i > 0 && i < segment.length - 2 && Math.abs(Math.atan2(segment[i + 1] - segment[pi + 1], segment[i] - segment[pi]) - Math.atan2(segment[i + 3] - segment[i + 1], segment[i + 2] - segment[i])) < 0.09 ? 2 : 0; //0: corner, 1: smooth but not mirrored, 2: smooth and mirrored.\n    if (this.smooth !== prevSmooth) {\n      this.element.setAttribute(\"d\", this.smooth ? this.editor._circleHandle : this.editor._squareHandle);\n    }\n    this.element.setAttribute(\"transform\", \"translate(\" + segment[i] + \",\" + segment[i + 1] + \")\");\n  }\n}\nexport class PathEditor {\n  constructor(target, vars) {\n    vars = vars || {};\n    _coreInitted || _initCore();\n    this.vars = vars;\n    this.path = typeof target === \"string\" ? _doc.querySelectorAll(target)[0] : target;\n    this._g = _createSVG(\"g\", this.path.ownerSVGElement, {\n      class: \"path-editor-g path-editor\"\n    });\n    this._selectionHittest = _createSVG(\"path\", this._g, {\n      stroke: \"transparent\",\n      strokeWidth: 16,\n      fill: \"none\",\n      vectorEffect: \"non-scaling-stroke\"\n    });\n    this._selection = vars._selection || _createSVG(\"g\", this._g, {\n      class: \"path-editor-selection path-editor\"\n    });\n    this._selectionPath = _createSVG(\"path\", this._selection, {\n      stroke: _selectionColor,\n      strokeWidth: 2,\n      fill: \"none\",\n      vectorEffect: \"non-scaling-stroke\"\n    });\n    this._selectedAnchors = [];\n    this._line1 = _createSVG(\"polyline\", this._selection, {\n      stroke: _selectionColor,\n      strokeWidth: 2,\n      vectorEffect: \"non-scaling-stroke\"\n    });\n    this._line2 = _createSVG(\"polyline\", this._selection, {\n      stroke: _selectionColor,\n      strokeWidth: 2,\n      vectorEffect: \"non-scaling-stroke\"\n    });\n    this._line1.style.pointerEvents = this._line2.style.pointerEvents = this._selectionPath.style.pointerEvents = \"none\";\n    this._enabled = true;\n    let ctm = this.path.parentNode.getScreenCTM().inverse(),\n      size = (ctm.a + ctm.d) / 2 * (vars.handleSize || 5);\n    this._squareHandle = _getSquarePathData(size);\n    this._circleHandle = _getCirclePathData(size * 1.15);\n    this._handle1 = _createSVG(\"path\", this._selection, {\n      d: this._squareHandle,\n      fill: _selectionColor,\n      stroke: \"transparent\",\n      strokeWidth: 6\n    });\n    this._handle2 = _createSVG(\"path\", this._selection, {\n      d: this._squareHandle,\n      fill: _selectionColor,\n      stroke: \"transparent\",\n      strokeWidth: 6\n    });\n    this._handle1._draggable = new DraggableSVG(this._handle1, {\n      onDrag: this._onDragHandle1,\n      callbackScope: this,\n      onPress: this._onPressHandle1,\n      onRelease: this._onReleaseHandle,\n      onClick: this._onClickHandle1,\n      snap: vars.handleSnap\n    });\n    this._handle2._draggable = new DraggableSVG(this._handle2, {\n      onDrag: this._onDragHandle2,\n      callbackScope: this,\n      onPress: this._onPressHandle2,\n      onRelease: this._onReleaseHandle,\n      onClick: this._onClickHandle2,\n      snap: vars.handleSnap\n    });\n    this._handle1.style.visibility = this._handle2.style.visibility = \"hidden\";\n    let selectionItems = [this._handle1, this._handle2, this._line1, this._line2, this._selection, this._selectionPath, this._selectionHittest],\n      i = selectionItems.length;\n    while (--i > -1) {\n      selectionItems[i]._gsSelection = true; //just a flag we can check in the _checkDeselect() method to detect clicks on things that are selection-related.\n    }\n    if (vars.draggable !== false) {\n      this._draggable = new DraggableSVG(this._selectionHittest, {\n        callbackScope: this,\n        onPress: this.select,\n        onRelease: this._onRelease,\n        onDrag: this._onDragPath,\n        onDragEnd: this._saveState,\n        maxX: this.vars.maxX,\n        minX: this.vars.minX\n      });\n    }\n    this.init();\n    this._selection.style.visibility = vars.selected === false ? \"hidden\" : \"visible\";\n    if (vars.selected !== false) {\n      this.path._gsSelection = true;\n      _selectedPaths.push(this);\n    }\n    this._saveState();\n    if (!_supportsPointer) {\n      _addListener(this._selectionHittest, \"mousedown\", _bind(this._onClickSelectionPath, this));\n      _addListener(this._selectionHittest, \"mouseup\", _bind(this._onRelease, this));\n    }\n    _addListener(this._selectionHittest, \"touchstart\", _bind(this._onClickSelectionPath, this));\n    _addListener(this._selectionHittest, \"touchend\", _bind(this._onRelease, this));\n    _context(this);\n  }\n  _onRelease(e) {\n    let anchor = this._editingAnchor;\n    if (anchor) {\n      _editingAxis.x = anchor.segment[anchor.i];\n      _editingAxis.y = anchor.segment[anchor.i + 1];\n    }\n    _removeListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n    _callback(\"onRelease\", this, e);\n  }\n  init() {\n    let pathData = this.path.getAttribute(\"d\"),\n      rawPath = stringToRawPath(pathData),\n      transform = this.path.getAttribute(\"transform\") || \"translate(0,0)\",\n      createAnchors = !this._rawPath || rawPath.totalPoints !== this._rawPath.totalPoints || rawPath.length !== this._rawPath.length,\n      anchorVars = {\n        callbackScope: this,\n        snap: this.vars.anchorSnap,\n        onDrag: this._onDragAnchor,\n        onPress: this._onPressAnchor,\n        onRelease: this._onRelease,\n        onClick: this._onClickAnchor,\n        onDragEnd: this._onDragEndAnchor,\n        maxX: this.vars.maxX,\n        minX: this.vars.minX\n      },\n      l,\n      i;\n    if (createAnchors && this._anchors && this._anchors.length) {\n      for (i = 0; i < this._anchors.length; i++) {\n        this._anchors[i].element.parentNode.removeChild(this._anchors[i].element);\n        this._anchors[i]._draggable.enabled(false);\n      }\n      this._selectedAnchors.length = 0;\n    }\n    this._rawPath = rawPath;\n    if (createAnchors) {\n      this._anchors = _createSegmentAnchors(rawPath, 0, this, anchorVars);\n      l = rawPath.length;\n      if (l > 1) {\n        for (i = 1; i < l; i++) {\n          this._anchors = this._anchors.concat(_createSegmentAnchors(rawPath, i, this, anchorVars));\n        }\n      }\n    } else {\n      i = this._anchors.length;\n      while (--i > -1) {\n        this._anchors[i].update(rawPath);\n      }\n    }\n    this._selection.appendChild(this._handle1); //for stacking order (handles should always be on top)\n    this._selection.appendChild(this._handle2);\n    //\t\tthis._selectedAnchors.length = 0;\n    this._selectionPath.setAttribute(\"d\", pathData);\n    this._selectionHittest.setAttribute(\"d\", pathData);\n    this._g.setAttribute(\"transform\", _getConcatenatedTransforms(this.path.parentNode) || \"translate(0,0)\");\n    this._selection.setAttribute(\"transform\", transform);\n    this._selectionHittest.setAttribute(\"transform\", transform);\n    this._updateAnchors();\n    return this;\n  }\n  _saveState() {\n    _addHistory(this);\n  }\n  _onClickSelectionPath(e) {\n    if (this._selection.style.visibility === \"hidden\") {\n      this.select();\n    } else if (_ALT || e && e.altKey) {\n      let anchorVars = {\n          callbackScope: this,\n          snap: this.vars.anchorSnap,\n          onDrag: this._onDragAnchor,\n          onPress: this._onPressAnchor,\n          onRelease: this._onRelease,\n          onClick: this._onClickAnchor,\n          onDragEnd: this._onDragEndAnchor,\n          maxX: this.vars.maxX,\n          minX: this.vars.minX\n        },\n        ctm = this._selection.getScreenCTM().inverse(),\n        newIndex,\n        i,\n        anchor,\n        x,\n        y,\n        closestData;\n      if (this._draggable) {\n        this._draggable._onRelease(e); //otherwise, ALT-click/dragging on a path would create a new anchor AND drag the entire path.\n      }\n      if (ctm) {\n        x = e.clientX * ctm.a + e.clientY * ctm.c + ctm.e;\n        y = e.clientX * ctm.b + e.clientY * ctm.d + ctm.f;\n      }\n      //DEBUG: _createSVG(\"circle\", this._selection, {fill:\"red\", r:5, cx:x, cy:y});\n      closestData = getClosestData(this._rawPath, x, y);\n      subdivideSegment(this._rawPath[closestData.j], closestData.i, closestData.t);\n      newIndex = closestData.i + 6;\n      for (i = 0; i < this._anchors.length; i++) {\n        if (this._anchors[i].i >= newIndex && this._anchors[i].j === closestData.j) {\n          this._anchors[i].i += 6;\n        }\n      }\n      anchor = new Anchor(this, this._rawPath, closestData.j, newIndex, anchorVars);\n      this._selection.appendChild(this._handle1); //for stacking order (handles should always be on top)\n      this._selection.appendChild(this._handle2);\n      anchor._draggable._onPress(e);\n      _recentlyAddedAnchor = anchor;\n      this._anchors.push(anchor);\n      this._selectedAnchors.length = 0;\n      this._selectedAnchors.push(anchor);\n      this._updateAnchors();\n      this.update();\n      this._saveState();\n    }\n    _resetSelection();\n    _addListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n    _callback(\"onPress\", this);\n  }\n  _onClickHandle1() {\n    let anchor = this._editingAnchor,\n      i = anchor.i,\n      s = anchor.segment,\n      pi = anchor.isClosedStart ? s.length - 4 : i - 2;\n    if (_ALT && Math.abs(s[i] - s[pi]) < 5 && Math.abs(s[i + 1] - s[pi + 1]) < 5) {\n      this._onClickAnchor(anchor);\n    }\n  }\n  _onClickHandle2() {\n    let anchor = this._editingAnchor,\n      i = anchor.i,\n      s = anchor.segment;\n    if (_ALT && Math.abs(s[i] - s[i + 2]) < 5 && Math.abs(s[i + 1] - s[i + 3]) < 5) {\n      this._onClickAnchor(anchor);\n    }\n  }\n  _onDragEndAnchor(e) {\n    _recentlyAddedAnchor = null;\n    this._saveState();\n  }\n  isSelected() {\n    return this._selectedAnchors.length > 0 || this._selection.style.visibility === \"visible\";\n  }\n  select(allAnchors) {\n    this._selection.style.visibility = \"visible\";\n    this._editingAnchor = null;\n    this.path._gsSelection = true;\n    if (allAnchors === true) {\n      let i = this._anchors.length;\n      while (--i > -1) {\n        this._selectedAnchors[i] = this._anchors[i];\n      }\n    }\n    if (_selectedPaths.indexOf(this) === -1) {\n      _selectedPaths.push(this);\n    }\n    this._updateAnchors();\n    return this;\n  }\n  deselect() {\n    this._selection.style.visibility = \"hidden\";\n    this._selectedAnchors.length = 0;\n    this._editingAnchor = null;\n    this.path._gsSelection = false;\n    _selectedPaths.splice(_selectedPaths.indexOf(this), 1);\n    this._updateAnchors();\n    return this;\n  }\n  _onDragPath(e) {\n    let transform = this._selectionHittest.getAttribute(\"transform\") || \"translate(0,0)\";\n    this._selection.setAttribute(\"transform\", transform);\n    this.path.setAttribute(\"transform\", transform);\n  }\n  _onPressAnchor(anchor) {\n    if (this._selectedAnchors.indexOf(anchor) === -1) {\n      //if it isn't already selected...\n      if (!_SHIFT) {\n        this._selectedAnchors.length = 0;\n      }\n      this._selectedAnchors.push(anchor);\n    } else if (_SHIFT) {\n      this._selectedAnchors.splice(this._selectedAnchors.indexOf(anchor), 1);\n      anchor._draggable.endDrag();\n    }\n    _editingAxis.x = anchor.segment[anchor.i];\n    _editingAxis.y = anchor.segment[anchor.i + 1];\n    this._updateAnchors();\n    _callback(\"onPress\", this);\n  }\n  _deleteSelectedAnchors() {\n    let anchors = this._selectedAnchors,\n      i = anchors.length,\n      anchor,\n      index,\n      j,\n      jIndex;\n    while (--i > -1) {\n      anchor = anchors[i];\n      anchor.element.parentNode.removeChild(anchor.element);\n      anchor._draggable.enabled(false);\n      index = anchor.i;\n      jIndex = anchor.j;\n      if (!index) {\n        //first\n        anchor.segment.splice(index, 6);\n      } else if (index < anchor.segment.length - 2) {\n        anchor.segment.splice(index - 2, 6);\n      } else {\n        //last\n        anchor.segment.splice(index - 4, 6);\n      }\n      anchors.splice(i, 1);\n      this._anchors.splice(this._anchors.indexOf(anchor), 1);\n      for (j = 0; j < this._anchors.length; j++) {\n        if (this._anchors[j].i >= index && this._anchors[j].j === jIndex) {\n          this._anchors[j].i -= 6;\n        }\n      }\n    }\n    this._updateAnchors();\n    this.update();\n    this._saveState();\n    if (this.vars.onDeleteAnchor) {\n      this.vars.onDeleteAnchor.call(this.vars.callbackScope || this);\n    }\n  }\n  _onClickAnchor(anchor) {\n    let i = anchor.i,\n      segment = anchor.segment,\n      pi = anchor.isClosedStart ? segment.length - 4 : i - 2,\n      rnd = 1000,\n      isEnd = !i || i >= segment.length - 2,\n      angle1,\n      angle2,\n      length1,\n      length2,\n      sin,\n      cos;\n    if (_ALT && _recentlyAddedAnchor !== anchor && this._editingAnchor) {\n      anchor.smooth = !anchor.smooth;\n      if (isEnd && !anchor.isClosedStart) {\n        //the very ends can't be \"smooth\"\n        anchor.smooth = false;\n      }\n      anchor.element.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n      if (anchor.smooth && (!isEnd || anchor.isClosedStart)) {\n        angle1 = Math.atan2(segment[i + 1] - segment[pi + 1], segment[i] - segment[pi]);\n        angle2 = Math.atan2(segment[i + 3] - segment[i + 1], segment[i + 2] - segment[i]);\n        angle1 = (angle1 + angle2) / 2;\n        length1 = _getLength(segment, pi, i);\n        length2 = _getLength(segment, i, i + 2);\n        if (length1 < 0.2) {\n          length1 = _getLength(segment, i, pi - 4) / 4;\n          angle1 = angle2 || Math.atan2(segment[i + 7] - segment[pi - 3], segment[i + 6] - segment[pi - 4]);\n        }\n        if (length2 < 0.2) {\n          length2 = _getLength(segment, i, i + 6) / 4;\n          angle2 = angle1 || Math.atan2(segment[i + 7] - segment[pi - 3], segment[i + 6] - segment[pi - 4]);\n        }\n        sin = Math.sin(angle1);\n        cos = Math.cos(angle1);\n        if (Math.abs(angle2 - angle1) < Math.PI / 2) {\n          sin = -sin;\n          cos = -cos;\n        }\n        segment[pi] = ((segment[i] + cos * length1) * rnd | 0) / rnd;\n        segment[pi + 1] = ((segment[i + 1] + sin * length1) * rnd | 0) / rnd;\n        segment[i + 2] = ((segment[i] - cos * length2) * rnd | 0) / rnd;\n        segment[i + 3] = ((segment[i + 1] - sin * length2) * rnd | 0) / rnd;\n        this._updateAnchors();\n        this.update();\n        this._saveState();\n      } else if (!anchor.smooth && (!isEnd || anchor.isClosedStart)) {\n        if (i || anchor.isClosedStart) {\n          segment[pi] = segment[i];\n          segment[pi + 1] = segment[i + 1];\n        }\n        if (i < segment.length - 2) {\n          segment[i + 2] = segment[i];\n          segment[i + 3] = segment[i + 1];\n        }\n        this._updateAnchors();\n        this.update();\n        this._saveState();\n      }\n    } else if (!_SHIFT) {\n      this._selectedAnchors.length = 0;\n      this._selectedAnchors.push(anchor);\n    }\n    _recentlyAddedAnchor = null;\n    this._updateAnchors();\n  }\n  _updateAnchors() {\n    let anchor = this._selectedAnchors.length === 1 ? this._selectedAnchors[0] : null,\n      segment = anchor ? anchor.segment : null,\n      i,\n      x,\n      y;\n    this._editingAnchor = anchor;\n    for (i = 0; i < this._anchors.length; i++) {\n      this._anchors[i].element.style.fill = this._selectedAnchors.indexOf(this._anchors[i]) !== -1 ? _selectionColor : \"white\";\n      //this._anchors[i].element.setAttribute(\"fill\", (this._selectedAnchors.indexOf(this._anchors[i]) !== -1) ? _selectionColor : \"white\");\n    }\n    if (anchor) {\n      this._handle1.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n      this._handle2.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n    }\n    i = anchor ? anchor.i : 0;\n    if (anchor && (i || anchor.isClosedStart)) {\n      x = anchor.isClosedStart ? segment[segment.length - 4] : segment[i - 2];\n      y = anchor.isClosedStart ? segment[segment.length - 3] : segment[i - 1]; //TODO: if they equal the anchor coordinates, just hide it.\n      this._handle1.style.visibility = this._line1.style.visibility = !_ALT && x === segment[i] && y === segment[i + 1] ? \"hidden\" : \"visible\";\n      this._handle1.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n      this._line1.setAttribute(\"points\", x + _comma + y + _comma + segment[i] + _comma + segment[i + 1]);\n    } else {\n      this._handle1.style.visibility = this._line1.style.visibility = \"hidden\";\n    }\n    if (anchor && i < segment.length - 2) {\n      x = segment[i + 2];\n      y = segment[i + 3];\n      this._handle2.style.visibility = this._line2.style.visibility = !_ALT && x === segment[i] && y === segment[i + 1] ? \"hidden\" : \"visible\";\n      this._handle2.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n      this._line2.setAttribute(\"points\", segment[i] + _comma + segment[i + 1] + _comma + x + _comma + y);\n    } else {\n      this._handle2.style.visibility = this._line2.style.visibility = \"hidden\";\n    }\n  }\n  _onPressAlt() {\n    let anchor = this._editingAnchor;\n    if (anchor) {\n      if (anchor.i || anchor.isClosedStart) {\n        this._handle1.style.visibility = this._line1.style.visibility = \"visible\";\n      }\n      if (anchor.i < anchor.segment.length - 2) {\n        this._handle2.style.visibility = this._line2.style.visibility = \"visible\";\n      }\n    }\n  }\n  _onReleaseAlt() {\n    let anchor = this._editingAnchor,\n      s,\n      i,\n      pi;\n    if (anchor) {\n      s = anchor.segment;\n      i = anchor.i;\n      pi = anchor.isClosedStart ? s.length - 4 : i - 2;\n      if (s[i] === s[pi] && s[i + 1] === s[pi + 1]) {\n        this._handle1.style.visibility = this._line1.style.visibility = \"hidden\";\n      }\n      if (s[i] === s[i + 2] && s[i + 1] === s[i + 3]) {\n        this._handle2.style.visibility = this._line2.style.visibility = \"hidden\";\n      }\n    }\n  }\n  _onPressHandle1() {\n    if (this._editingAnchor.smooth) {\n      this._oppositeHandleLength = _getLength(this._editingAnchor.segment, this._editingAnchor.i, this._editingAnchor.i + 2);\n    }\n    _callback(\"onPress\", this);\n  }\n  _onPressHandle2() {\n    if (this._editingAnchor.smooth) {\n      this._oppositeHandleLength = _getLength(this._editingAnchor.segment, this._editingAnchor.isClosedStart ? this._editingAnchor.segment.length - 4 : this._editingAnchor.i - 2, this._editingAnchor.i);\n    }\n    _callback(\"onPress\", this);\n  }\n  _onReleaseHandle(e) {\n    this._onRelease(e);\n    this._saveState();\n  }\n  _onDragHandle1() {\n    let anchor = this._editingAnchor,\n      s = anchor.segment,\n      i = anchor.i,\n      pi = anchor.isClosedStart ? s.length - 4 : i - 2,\n      rnd = 1000,\n      x = this._handle1._draggable.x,\n      y = this._handle1._draggable.y,\n      angle;\n    s[pi] = x = (x * rnd | 0) / rnd;\n    s[pi + 1] = y = (y * rnd | 0) / rnd;\n    if (anchor.smooth) {\n      if (_ALT) {\n        anchor.smooth = false;\n        anchor.element.setAttribute(\"d\", this._squareHandle);\n        this._handle1.setAttribute(\"d\", this._squareHandle);\n        this._handle2.setAttribute(\"d\", this._squareHandle);\n      } else {\n        angle = Math.atan2(s[i + 1] - y, s[i] - x);\n        x = this._oppositeHandleLength * Math.cos(angle);\n        y = this._oppositeHandleLength * Math.sin(angle);\n        s[i + 2] = ((s[i] + x) * rnd | 0) / rnd;\n        s[i + 3] = ((s[i + 1] + y) * rnd | 0) / rnd;\n      }\n    }\n    this.update();\n  }\n  _onDragHandle2() {\n    let anchor = this._editingAnchor,\n      s = anchor.segment,\n      i = anchor.i,\n      pi = anchor.isClosedStart ? s.length - 4 : i - 2,\n      rnd = 1000,\n      x = this._handle2._draggable.x,\n      y = this._handle2._draggable.y,\n      angle;\n    s[i + 2] = x = (x * rnd | 0) / rnd;\n    s[i + 3] = y = (y * rnd | 0) / rnd;\n    if (anchor.smooth) {\n      if (_ALT) {\n        anchor.smooth = false;\n        anchor.element.setAttribute(\"d\", this._squareHandle);\n        this._handle1.setAttribute(\"d\", this._squareHandle);\n        this._handle2.setAttribute(\"d\", this._squareHandle);\n      } else {\n        angle = Math.atan2(s[i + 1] - y, s[i] - x);\n        x = this._oppositeHandleLength * Math.cos(angle);\n        y = this._oppositeHandleLength * Math.sin(angle);\n        s[pi] = ((s[i] + x) * rnd | 0) / rnd;\n        s[pi + 1] = ((s[i + 1] + y) * rnd | 0) / rnd;\n      }\n    }\n    this.update();\n  }\n  _onDragAnchor(anchor, changeX, changeY) {\n    let anchors = this._selectedAnchors,\n      l = anchors.length,\n      rnd = 1000,\n      i,\n      j,\n      s,\n      a,\n      pi;\n    for (j = 0; j < l; j++) {\n      a = anchors[j];\n      i = a.i;\n      s = a.segment;\n      if (i) {\n        s[i - 2] = ((s[i - 2] + changeX) * rnd | 0) / rnd;\n        s[i - 1] = ((s[i - 1] + changeY) * rnd | 0) / rnd;\n      } else if (a.isClosedStart) {\n        pi = s.length - 2;\n        s[pi] = _round(s[pi] + changeX);\n        s[pi + 1] = _round(s[pi + 1] + changeY);\n        s[pi - 2] = _round(s[pi - 2] + changeX);\n        s[pi - 1] = _round(s[pi - 1] + changeY);\n      }\n      s[i] = ((s[i] + changeX) * rnd | 0) / rnd;\n      s[i + 1] = ((s[i + 1] + changeY) * rnd | 0) / rnd;\n      if (i < s.length - 2) {\n        s[i + 2] = ((s[i + 2] + changeX) * rnd | 0) / rnd;\n        s[i + 3] = ((s[i + 3] + changeY) * rnd | 0) / rnd;\n      }\n      if (a !== anchor) {\n        a.element.setAttribute(\"transform\", \"translate(\" + s[i] + _comma + s[i + 1] + \")\");\n      }\n    }\n    this.update();\n  }\n  enabled(enabled) {\n    if (!arguments.length) {\n      return this._enabled;\n    }\n    let i = this._anchors.length;\n    while (--i > -1) {\n      this._anchors[i]._draggable.enabled(enabled);\n    }\n    this._enabled = enabled;\n    this._handle1._draggable.enabled(enabled);\n    this._handle2._draggable.enabled(enabled);\n    if (this._draggable) {\n      this._draggable.enabled(enabled);\n    }\n    if (!enabled) {\n      this.deselect();\n      this._selectionHittest.parentNode && this._selectionHittest.parentNode.removeChild(this._selectionHittest);\n      this._selection.parentNode && this._selection.parentNode.removeChild(this._selection);\n    } else if (!this._selection.parentNode) {\n      this.path.ownerSVGElement.appendChild(this._selectionHittest);\n      this.path.ownerSVGElement.appendChild(this._selection);\n      this.init();\n      this._saveState();\n    }\n    this._updateAnchors();\n    return this.update();\n  }\n  update(readPath) {\n    let d = \"\",\n      anchor = this._editingAnchor,\n      i,\n      s,\n      x,\n      y,\n      pi;\n    if (readPath) {\n      this.init();\n    }\n    if (anchor) {\n      i = anchor.i;\n      s = anchor.segment;\n      if (i || anchor.isClosedStart) {\n        pi = anchor.isClosedStart ? s.length - 4 : i - 2;\n        x = s[pi];\n        y = s[pi + 1];\n        this._handle1.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n        this._line1.setAttribute(\"points\", x + _comma + y + _comma + s[i] + _comma + s[i + 1]);\n      }\n      if (i < s.length - 2) {\n        x = s[i + 2];\n        y = s[i + 3];\n        this._handle2.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n        this._line2.setAttribute(\"points\", s[i] + _comma + s[i + 1] + _comma + x + _comma + y);\n      }\n    }\n    if (readPath) {\n      d = this.path.getAttribute(\"d\");\n    } else {\n      for (i = 0; i < this._rawPath.length; i++) {\n        s = this._rawPath[i];\n        if (s.length > 7) {\n          d += \"M\" + s[0] + _comma + s[1] + \"C\" + s.slice(2).join(_comma);\n        }\n      }\n      this.path.setAttribute(\"d\", d);\n      this._selectionPath.setAttribute(\"d\", d);\n      this._selectionHittest.setAttribute(\"d\", d);\n    }\n    if (this.vars.onUpdate && this._enabled) {\n      _callback(\"onUpdate\", this, d);\n    }\n    return this;\n  }\n  getRawPath(applyTransforms, offsetX, offsetY) {\n    if (applyTransforms) {\n      let m = _getConsolidatedMatrix(this.path);\n      return transformRawPath(copyRawPath(this._rawPath), 1, 0, 0, 1, m.e + (offsetX || 0), m.f + (offsetY || 0));\n    }\n    return this._rawPath;\n  }\n  getString(applyTransforms, offsetX, offsetY) {\n    if (applyTransforms) {\n      let m = _getConsolidatedMatrix(this.path);\n      return rawPathToString(transformRawPath(copyRawPath(this._rawPath), 1, 0, 0, 1, m.e + (offsetX || 0), m.f + (offsetY || 0)));\n    }\n    return this.path.getAttribute(\"d\");\n  }\n  getNormalizedSVG(height, originY, shorten, onEaseError) {\n    let s = this._rawPath[0],\n      tx = s[0] * -1,\n      ty = originY === 0 ? 0 : -(originY || s[1]),\n      l = s.length,\n      sx = 1 / (s[l - 2] + tx),\n      sy = -height || s[l - 1] + ty,\n      rnd = 1000,\n      points,\n      i,\n      x1,\n      y1,\n      x2,\n      y2;\n    _temp.length = 0;\n    if (sy) {\n      //typically y ends at 1 (so that the end values are reached)\n      sy = 1 / sy;\n    } else {\n      //in case the ease returns to its beginning value, scale everything proportionally\n      sy = -sx;\n    }\n    sx *= rnd;\n    sy *= rnd;\n    for (i = 0; i < l; i += 2) {\n      _temp[i] = ((s[i] + tx) * sx | 0) / rnd;\n      _temp[i + 1] = ((s[i + 1] + ty) * sy | 0) / rnd;\n    }\n    if (onEaseError) {\n      points = [];\n      l = _temp.length;\n      for (i = 2; i < l; i += 6) {\n        x1 = _temp[i - 2];\n        y1 = _temp[i - 1];\n        x2 = _temp[i + 4];\n        y2 = _temp[i + 5];\n        points.push(x1, y1, x2, y2);\n        bezierToPoints(x1, y1, _temp[i], _temp[i + 1], _temp[i + 2], _temp[i + 3], x2, y2, 0.001, points, points.length - 2);\n      }\n      x1 = points[0];\n      l = points.length;\n      for (i = 2; i < l; i += 2) {\n        x2 = points[i];\n        if (x2 < x1 || x2 > 1 || x2 < 0) {\n          onEaseError();\n          break;\n        }\n        x1 = x2;\n      }\n    }\n    if (shorten && l === 8 && _temp[0] === 0 && _temp[1] === 0 && _temp[l - 2] === 1 && _temp[l - 1] === 1) {\n      return _temp.slice(2, 6).join(\",\");\n    }\n    _temp[2] = \"C\" + _temp[2];\n    return \"M\" + _temp.join(\",\");\n  }\n  kill() {\n    this.enabled(false);\n    this._g.parentNode && this._g.parentNode.removeChild(this._g);\n  }\n  revert() {\n    this.kill();\n  }\n}\nPathEditor.simplifyPoints = simplifyPoints;\nPathEditor.pointsToSegment = pointsToSegment;\nPathEditor.simplifySVG = (data, vars) => {\n  //takes a <path> element or data string and simplifies it according to whatever tolerance you set (default:1, the bigger the number the more variance there can be). vars: {tolerance:1, cornerThreshold:degrees, curved:true}\n  let element, points, i, x1, x2, y1, y2, bezier, precision, tolerance, l, cornerThreshold;\n  vars = vars || {};\n  tolerance = vars.tolerance || 1;\n  precision = vars.precision || 1 / tolerance;\n  cornerThreshold = (vars.cornerThreshold === undefined ? 18 : +vars.cornerThreshold) * _DEG2RAD;\n  if (typeof data !== \"string\") {\n    //element\n    element = data;\n    data = element.getAttribute(\"d\");\n  }\n  if (data.charAt(0) === \"#\" || data.charAt(0) === \".\") {\n    //selector text\n    element = _doc.querySelector(data);\n    if (element) {\n      data = element.getAttribute(\"d\");\n    }\n  }\n  points = vars.curved === false && !/[achqstvz]/ig.test(data) ? data.match(_numbersExp) : stringToRawPath(data)[0];\n  if (vars.curved !== false) {\n    bezier = points;\n    points = [];\n    l = bezier.length;\n    for (i = 2; i < l; i += 6) {\n      x1 = +bezier[i - 2];\n      y1 = +bezier[i - 1];\n      x2 = +bezier[i + 4];\n      y2 = +bezier[i + 5];\n      points.push(_round(x1), _round(y1), _round(x2), _round(y2));\n      bezierToPoints(x1, y1, +bezier[i], +bezier[i + 1], +bezier[i + 2], +bezier[i + 3], x2, y2, 1 / (precision * 200000), points, points.length - 2);\n    }\n    points = pointsToSegment(simplifyPoints(points, tolerance), vars.curviness, cornerThreshold);\n    points[2] = \"C\" + points[2];\n  } else {\n    points = simplifyPoints(points, tolerance);\n  }\n  data = \"M\" + points.join(\",\");\n  if (element) {\n    element.setAttribute(\"d\", data);\n  }\n  return data;\n};\nPathEditor.create = (target, vars) => new PathEditor(target, vars);\nPathEditor.editingAxis = _editingAxis;\nPathEditor.getSnapFunction = vars => {\n  //{gridSize, radius, x, y, width, height}\n  let r = vars.radius || 2,\n    big = 1e20,\n    minX = vars.x || vars.x === 0 ? vars.x : vars.width ? 0 : -big,\n    minY = vars.y || vars.y === 0 ? vars.y : vars.height ? 0 : -big,\n    maxX = minX + (vars.width || big * big),\n    maxY = minY + (vars.height || big * big),\n    containX = vars.containX !== false,\n    containY = vars.containY !== false,\n    axis = vars.axis,\n    grid = vars.gridSize;\n  r *= r;\n  return p => {\n    let x = p.x,\n      y = p.y,\n      gridX,\n      gridY,\n      dx,\n      dy;\n    if (containX && x < minX || (dx = x - minX) * dx < r) {\n      x = minX;\n    } else if (containX && x > maxX || (dx = maxX - x) * dx < r) {\n      x = maxX;\n    }\n    if (containY && y < minY || (dy = y - minY) * dy < r) {\n      y = minY;\n    } else if (containY && y > maxY || (dy = maxY - y) * dy < r) {\n      y = maxY;\n    }\n    if (axis) {\n      dx = x - axis.x;\n      dy = y - axis.y;\n      if (dx * dx < r) {\n        x = axis.x;\n      }\n      if (dy * dy < r) {\n        y = axis.y;\n      }\n    }\n    if (grid) {\n      gridX = minX + Math.round((x - minX) / grid) * grid; //closest grid slot on x-axis\n      dx = gridX - x;\n      gridY = minY + Math.round((y - minY) / grid) * grid; //closest grid slot on y-axis\n      dy = gridY - y;\n      if (dx * dx + dy * dy < r) {\n        x = gridX;\n        y = gridY;\n      }\n    }\n    p.x = x;\n    p.y = y;\n  };\n};\nPathEditor.version = \"3.13.0\";\nPathEditor.register = _initCore;\nexport { PathEditor as default };","map":{"version":3,"names":["stringToRawPath","rawPathToString","bezierToPoints","simplifyPoints","pointsToSegment","subdivideSegment","getClosestData","copyRawPath","transformRawPath","getGlobalMatrix","Matrix2D","_numbersExp","_doc","_supportsPointer","_win","_body","gsap","_context","_selectionColor","_minimumMovement","_DEG2RAD","Math","PI","_getTime","Date","now","getTime","_lastInteraction","_isPressed","_emptyFunc","_interacted","_CTRL","_ALT","_SHIFT","_CMD","_recentlyAddedAnchor","_editingAxis","_history","_point","_temp","_comma","_selectedPaths","_preventDefault","event","preventDefault","preventManipulation","_createElement","type","createElementNS","createElement","_createSVG","container","attributes","element","reg","p","class","style","undefined","setAttributeNS","replace","toLowerCase","appendChild","_identityMatrixObject","matrix","_getConsolidatedMatrix","target","transform","baseVal","consolidate","_getConcatenatedTransforms","m","owner","ownerSVGElement","parentNode","multiply","a","b","c","d","e","f","_addHistory","pathEditor","selectedIndexes","_selectedAnchors","i","length","unshift","path","getAttribute","_round","value","_getSquarePathData","size","join","_getCirclePathData","circ","rcirc","_checkDeselect","_gsSelection","deselect","_tempDiv","_touchEventLookup","_isMultiTouching","_addListener","func","capture","addEventListener","touchType","passive","substr","attachEvent","_removeListener","removeEventListener","detachEvent","_hasTouchID","list","ID","identifier","_onMultiTouchDocumentEnd","touches","_dragCount","_onMultiTouchDocument","_bind","scope","call","_callback","self","param","callback","vars","callbackScope","_copyElement","_resetSelection","display","select","_coreInitted","_initCore","core","document","window","body","console","warn","context","types","standard","split","converted","onpointerdown","onmspointerdown","obj","SVGElement","prototype","getTransformToElement","getScreenCTM","inverse","key","keyCode","which","keyString","state","_onPressAlt","shift","setAttribute","init","_anchors","indexOf","push","_updateAnchors","update","onUndo","_deleteSelectedAnchors","_onReleaseAlt","PointerEvent","_onPress","ctm","touchEventTarget","temp","_matrix","getItem","_ctm","currentTarget","_onRelease","_onMove","changedTouches","touch","touchID","pointerId","_startPointerY","pointerY","pageY","_startPointerX","pointerX","pageX","_startElementX","_startElementY","isPressed","onPress","pointerEvent","originalEvent","_enabled","setPointerPosition","onDrag","force","wasDragging","isDragging","onClick","onDragRelease","onRelease","onDragEnd","_createSegmentAnchors","rawPath","j","editor","segment","l","closed","Anchor","isClosedStart","_getLength","i2","x","y","sqrt","DraggableSVG","constructor","querySelectorAll","snap","isNaN","maxX","minX","_bounds","enabled","rnd","xChange","yChange","arguments","dragging","_onClick","endDrag","_selection","fill","stroke","strokeWidth","vectorEffect","_draggable","s","prevSmooth","smooth","pi","abs","atan2","_circleHandle","_squareHandle","PathEditor","_g","_selectionHittest","_selectionPath","_line1","_line2","pointerEvents","handleSize","_handle1","_handle2","_onDragHandle1","_onPressHandle1","_onReleaseHandle","_onClickHandle1","handleSnap","_onDragHandle2","_onPressHandle2","_onClickHandle2","visibility","selectionItems","draggable","_onDragPath","_saveState","selected","_onClickSelectionPath","anchor","_editingAnchor","pathData","createAnchors","_rawPath","totalPoints","anchorVars","anchorSnap","_onDragAnchor","_onPressAnchor","_onClickAnchor","_onDragEndAnchor","removeChild","concat","altKey","newIndex","closestData","clientX","clientY","t","isSelected","allAnchors","splice","anchors","index","jIndex","onDeleteAnchor","isEnd","angle1","angle2","length1","length2","sin","cos","_oppositeHandleLength","angle","changeX","changeY","readPath","slice","onUpdate","getRawPath","applyTransforms","offsetX","offsetY","getString","getNormalizedSVG","height","originY","shorten","onEaseError","tx","ty","sx","sy","points","x1","y1","x2","y2","kill","revert","simplifySVG","data","bezier","precision","tolerance","cornerThreshold","charAt","querySelector","curved","test","match","curviness","create","editingAxis","getSnapFunction","r","radius","big","width","minY","maxY","containX","containY","axis","grid","gridSize","gridX","gridY","dx","dy","round","version","register","default"],"sources":["/Users/linhankuan/fvl2025/node_modules/gsap/src/utils/PathEditor.js"],"sourcesContent":["/*!\n * PathEditor 3.13.0\n * https://gsap.com\n *\n * Copyright 2008-2025, GreenSock. All rights reserved.\n * Subject to the terms at https://gsap.com/standard-license\n * @author: Jack Doyle, jack@greensock.com\n*/\n/* eslint-disable */\n\nimport { stringToRawPath, rawPathToString, bezierToPoints, simplifyPoints, pointsToSegment, subdivideSegment, getClosestData, copyRawPath, transformRawPath } from \"./paths.js\";\nimport { getGlobalMatrix, Matrix2D } from \"./matrix.js\";\n\nlet _numbersExp = /(?:(-)?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[0-9]/ig,\n\t_doc, _supportsPointer, _win, _body, gsap, _context,\n\t_selectionColor = \"#4e7fff\",\n\t_minimumMovement = 1,\n\t_DEG2RAD = Math.PI / 180,\n\t_getTime = Date.now || (() => new Date().getTime()),\n\t_lastInteraction = 0,\n\t_isPressed = 0,\n\t_emptyFunc = () => false,\n\t_interacted = () => _lastInteraction = _getTime(),\n\t_CTRL, _ALT, _SHIFT, _CMD,\n\t_recentlyAddedAnchor,\n\t_editingAxis = {}, //stores the x/y of the most recently-selected anchor point's x and y axis. We tap into this for snapping horizontally and vertically.\n\t_history = [],\n\t_point = {}, //reuse to minimize memory and maximize performance (mostly for snapping)\n\t_temp = [], //reuse this in places like getNormalizedSVG() to conserve memory\n\t_comma = \",\",\n\t_selectedPaths = [],\n\t_preventDefault = event => {\n\t\tif (event.preventDefault) {\n\t\t\tevent.preventDefault();\n\t\t\tif (event.preventManipulation) {\n\t\t\t\tevent.preventManipulation();  //for some Microsoft browsers\n\t\t\t}\n\t\t}\n\t},\n\t_createElement = type => _doc.createElementNS ? _doc.createElementNS(\"http://www.w3.org/1999/xhtml\", type) : _doc.createElement(type),\n\t_createSVG = (type, container, attributes) => {\n\t\tlet element = _doc.createElementNS(\"http://www.w3.org/2000/svg\", type),\n\t\t\treg = /([a-z])([A-Z])/g,\n\t\t\tp;\n\t\tattributes = attributes || {};\n\t\tattributes.class = attributes.class || \"path-editor\";\n\t\tfor (p in attributes) {\n\t\t\tif (element.style[p] !== undefined) {\n\t\t\t\telement.style[p] = attributes[p];\n\t\t\t} else {\n\t\t\t\telement.setAttributeNS(null, p.replace(reg, \"$1-$2\").toLowerCase(), attributes[p]);\n\t\t\t}\n\t\t}\n\t\tcontainer.appendChild(element);\n\t\treturn element;\n\t},\n\t_identityMatrixObject = {matrix:new Matrix2D()},\n\t_getConsolidatedMatrix = target => ((target.transform && target.transform.baseVal.consolidate()) || _identityMatrixObject).matrix,\n\t_getConcatenatedTransforms = target => {\n\t\tlet m = _getConsolidatedMatrix(target),\n\t\t\towner = target.ownerSVGElement;\n\t\twhile ((target = target.parentNode) && target.ownerSVGElement === owner) {\n\t\t\tm.multiply(_getConsolidatedMatrix(target));\n\t\t}\n\t\treturn \"matrix(\" + m.a + \",\" + m.b + \",\" + m.c + \",\" + m.d + \",\" + m.e + \",\" + m.f + \")\";\n\t},\n\t_addHistory = pathEditor => {\n\t\tlet selectedIndexes = [],\n\t\t\ta = pathEditor._selectedAnchors,\n\t\t\ti;\n\t\tfor (i = 0; i < a.length; i++) {\n\t\t\tselectedIndexes[i] = a[i].i;\n\t\t}\n\t\t_history.unshift({path:pathEditor, d:pathEditor.path.getAttribute(\"d\"), transform:pathEditor.path.getAttribute(\"transform\") || \"\", selectedIndexes:selectedIndexes});\n\t\tif (_history.length > 30) {\n\t\t\t_history.length = 30;\n\t\t}\n\t},\n\t_round = value =>  ~~(value * 1000 + (value < 0 ? -.5 : .5)) / 1000,\n\t_getSquarePathData = size => {\n\t\tsize = _round(size);\n\t\treturn [\"M-\" + size, -size, size, -size, size, size, -size, size + \"z\"].join(_comma);\n\t},\n\t_getCirclePathData = size => {\n\t\tlet circ = 0.552284749831,\n\t\t\trcirc = _round(size * circ);\n\t\tsize = _round(size);\n\t\treturn \"M\" + size + \",0C\" + [size, rcirc, rcirc, size, 0, size,  -rcirc, size, -size, rcirc, -size, 0, -size, -rcirc, -rcirc, -size, 0, -size, rcirc, -size, size, -rcirc, size, 0].join(_comma) + \"z\";\n\t},\n\t_checkDeselect = function(e) {\n\t\tif (!e.target._gsSelection && !_isPressed && _getTime() - _lastInteraction > 100) {\n\t\t\tlet i = _selectedPaths.length;\n\t\t\twhile (--i > -1) {\n\t\t\t\t_selectedPaths[i].deselect();\n\t\t\t}\n\t\t\t_selectedPaths.length = 0;\n\t\t}\n\t},\n\t_tempDiv, _touchEventLookup,\n\t_isMultiTouching = 0,\n\t_addListener = (element, type, func, capture) => {\n\t\tif (element.addEventListener) {\n\t\t\tlet touchType = _touchEventLookup[type];\n\t\t\tcapture = capture || {passive:false};\n\t\t\telement.addEventListener(touchType || type, func, capture);\n\t\t\tif (touchType && type !== touchType && touchType.substr(0, 7) !== \"pointer\") { //some browsers actually support both, so must we. But pointer events cover all.\n\t\t\t\telement.addEventListener(type, func, capture);\n\t\t\t}\n\t\t} else if (element.attachEvent) {\n\t\t\telement.attachEvent(\"on\" + type, func);\n\t\t}\n\t},\n\t_removeListener = (element, type, func) => {\n\t\tif (element.removeEventListener) {\n\t\t\tlet touchType = _touchEventLookup[type];\n\t\t\telement.removeEventListener(touchType || type, func);\n\t\t\tif (touchType && type !== touchType && touchType.substr(0, 7) !== \"pointer\") {\n\t\t\t\telement.removeEventListener(type, func);\n\t\t\t}\n\t\t} else if (element.detachEvent) {\n\t\t\telement.detachEvent(\"on\" + type, func);\n\t\t}\n\t},\n\t_hasTouchID = (list, ID) => {\n\t\tlet i = list.length;\n\t\twhile (--i > -1) {\n\t\t\tif (list[i].identifier === ID) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\t_onMultiTouchDocumentEnd = e => {\n\t\t_isMultiTouching = (e.touches && _dragCount < e.touches.length);\n\t\t_removeListener(e.target, \"touchend\", _onMultiTouchDocumentEnd);\n\t},\n\t_onMultiTouchDocument = e => {\n\t\t_isMultiTouching = (e.touches && _dragCount < e.touches.length);\n\t\t_addListener(e.target, \"touchend\", _onMultiTouchDocumentEnd);\n\t},\n\t_bind = (func, scope) => e => func.call(scope, e),\n\t_callback = (type, self, param) => {\n\t\tlet callback = self.vars[type];\n\t\tif (callback) {\n\t\t\tcallback.call(self.vars.callbackScope || self, param || self);\n\t\t}\n\t\treturn self;\n\t},\n\t_copyElement,\n\t_resetSelection = () => {\n\t\t_copyElement.style.display = \"block\";\n\t\t_copyElement.select();\n\t\t_copyElement.style.display = \"none\";\n\t},\n\t_coreInitted,\n\t_initCore = (core) => {\n\t\t_doc = document;\n\t\t_win = window;\n\t\t_body = _doc.body;\n\t\tgsap = gsap || core || _win.gsap || console.warn(\"Please gsap.registerPlugin(PathEditor)\");\n\t\t_context = (gsap && gsap.core.context) || function() {};\n\t\t_tempDiv = _createElement(\"div\");\n\t\t_copyElement = _createElement(\"textarea\");\n\t\t_copyElement.style.display = \"none\";\n\t\t_body && _body.appendChild(_copyElement);\n\t\t_touchEventLookup = (function(types) { //we create an object that makes it easy to translate touch event types into their \"pointer\" counterparts if we're in a browser that uses those instead. Like IE10 uses \"MSPointerDown\" instead of \"touchstart\", for example.\n\t\t\tlet standard = types.split(\",\"),\n\t\t\t\tconverted = ((_tempDiv.onpointerdown !== undefined) ? \"pointerdown,pointermove,pointerup,pointercancel\" : (_tempDiv.onmspointerdown !== undefined) ? \"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel\" : types).split(\",\"),\n\t\t\t\tobj = {},\n\t\t\t\ti = 4;\n\t\t\twhile (--i > -1) {\n\t\t\t\tobj[standard[i]] = converted[i];\n\t\t\t\tobj[converted[i]] = standard[i];\n\t\t\t}\n\t\t\treturn obj;\n\t\t}(\"touchstart,touchmove,touchend,touchcancel\"));\n\t\tSVGElement.prototype.getTransformToElement = SVGElement.prototype.getTransformToElement || function(e) { //adds Chrome support\n\t\t\treturn e.getScreenCTM().inverse().multiply(this.getScreenCTM());\n\t\t};\n\t\t_doc.addEventListener(\"keydown\", function(e) {\n\t\t\tlet key = e.keyCode || e.which,\n\t\t\t\tkeyString = e.key || key,\n\t\t\t\ti, state, a, path;\n\t\t\tif (keyString === \"Shift\" || key === 16) {\n\t\t\t\t_SHIFT = true;\n\t\t\t} else if (keyString === \"Control\" || key === 17) {\n\t\t\t\t_CTRL = true;\n\t\t\t} else if (keyString === \"Meta\" || key === 91) {\n\t\t\t\t_CMD = true;\n\t\t\t} else if (keyString === \"Alt\" || key === 18) {\n\t\t\t\t_ALT = true;\n\t\t\t\ti = _selectedPaths.length;\n\t\t\t\twhile (--i > -1) {\n\t\t\t\t\t_selectedPaths[i]._onPressAlt();\n\t\t\t\t}\n\t\t\t} else if ((keyString === \"z\" || key === 90) && (_CTRL || _CMD) && _history.length > 1) { //UNDO\n\t\t\t\t_history.shift();\n\t\t\t\tstate = _history[0];\n\t\t\t\tif (state) {\n\t\t\t\t\tpath = state.path;\n\t\t\t\t\tpath.path.setAttribute(\"d\", state.d);\n\t\t\t\t\tpath.path.setAttribute(\"transform\", state.transform);\n\t\t\t\t\tpath.init();\n\t\t\t\t\ta = path._anchors;\n\t\t\t\t\tfor (i = 0; i < a.length; i++) {\n\t\t\t\t\t\tif (state.selectedIndexes.indexOf(a[i].i) !== -1) {\n\t\t\t\t\t\t\tpath._selectedAnchors.push(a[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpath._updateAnchors();\n\t\t\t\t\tpath.update();\n\t\t\t\t\tif (path.vars.onUndo) {\n\t\t\t\t\t\tpath.vars.onUndo.call(path);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (keyString === \"Delete\" || keyString === \"Backspace\" || key === 8 || key === 46 || key === 63272 || (key === \"d\" && (_CTRL || _CMD))) { //DELETE\n\t\t\t\ti = _selectedPaths.length;\n\t\t\t\twhile (--i > -1) {\n\t\t\t\t\t_selectedPaths[i]._deleteSelectedAnchors();\n\t\t\t\t}\n\t\t\t} else if ((keyString === \"a\" || key === 65) && (_CMD || _CTRL)) { //SELECT ALL\n\t\t\t\ti = _selectedPaths.length;\n\t\t\t\twhile (--i > -1) {\n\t\t\t\t\t_selectedPaths[i].select(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\t\t_doc.addEventListener(\"keyup\", function(e) {\n\t\t\tlet key = e.key || e.keyCode || e.which;\n\t\t\tif (key === \"Shift\" || key === 16) {\n\t\t\t\t_SHIFT = false;\n\t\t\t} else if (key === \"Control\" || key === 17) {\n\t\t\t\t_CTRL = false;\n\t\t\t} else if (key === \"Meta\" || key === 91) {\n\t\t\t\t_CMD = false;\n\t\t\t} else if (key === \"Alt\" || key === 18) {\n\t\t\t\t_ALT = false;\n\t\t\t\tlet i = _selectedPaths.length;\n\t\t\t\twhile (--i > -1) {\n\t\t\t\t\t_selectedPaths[i]._onReleaseAlt();\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\t\t_supportsPointer = !!_win.PointerEvent;\n\t\t_addListener(_doc, \"mouseup\", _checkDeselect);\n\t\t_addListener(_doc, \"touchend\", _checkDeselect);\n\t\t_addListener(_doc, \"touchcancel\", _emptyFunc); //some older Android devices intermittently stop dispatching \"touchmove\" events if we don't listen for \"touchcancel\" on the document. Very strange indeed.\n\t\t_addListener(_win, \"touchmove\", _emptyFunc); //works around Safari bugs that still allow the page to scroll even when we preventDefault() on the touchmove event.\n\t\t_body && _body.addEventListener(\"touchstart\", _emptyFunc); //works around Safari bug: https://gsap.com/forums/topic/21450-draggable-in-iframe-on-mobile-is-buggy/\n\t\t_coreInitted = 1;\n\t},\n\t_onPress = function(e) {\n\t\tlet self = this,\n\t\t\tctm = getGlobalMatrix(self.target.parentNode, true), //previously used self.target.parentNode.getScreenCTM().inverse() but there's a major bug in Firefox that prevents it from working properly when there's an ancestor with a transform applied, so we bootstrapped our own solution that seems to work great across all browsers.\n\t\t\ttouchEventTarget, temp;\n\t\tthis._matrix = this.target.transform.baseVal.getItem(0).matrix;\n\t\tthis._ctm = ctm;\n\t\tif (_touchEventLookup[e.type]) { //note: on iOS, BOTH touchmove and mousemove are dispatched, but the mousemove has pageY and pageX of 0 which would mess up the calculations and needlessly hurt performance.\n\t\t\ttouchEventTarget = (e.type.indexOf(\"touch\") !== -1) ? (e.currentTarget || e.target) : _doc; //pointer-based touches (for Microsoft browsers) don't remain locked to the original target like other browsers, so we must use the document instead. The event type would be \"MSPointerDown\" or \"pointerdown\".\n\t\t\t_addListener(touchEventTarget, \"touchend\", self._onRelease);\n\t\t\t_addListener(touchEventTarget, \"touchmove\", self._onMove);\n\t\t\t_addListener(touchEventTarget, \"touchcancel\", self._onRelease);\n\t\t\t_addListener(_doc, \"touchstart\", _onMultiTouchDocument);\n\t\t\t_addListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n\t\t} else {\n\t\t\ttouchEventTarget = null;\n\t\t\t_addListener(_doc, \"mousemove\", self._onMove); //attach these to the document instead of the box itself so that if the user's mouse moves too quickly (and off of the box), things still work.\n\t\t}\n\t\tif (!_supportsPointer) {\n\t\t\t_addListener(_doc, \"mouseup\", self._onRelease);\n\t\t}\n\t\t_preventDefault(e);\n\t\t_resetSelection(); // when a PathEditor is in an iframe in an environment like codepen, this helps avoid situations where the DELETE key won't actually work because the parent frame is intercepting the event.\n\t\tif (e.changedTouches) { //touch events store the data slightly differently\n\t\t\te = self.touch = e.changedTouches[0];\n\t\t\tself.touchID = e.identifier;\n\t\t} else if (e.pointerId) {\n\t\t\tself.touchID = e.pointerId; //for some Microsoft browsers\n\t\t} else {\n\t\t\tself.touch = self.touchID = null;\n\t\t}\n\t\tself._startPointerY = self.pointerY = e.pageY; //record the starting x and y so that we can calculate the movement from the original in _onMouseMove\n\t\tself._startPointerX = self.pointerX = e.pageX;\n\t\tself._startElementX = self._matrix.e;\n\t\tself._startElementY = self._matrix.f;\n\n\t\tif (this._ctm.a === 1 && this._ctm.b === 0 && this._ctm.c === 0 && this._ctm.d === 1) {\n\t\t\tthis._ctm = null;\n\t\t} else {\n\t\t\ttemp = self._startPointerX * this._ctm.a + self._startPointerY * this._ctm.c + this._ctm.e;\n\t\t\tself._startPointerY = self._startPointerX * this._ctm.b + self._startPointerY * this._ctm.d + this._ctm.f;\n\t\t\tself._startPointerX = temp;\n\t\t}\n\n\t\tself.isPressed = _isPressed = true;\n\t\tself.touchEventTarget = touchEventTarget;\n\t\tif (self.vars.onPress) {\n\t\t\tself.vars.onPress.call(self.vars.callbackScope || self, self.pointerEvent);\n\t\t}\n\t},\n\t_onMove = function(e) {\n\t\tlet self = this,\n\t\t\toriginalEvent = e,\n\t\t\ttouches, i;\n\t\tif (!self._enabled || _isMultiTouching || !self.isPressed || !e) {\n\t\t\treturn;\n\t\t}\n\t\tself.pointerEvent = e;\n\t\ttouches = e.changedTouches;\n\t\tif (touches) { //touch events store the data slightly differently\n\t\t\te = touches[0];\n\t\t\tif (e !== self.touch && e.identifier !== self.touchID) { //Usually changedTouches[0] will be what we're looking for, but in case it's not, look through the rest of the array...(and Android browsers don't reuse the event like iOS)\n\t\t\t\ti = touches.length;\n\t\t\t\twhile (--i > -1 && (e = touches[i]).identifier !== self.touchID) {}\n\t\t\t\tif (i < 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (e.pointerId && self.touchID && e.pointerId !== self.touchID) { //for some Microsoft browsers, we must attach the listener to the doc rather than the trigger so that when the finger moves outside the bounds of the trigger, things still work. So if the event we're receiving has a pointerId that doesn't match the touchID, ignore it (for multi-touch)\n\t\t\treturn;\n\t\t}\n\t\t_preventDefault(originalEvent);\n\t\tself.setPointerPosition(e.pageX, e.pageY);\n\t\tif (self.vars.onDrag) {\n\t\t\tself.vars.onDrag.call(self.vars.callbackScope || self, self.pointerEvent);\n\t\t}\n\t},\n\t_onRelease = function(e, force) {\n\t\tlet self = this;\n\t\tif (!self._enabled || !self.isPressed || (e && self.touchID != null && !force && ((e.pointerId && e.pointerId !== self.touchID) || (e.changedTouches && !_hasTouchID(e.changedTouches, self.touchID))))) {  //for some Microsoft browsers, we must attach the listener to the doc rather than the trigger so that when the finger moves outside the bounds of the trigger, things still work. So if the event we're receiving has a pointerId that doesn't match the touchID, ignore it (for multi-touch)\n\t\t\treturn;\n\t\t}\n\t\t_interacted();\n\t\tself.isPressed = _isPressed = false; //TODO: if we want to accommodate multi-touch, we'd need to introduce a counter to track how many touches there are and only toggle this when they're all off.\n\t\tlet originalEvent = e,\n\t\t\twasDragging = self.isDragging,\n\t\t\ttouchEventTarget = self.touchEventTarget,\n\t\t\ttouches, i;\n\t\tif (touchEventTarget) {\n\t\t\t_removeListener(touchEventTarget, \"touchend\", self._onRelease);\n\t\t\t_removeListener(touchEventTarget, \"touchmove\", self._onMove);\n\t\t\t_removeListener(touchEventTarget, \"touchcancel\", self._onRelease);\n\t\t\t_removeListener(_doc, \"touchstart\", _onMultiTouchDocument);\n\t\t} else {\n\t\t\t_removeListener(_doc, \"mousemove\", self._onMove);\n\t\t}\n\t\tif (!_supportsPointer) {\n\t\t\t_removeListener(_doc, \"mouseup\", self._onRelease);\n\t\t\tif (e && e.target) {\n\t\t\t\t_removeListener(e.target, \"mouseup\", self._onRelease);\n\t\t\t}\n\t\t}\n\t\tif (wasDragging) {\n\t\t\tself.isDragging = false;\n\t\t} else if (self.vars.onClick) {\n\t\t\tself.vars.onClick.call(self.vars.callbackScope || self, originalEvent);\n\t\t}\n\t\tif (e) {\n\t\t\ttouches = e.changedTouches;\n\t\t\tif (touches) { //touch events store the data slightly differently\n\t\t\t\te = touches[0];\n\t\t\t\tif (e !== self.touch && e.identifier !== self.touchID) { //Usually changedTouches[0] will be what we're looking for, but in case it's not, look through the rest of the array...(and Android browsers don't reuse the event like iOS)\n\t\t\t\t\ti = touches.length;\n\t\t\t\t\twhile (--i > -1 && (e = touches[i]).identifier !== self.touchID) {}\n\t\t\t\t\tif (i < 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.pointerEvent = originalEvent;\n\t\t\tself.pointerX = e.pageX;\n\t\t\tself.pointerY = e.pageY;\n\t\t}\n\t\tif (originalEvent && !wasDragging && self.vars.onDragRelease) {\n\t\t\tself.vars.onDragRelease.call(self, self.pointerEvent);\n\n\t\t} else {\n\t\t\tif (originalEvent) {\n\t\t\t\t_preventDefault(originalEvent);\n\t\t\t}\n\t\t\tif (self.vars.onRelease) {\n\t\t\t\tself.vars.onRelease.call(self.vars.callbackScope || self, self.pointerEvent);\n\t\t\t}\n\t\t}\n\t\tif (wasDragging && self.vars.onDragEnd) {\n\t\t\tself.vars.onDragEnd.call(self.vars.callbackScope || self, self.pointerEvent);\n\t\t}\n\t\treturn true;\n\t},\n\t_createSegmentAnchors = (rawPath, j, editor, vars) => {\n\t\tlet segment = rawPath[j],\n\t\t\tl = segment.length - (segment.closed ? 6 : 0),\n\t\t\ta = [],\n\t\t\ti;\n\t\tfor (i = 0; i < l; i+=6) {\n\t\t\ta.push(new Anchor(editor, rawPath, j, i, vars));\n\t\t}\n\t\tsegment.closed && (a[0].isClosedStart = true);\n\t\treturn a;\n\t},\n\t_getLength = (segment, i, i2) => { //i is the starting index, and it'll return the length to the next x/y pair. So if you're looking for the length to handle1, you'd feed in the index of the handle control point x whereas if you're looking for the length to handle2, i would be the x of the anchor.\n\t\tlet x = segment[i2] - segment[i],\n\t\t\ty = segment[i2+1] - segment[i+1];\n\t\treturn Math.sqrt(x * x + y * y);\n\t};\n\n\nclass DraggableSVG {\n\n\tconstructor(target, vars) {\n\t\tthis.target = (typeof(target) === \"string\") ? _doc.querySelectorAll(target)[0] : target;\n\t\tthis.vars = vars || {};\n\t\tthis._onPress = _bind(_onPress, this);\n\t\tthis._onMove = _bind(_onMove, this);\n\t\tthis._onRelease = _bind(_onRelease, this);\n\t\tthis.target.setAttribute(\"transform\", (this.target.getAttribute(\"transform\") || \"\") + \" translate(0,0)\");\n\t\tthis._matrix = _getConsolidatedMatrix(this.target);\n\t\tthis.x = this._matrix.e;\n\t\tthis.y = this._matrix.f;\n\t\tthis.snap = vars.snap;\n\t\tif (!isNaN(vars.maxX) || !isNaN(vars.minX)) {\n\t\t\tthis._bounds = 1;\n\t\t\tthis.maxX = +vars.maxX;\n\t\t\tthis.minX = +vars.minX;\n\t\t} else {\n\t\t\tthis._bounds = 0;\n\t\t}\n\t\tthis.enabled(true);\n\t}\n\n\tsetPointerPosition(pointerX, pointerY) {\n\t\tlet rnd = 1000,\n\t\t\txChange, yChange, x, y, temp;\n\t\tthis.pointerX = pointerX;\n\t\tthis.pointerY = pointerY;\n\t\tif (this._ctm) {\n\t\t\ttemp = pointerX * this._ctm.a + pointerY * this._ctm.c + this._ctm.e;\n\t\t\tpointerY = pointerX * this._ctm.b + pointerY * this._ctm.d + this._ctm.f;\n\t\t\tpointerX = temp;\n\t\t}\n\t\tyChange = (pointerY - this._startPointerY);\n\t\txChange = (pointerX - this._startPointerX);\n\t\tif (yChange < _minimumMovement && yChange > -_minimumMovement) {\n\t\t\tyChange = 0;\n\t\t}\n\t\tif (xChange < _minimumMovement && xChange > -_minimumMovement) {\n\t\t\txChange = 0;\n\t\t}\n\t\tx = (((this._startElementX + xChange) * rnd) | 0) / rnd;\n\t\ty = (((this._startElementY + yChange) * rnd) | 0) / rnd;\n\t\tif (this.snap && !_SHIFT) {\n\t\t\t_point.x = x;\n\t\t\t_point.y = y;\n\t\t\tthis.snap.call(this, _point);\n\t\t\tx = _point.x;\n\t\t\ty = _point.y;\n\t\t}\n\t\tif (this.x !== x || this.y !== y) {\n\t\t\tthis._matrix.f = this.y = y;\n\t\t\tthis._matrix.e = this.x = x;\n\t\t\tif (!this.isDragging && this.isPressed) {\n\t\t\t\tthis.isDragging = true;\n\t\t\t\t_callback(\"onDragStart\", this, this.pointerEvent);\n\t\t\t}\n\t\t}\n\t}\n\n\tenabled(enabled) {\n\t\tif (!arguments.length) {\n\t\t\treturn this._enabled;\n\t\t}\n\t\tlet dragging;\n\t\tthis._enabled = enabled;\n\t\tif (enabled) {\n\t\t\tif (!_supportsPointer) {\n\t\t\t\t_addListener(this.target, \"mousedown\", this._onPress);\n\t\t\t}\n\t\t\t_addListener(this.target, \"touchstart\", this._onPress);\n\t\t\t_addListener(this.target, \"click\", this._onClick, true); //note: used to pass true for capture but it prevented click-to-play-video functionality in Firefox.\n\t\t} else {\n\t\t\tdragging = this.isDragging;\n\t\t\t_removeListener(this.target, \"mousedown\", this._onPress);\n\t\t\t_removeListener(this.target, \"touchstart\", this._onPress);\n\t\t\t_removeListener(_win, \"touchforcechange\", _preventDefault);\n\t\t\t_removeListener(this.target, \"click\", this._onClick);\n\t\t\tif (this.touchEventTarget) {\n\t\t\t\t_removeListener(this.touchEventTarget, \"touchcancel\", this._onRelease);\n\t\t\t\t_removeListener(this.touchEventTarget, \"touchend\", this._onRelease);\n\t\t\t\t_removeListener(this.touchEventTarget, \"touchmove\", this._onMove);\n\t\t\t}\n\t\t\t_removeListener(_doc, \"mouseup\", this._onRelease);\n\t\t\t_removeListener(_doc, \"mousemove\", this._onMove);\n\t\t\tthis.isDragging = this.isPressed = false;\n\t\t\tif (dragging) {\n\t\t\t\t_callback(\"onDragEnd\", this, this.pointerEvent);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tendDrag(e) {\n\t\tthis._onRelease(e);\n\t}\n\n}\n\n\n\n\n\nclass Anchor {\n\n\tconstructor(editor, rawPath, j, i, vars) {\n\t\tthis.editor = editor;\n\t\tthis.element = _createSVG(\"path\", editor._selection, {fill:_selectionColor, stroke:_selectionColor, strokeWidth:2, vectorEffect:\"non-scaling-stroke\"});\n\t\tthis.update(rawPath, j, i);\n\t\tthis.element._gsSelection = true;\n\t\tthis.vars = vars || {};\n\t\tthis._draggable = new DraggableSVG(this.element, {callbackScope:this, onDrag:this.onDrag, snap:this.vars.snap, onPress:this.onPress, onRelease:this.onRelease, onClick:this.onClick, onDragEnd:this.onDragEnd});\n\t}\n\n\tonPress() {\n\t\t_callback(\"onPress\", this);\n\t}\n\n\tonClick() {\n\t\t_callback(\"onClick\", this);\n\t}\n\n\tonDrag() {\n\t\tlet s = this.segment;\n\t\tthis.vars.onDrag.call(this.vars.callbackScope || this, this, this._draggable.x - s[this.i], this._draggable.y - s[this.i+1]);\n\t}\n\n\tonDragEnd() {\n\t\t_callback(\"onDragEnd\", this);\n\t}\n\n\tonRelease() {\n\t\t_callback(\"onRelease\", this);\n\t}\n\n\tupdate(rawPath, j, i) {\n\t\tif (rawPath) {\n\t\t\tthis.rawPath = rawPath;\n\t\t}\n\t\tif (arguments.length <= 1) {\n\t\t\tj = this.j;\n\t\t\ti = this.i;\n\t\t} else {\n\t\t\tthis.j = j;\n\t\t\tthis.i = i;\n\t\t}\n\t\tlet prevSmooth = this.smooth,\n\t\t\tsegment = this.rawPath[j],\n\t\t\tpi = i === 0 && segment.closed ? segment.length - 4 : i - 2;\n\t\tthis.segment = segment;\n\t\tthis.smooth = (i > 0 && i < segment.length - 2 && Math.abs(Math.atan2(segment[i+1] - segment[pi+1], segment[i] - segment[pi]) - Math.atan2(segment[i+3] - segment[i+1], segment[i+2] - segment[i])) < 0.09) ? 2 : 0; //0: corner, 1: smooth but not mirrored, 2: smooth and mirrored.\n\t\tif (this.smooth !== prevSmooth) {\n\t\t\tthis.element.setAttribute(\"d\", this.smooth ? this.editor._circleHandle : this.editor._squareHandle);\n\t\t}\n\t\tthis.element.setAttribute(\"transform\", \"translate(\" + segment[i] + \",\" + segment[i+1] + \")\");\n\t}\n}\n\n\n\n\nexport class PathEditor {\n\n\tconstructor(target, vars) {\n\t\tvars = vars || {};\n\t\t_coreInitted || _initCore();\n\t\tthis.vars = vars;\n\t\tthis.path = (typeof(target) === \"string\") ? _doc.querySelectorAll(target)[0] : target;\n\t\tthis._g = _createSVG(\"g\", this.path.ownerSVGElement, {class:\"path-editor-g path-editor\"});\n\t\tthis._selectionHittest = _createSVG(\"path\", this._g, {stroke:\"transparent\", strokeWidth:16, fill:\"none\", vectorEffect:\"non-scaling-stroke\"});\n\t\tthis._selection = vars._selection || _createSVG(\"g\", this._g, {class:\"path-editor-selection path-editor\"});\n\t\tthis._selectionPath = _createSVG(\"path\", this._selection, {stroke:_selectionColor, strokeWidth:2, fill:\"none\", vectorEffect:\"non-scaling-stroke\"});\n\t\tthis._selectedAnchors = [];\n\t\tthis._line1 = _createSVG(\"polyline\", this._selection, {stroke:_selectionColor, strokeWidth:2, vectorEffect:\"non-scaling-stroke\"});\n\t\tthis._line2 = _createSVG(\"polyline\", this._selection, {stroke:_selectionColor, strokeWidth:2, vectorEffect:\"non-scaling-stroke\"});\n\t\tthis._line1.style.pointerEvents = this._line2.style.pointerEvents = this._selectionPath.style.pointerEvents = \"none\";\n\t\tthis._enabled = true;\n\t\tlet ctm = this.path.parentNode.getScreenCTM().inverse(),\n\t\t\tsize = (ctm.a + ctm.d) / 2 * (vars.handleSize || 5);\n\t\tthis._squareHandle = _getSquarePathData(size);\n\t\tthis._circleHandle = _getCirclePathData(size * 1.15);\n\t\tthis._handle1 = _createSVG(\"path\", this._selection, {d:this._squareHandle, fill:_selectionColor, stroke:\"transparent\", strokeWidth:6});\n\t\tthis._handle2 = _createSVG(\"path\", this._selection, {d:this._squareHandle, fill:_selectionColor, stroke:\"transparent\", strokeWidth:6});\n\t\tthis._handle1._draggable = new DraggableSVG(this._handle1, {onDrag:this._onDragHandle1, callbackScope:this, onPress:this._onPressHandle1, onRelease:this._onReleaseHandle, onClick:this._onClickHandle1, snap:vars.handleSnap});\n\t\tthis._handle2._draggable = new DraggableSVG(this._handle2, {onDrag:this._onDragHandle2, callbackScope:this, onPress:this._onPressHandle2, onRelease:this._onReleaseHandle, onClick:this._onClickHandle2, snap:vars.handleSnap});\n\t\tthis._handle1.style.visibility = this._handle2.style.visibility = \"hidden\";\n\t\tlet selectionItems = [this._handle1, this._handle2, this._line1, this._line2, this._selection, this._selectionPath, this._selectionHittest],\n\t\t\ti = selectionItems.length;\n\t\twhile (--i > -1) {\n\t\t\tselectionItems[i]._gsSelection = true; //just a flag we can check in the _checkDeselect() method to detect clicks on things that are selection-related.\n\t\t}\n\t\tif (vars.draggable !== false) {\n\t\t\tthis._draggable = new DraggableSVG(this._selectionHittest, {callbackScope:this, onPress:this.select, onRelease:this._onRelease, onDrag:this._onDragPath, onDragEnd:this._saveState, maxX:this.vars.maxX, minX:this.vars.minX});\n\t\t}\n\t\tthis.init();\n\t\tthis._selection.style.visibility = (vars.selected === false) ? \"hidden\" : \"visible\";\n\t\tif (vars.selected !== false) {\n\t\t\tthis.path._gsSelection = true;\n\t\t\t_selectedPaths.push(this);\n\t\t}\n\t\tthis._saveState();\n\t\tif (!_supportsPointer) {\n\t\t\t_addListener(this._selectionHittest, \"mousedown\", _bind(this._onClickSelectionPath, this));\n\t\t\t_addListener(this._selectionHittest, \"mouseup\", _bind(this._onRelease, this));\n\t\t}\n\t\t_addListener(this._selectionHittest, \"touchstart\", _bind(this._onClickSelectionPath, this));\n\t\t_addListener(this._selectionHittest, \"touchend\", _bind(this._onRelease, this));\n\t\t_context(this);\n\t}\n\n\t_onRelease(e) {\n\t\tlet anchor = this._editingAnchor;\n\t\tif (anchor) {\n\t\t\t_editingAxis.x = anchor.segment[anchor.i];\n\t\t\t_editingAxis.y = anchor.segment[anchor.i+1];\n\t\t}\n\t\t_removeListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n\t\t_callback(\"onRelease\", this, e);\n\t}\n\n\tinit() {\n\t\tlet pathData = this.path.getAttribute(\"d\"),\n\t\t\trawPath = stringToRawPath(pathData),\n\t\t\ttransform = this.path.getAttribute(\"transform\") || \"translate(0,0)\",\n\t\t\tcreateAnchors = (!this._rawPath || rawPath.totalPoints !== this._rawPath.totalPoints || rawPath.length !== this._rawPath.length),\n\t\t\tanchorVars = {callbackScope:this, snap:this.vars.anchorSnap, onDrag:this._onDragAnchor, onPress:this._onPressAnchor, onRelease:this._onRelease, onClick:this._onClickAnchor, onDragEnd:this._onDragEndAnchor, maxX:this.vars.maxX, minX:this.vars.minX},\n\t\t\tl, i;\n\n\t\tif (createAnchors && this._anchors && this._anchors.length) {\n\t\t\tfor (i = 0; i < this._anchors.length; i++) {\n\t\t\t\tthis._anchors[i].element.parentNode.removeChild(this._anchors[i].element);\n\t\t\t\tthis._anchors[i]._draggable.enabled(false);\n\t\t\t}\n\t\t\tthis._selectedAnchors.length = 0;\n\t\t}\n\t\tthis._rawPath = rawPath;\n\t\tif (createAnchors) {\n\t\t\tthis._anchors = _createSegmentAnchors(rawPath, 0, this, anchorVars);\n\t\t\tl = rawPath.length;\n\t\t\tif (l > 1) {\n\t\t\t\tfor (i = 1; i < l; i++) {\n\t\t\t\t\tthis._anchors = this._anchors.concat(_createSegmentAnchors(rawPath, i, this, anchorVars));\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\ti = this._anchors.length;\n\t\t\twhile (--i > -1) {\n\t\t\t\tthis._anchors[i].update(rawPath);\n\t\t\t}\n\t\t}\n\n\t\tthis._selection.appendChild(this._handle1); //for stacking order (handles should always be on top)\n\t\tthis._selection.appendChild(this._handle2);\n\t\t//\t\tthis._selectedAnchors.length = 0;\n\t\tthis._selectionPath.setAttribute(\"d\", pathData);\n\t\tthis._selectionHittest.setAttribute(\"d\", pathData);\n\t\tthis._g.setAttribute(\"transform\", _getConcatenatedTransforms(this.path.parentNode) || \"translate(0,0)\");\n\t\tthis._selection.setAttribute(\"transform\", transform);\n\t\tthis._selectionHittest.setAttribute(\"transform\", transform);\n\t\tthis._updateAnchors();\n\t\treturn this;\n\t}\n\n\t_saveState() {\n\t\t_addHistory(this);\n\t}\n\n\t_onClickSelectionPath(e) {\n\t\tif (this._selection.style.visibility === \"hidden\") {\n\t\t\tthis.select();\n\t\t} else if (_ALT || (e && e.altKey)) {\n\t\t\tlet anchorVars = {callbackScope:this, snap:this.vars.anchorSnap, onDrag:this._onDragAnchor, onPress:this._onPressAnchor, onRelease:this._onRelease, onClick:this._onClickAnchor, onDragEnd:this._onDragEndAnchor, maxX:this.vars.maxX, minX:this.vars.minX},\n\t\t\t\tctm = this._selection.getScreenCTM().inverse(),\n\t\t\t\tnewIndex, i, anchor, x, y, closestData;\n\t\t\tif (this._draggable) {\n\t\t\t\tthis._draggable._onRelease(e); //otherwise, ALT-click/dragging on a path would create a new anchor AND drag the entire path.\n\t\t\t}\n\t\t\tif (ctm) {\n\t\t\t\tx = e.clientX * ctm.a + e.clientY * ctm.c + ctm.e;\n\t\t\t\ty = e.clientX * ctm.b + e.clientY * ctm.d + ctm.f;\n\t\t\t}\n\t\t\t//DEBUG: _createSVG(\"circle\", this._selection, {fill:\"red\", r:5, cx:x, cy:y});\n\t\t\tclosestData = getClosestData(this._rawPath, x, y);\n\t\t\tsubdivideSegment(this._rawPath[closestData.j], closestData.i, closestData.t);\n\t\t\tnewIndex = closestData.i + 6;\n\t\t\tfor (i = 0; i < this._anchors.length; i++) {\n\t\t\t\tif (this._anchors[i].i >= newIndex && this._anchors[i].j === closestData.j) {\n\t\t\t\t\tthis._anchors[i].i += 6;\n\t\t\t\t}\n\t\t\t}\n\t\t\tanchor = new Anchor(this, this._rawPath, closestData.j, newIndex, anchorVars);\n\t\t\tthis._selection.appendChild(this._handle1); //for stacking order (handles should always be on top)\n\t\t\tthis._selection.appendChild(this._handle2);\n\t\t\tanchor._draggable._onPress(e);\n\t\t\t_recentlyAddedAnchor = anchor;\n\t\t\tthis._anchors.push(anchor);\n\t\t\tthis._selectedAnchors.length = 0;\n\t\t\tthis._selectedAnchors.push(anchor);\n\t\t\tthis._updateAnchors();\n\t\t\tthis.update();\n\t\t\tthis._saveState();\n\t\t}\n\t\t_resetSelection();\n\t\t_addListener(_win, \"touchforcechange\", _preventDefault); //otherwise iOS will scroll when dragging.\n\t\t_callback(\"onPress\", this);\n\t}\n\n\t_onClickHandle1() {\n\t\tlet anchor = this._editingAnchor,\n\t\t\ti = anchor.i,\n\t\t\ts = anchor.segment,\n\t\t\tpi = anchor.isClosedStart ? s.length - 4 : i - 2;\n\t\tif (_ALT && Math.abs(s[i] - s[pi]) < 5 && Math.abs(s[i+1] - s[pi+1]) < 5) {\n\t\t\tthis._onClickAnchor(anchor);\n\t\t}\n\t}\n\n\t_onClickHandle2() {\n\t\tlet anchor = this._editingAnchor,\n\t\t\ti = anchor.i,\n\t\t\ts = anchor.segment;\n\t\tif (_ALT && Math.abs(s[i] - s[i+2]) < 5 && Math.abs(s[i+1] - s[i+3]) < 5) {\n\t\t\tthis._onClickAnchor(anchor);\n\t\t}\n\t}\n\n\t_onDragEndAnchor(e) {\n\t\t_recentlyAddedAnchor = null;\n\t\tthis._saveState();\n\t}\n\n\tisSelected() {\n\t\treturn (this._selectedAnchors.length > 0 || this._selection.style.visibility === \"visible\");\n\t}\n\n\tselect(allAnchors) {\n\t\tthis._selection.style.visibility = \"visible\";\n\t\tthis._editingAnchor = null;\n\t\tthis.path._gsSelection = true;\n\t\tif (allAnchors === true) {\n\t\t\tlet i = this._anchors.length;\n\t\t\twhile (--i > -1) {\n\t\t\t\tthis._selectedAnchors[i] = this._anchors[i];\n\t\t\t}\n\t\t}\n\t\tif (_selectedPaths.indexOf(this) === -1) {\n\t\t\t_selectedPaths.push(this);\n\t\t}\n\t\tthis._updateAnchors();\n\t\treturn this;\n\t}\n\n\tdeselect() {\n\t\tthis._selection.style.visibility = \"hidden\";\n\t\tthis._selectedAnchors.length = 0;\n\t\tthis._editingAnchor = null;\n\t\tthis.path._gsSelection = false;\n\t\t_selectedPaths.splice(_selectedPaths.indexOf(this), 1);\n\t\tthis._updateAnchors();\n\t\treturn this;\n\t}\n\n\t_onDragPath(e) {\n\t\tlet transform = this._selectionHittest.getAttribute(\"transform\") || \"translate(0,0)\";\n\t\tthis._selection.setAttribute(\"transform\", transform);\n\t\tthis.path.setAttribute(\"transform\", transform);\n\t}\n\n\t_onPressAnchor(anchor) {\n\t\tif (this._selectedAnchors.indexOf(anchor) === -1) { //if it isn't already selected...\n\t\t\tif (!_SHIFT) {\n\t\t\t\tthis._selectedAnchors.length = 0;\n\t\t\t}\n\t\t\tthis._selectedAnchors.push(anchor);\n\t\t} else if (_SHIFT) {\n\t\t\tthis._selectedAnchors.splice(this._selectedAnchors.indexOf(anchor), 1);\n\t\t\tanchor._draggable.endDrag();\n\t\t}\n\t\t_editingAxis.x = anchor.segment[anchor.i];\n\t\t_editingAxis.y = anchor.segment[anchor.i+1];\n\t\tthis._updateAnchors();\n\t\t_callback(\"onPress\", this);\n\t}\n\n\t_deleteSelectedAnchors() {\n\t\tlet anchors = this._selectedAnchors,\n\t\t\ti = anchors.length,\n\t\t\tanchor, index, j, jIndex;\n\t\twhile (--i > -1) {\n\t\t\tanchor = anchors[i];\n\t\t\tanchor.element.parentNode.removeChild(anchor.element);\n\t\t\tanchor._draggable.enabled(false);\n\t\t\tindex = anchor.i;\n\t\t\tjIndex = anchor.j;\n\t\t\tif (!index) { //first\n\t\t\t\tanchor.segment.splice(index, 6);\n\t\t\t} else if (index < anchor.segment.length - 2) {\n\t\t\t\tanchor.segment.splice(index-2, 6);\n\t\t\t} else { //last\n\t\t\t\tanchor.segment.splice(index-4, 6);\n\t\t\t}\n\t\t\tanchors.splice(i, 1);\n\t\t\tthis._anchors.splice(this._anchors.indexOf(anchor), 1);\n\t\t\tfor (j = 0; j < this._anchors.length; j++) {\n\t\t\t\tif (this._anchors[j].i >= index && this._anchors[j].j === jIndex) {\n\t\t\t\t\tthis._anchors[j].i -= 6;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._updateAnchors();\n\t\tthis.update();\n\t\tthis._saveState();\n\t\tif (this.vars.onDeleteAnchor) {\n\t\t\tthis.vars.onDeleteAnchor.call(this.vars.callbackScope || this);\n\t\t}\n\t}\n\n\t_onClickAnchor(anchor) {\n\t\tlet i = anchor.i,\n\t\t\tsegment = anchor.segment,\n\t\t\tpi = anchor.isClosedStart ? segment.length - 4 : i - 2,\n\t\t\trnd = 1000,\n\t\t\tisEnd = (!i || i >= segment.length - 2),\n\t\t\tangle1, angle2, length1, length2, sin, cos;\n\t\tif (_ALT && _recentlyAddedAnchor !== anchor && this._editingAnchor) {\n\t\t\tanchor.smooth = !anchor.smooth;\n\t\t\tif (isEnd && !anchor.isClosedStart) { //the very ends can't be \"smooth\"\n\t\t\t\tanchor.smooth = false;\n\t\t\t}\n\t\t\tanchor.element.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n\t\t\tif (anchor.smooth && (!isEnd || anchor.isClosedStart)) {\n\t\t\t\tangle1 = Math.atan2(segment[i+1] - segment[pi+1], segment[i] - segment[pi]);\n\t\t\t\tangle2 = Math.atan2(segment[i+3] - segment[i+1], segment[i+2] - segment[i]);\n\t\t\t\tangle1 = (angle1 + angle2) / 2;\n\t\t\t\tlength1 = _getLength(segment, pi, i);\n\t\t\t\tlength2 = _getLength(segment, i, i+2);\n\t\t\t\tif (length1 < 0.2) {\n\t\t\t\t\tlength1 = (_getLength(segment, i, pi-4) / 4);\n\t\t\t\t\tangle1 = angle2 || Math.atan2(segment[i+7] - segment[pi-3], segment[i+6] - segment[pi-4]);\n\t\t\t\t}\n\t\t\t\tif (length2 < 0.2) {\n\t\t\t\t\tlength2 = (_getLength(segment, i, i+6) / 4);\n\t\t\t\t\tangle2 = angle1 || Math.atan2(segment[i+7] - segment[pi-3], segment[i+6] - segment[pi-4]);\n\t\t\t\t}\n\t\t\t\tsin = Math.sin(angle1);\n\t\t\t\tcos = Math.cos(angle1);\n\t\t\t\tif (Math.abs(angle2 - angle1) < Math.PI / 2) {\n\t\t\t\t\tsin = -sin;\n\t\t\t\t\tcos = -cos;\n\t\t\t\t}\n\t\t\t\tsegment[pi] = (((segment[i] + cos * length1) * rnd) | 0) / rnd;\n\t\t\t\tsegment[pi+1] = (((segment[i+1] + sin * length1) * rnd) | 0) / rnd;\n\t\t\t\tsegment[i+2] = (((segment[i] - cos * length2) * rnd) | 0) / rnd;\n\t\t\t\tsegment[i+3] = (((segment[i+1] - sin * length2) * rnd) | 0) / rnd;\n\t\t\t\tthis._updateAnchors();\n\t\t\t\tthis.update();\n\t\t\t\tthis._saveState();\n\t\t\t} else if (!anchor.smooth && (!isEnd || anchor.isClosedStart)) {\n\t\t\t\tif (i || anchor.isClosedStart) {\n\t\t\t\t\tsegment[pi] = segment[i];\n\t\t\t\t\tsegment[pi+1] = segment[i+1];\n\t\t\t\t}\n\t\t\t\tif (i < segment.length - 2) {\n\t\t\t\t\tsegment[i+2] = segment[i];\n\t\t\t\t\tsegment[i+3] = segment[i+1];\n\t\t\t\t}\n\t\t\t\tthis._updateAnchors();\n\t\t\t\tthis.update();\n\t\t\t\tthis._saveState();\n\t\t\t}\n\t\t} else if (!_SHIFT) {\n\t\t\tthis._selectedAnchors.length = 0;\n\t\t\tthis._selectedAnchors.push(anchor);\n\t\t}\n\t\t_recentlyAddedAnchor = null;\n\t\tthis._updateAnchors();\n\t}\n\n\t_updateAnchors() {\n\t\tlet anchor = (this._selectedAnchors.length === 1) ? this._selectedAnchors[0] : null,\n\t\t\tsegment = anchor ? anchor.segment : null,\n\t\t\ti, x, y;\n\t\tthis._editingAnchor = anchor;\n\t\tfor (i = 0; i < this._anchors.length; i++) {\n\t\t\tthis._anchors[i].element.style.fill = (this._selectedAnchors.indexOf(this._anchors[i]) !== -1) ? _selectionColor : \"white\";\n\t\t\t//this._anchors[i].element.setAttribute(\"fill\", (this._selectedAnchors.indexOf(this._anchors[i]) !== -1) ? _selectionColor : \"white\");\n\t\t}\n\t\tif (anchor) {\n\t\t\tthis._handle1.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n\t\t\tthis._handle2.setAttribute(\"d\", anchor.smooth ? this._circleHandle : this._squareHandle);\n\t\t}\n\t\ti = anchor ? anchor.i : 0;\n\t\tif (anchor && (i || anchor.isClosedStart)) {\n\t\t\tx = anchor.isClosedStart ? segment[segment.length-4] : segment[i-2];\n\t\t\ty = anchor.isClosedStart ? segment[segment.length-3] : segment[i-1]; //TODO: if they equal the anchor coordinates, just hide it.\n\t\t\tthis._handle1.style.visibility = this._line1.style.visibility = (!_ALT && x === segment[i] && y === segment[i+1]) ? \"hidden\" : \"visible\";\n\t\t\tthis._handle1.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n\t\t\tthis._line1.setAttribute(\"points\",  x + _comma + y + _comma + segment[i] + _comma + segment[i+1]);\n\t\t} else {\n\t\t\tthis._handle1.style.visibility = this._line1.style.visibility = \"hidden\";\n\t\t}\n\t\tif (anchor && i < segment.length - 2) {\n\t\t\tx = segment[i+2];\n\t\t\ty = segment[i+3];\n\t\t\tthis._handle2.style.visibility = this._line2.style.visibility = (!_ALT && x === segment[i] && y === segment[i+1]) ? \"hidden\" : \"visible\";\n\t\t\tthis._handle2.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n\t\t\tthis._line2.setAttribute(\"points\",  segment[i] + _comma + segment[i+1] + _comma + x + _comma + y);\n\n\t\t} else {\n\t\t\tthis._handle2.style.visibility = this._line2.style.visibility = \"hidden\";\n\t\t}\n\t}\n\n\t_onPressAlt() {\n\t\tlet anchor = this._editingAnchor;\n\t\tif (anchor) {\n\t\t\tif (anchor.i || anchor.isClosedStart) {\n\t\t\t\tthis._handle1.style.visibility = this._line1.style.visibility = \"visible\";\n\t\t\t}\n\t\t\tif (anchor.i < anchor.segment.length - 2) {\n\t\t\t\tthis._handle2.style.visibility = this._line2.style.visibility = \"visible\";\n\t\t\t}\n\t\t}\n\t}\n\n\t_onReleaseAlt() {\n\t\tlet anchor = this._editingAnchor,\n\t\t\ts, i, pi;\n\t\tif (anchor) {\n\t\t\ts = anchor.segment;\n\t\t\ti = anchor.i;\n\t\t\tpi = anchor.isClosedStart ? s.length - 4 : i - 2;\n\t\t\tif (s[i] === s[pi] && s[i+1] === s[pi+1]) {\n\t\t\t\tthis._handle1.style.visibility = this._line1.style.visibility = \"hidden\";\n\t\t\t}\n\t\t\tif (s[i] === s[i+2] && s[i+1] === s[i+3]) {\n\t\t\t\tthis._handle2.style.visibility = this._line2.style.visibility = \"hidden\";\n\t\t\t}\n\t\t}\n\t}\n\n\t_onPressHandle1() {\n\t\tif (this._editingAnchor.smooth) {\n\t\t\tthis._oppositeHandleLength = _getLength(this._editingAnchor.segment, this._editingAnchor.i, this._editingAnchor.i+2);\n\t\t}\n\t\t_callback(\"onPress\", this);\n\t}\n\n\t_onPressHandle2() {\n\t\tif (this._editingAnchor.smooth) {\n\t\t\tthis._oppositeHandleLength = _getLength(this._editingAnchor.segment, this._editingAnchor.isClosedStart ? this._editingAnchor.segment.length - 4 : this._editingAnchor.i-2, this._editingAnchor.i);\n\t\t}\n\t\t_callback(\"onPress\", this);\n\t}\n\n\t_onReleaseHandle(e) {\n\t\tthis._onRelease(e);\n\t\tthis._saveState();\n\t}\n\n\t_onDragHandle1() {\n\t\tlet anchor = this._editingAnchor,\n\t\t\ts = anchor.segment,\n\t\t\ti = anchor.i,\n\t\t\tpi = anchor.isClosedStart ? s.length-4 : i-2,\n\t\t\trnd = 1000,\n\t\t\tx = this._handle1._draggable.x,\n\t\t\ty = this._handle1._draggable.y,\n\t\t\tangle;\n\t\ts[pi] = x = ((x * rnd) | 0) / rnd;\n\t\ts[pi+1] = y = ((y * rnd) | 0) / rnd;\n\t\tif (anchor.smooth) {\n\t\t\tif (_ALT) {\n\t\t\t\tanchor.smooth = false;\n\t\t\t\tanchor.element.setAttribute(\"d\", this._squareHandle);\n\t\t\t\tthis._handle1.setAttribute(\"d\", this._squareHandle);\n\t\t\t\tthis._handle2.setAttribute(\"d\", this._squareHandle);\n\t\t\t} else {\n\t\t\t\tangle = Math.atan2(s[i+1] - y, s[i] - x);\n\t\t\t\tx = this._oppositeHandleLength * Math.cos(angle);\n\t\t\t\ty = this._oppositeHandleLength * Math.sin(angle);\n\t\t\t\ts[i+2] = (((s[i] + x) * rnd) | 0) / rnd;\n\t\t\t\ts[i+3] = (((s[i+1] + y) * rnd) | 0) / rnd;\n\t\t\t}\n\n\t\t}\n\t\tthis.update();\n\t}\n\n\t_onDragHandle2() {\n\t\tlet anchor = this._editingAnchor,\n\t\t\ts = anchor.segment,\n\t\t\ti = anchor.i,\n\t\t\tpi = anchor.isClosedStart ? s.length-4 : i-2,\n\t\t\trnd = 1000,\n\t\t\tx = this._handle2._draggable.x,\n\t\t\ty = this._handle2._draggable.y,\n\t\t\tangle;\n\t\ts[i+2] = x = ((x * rnd) | 0) / rnd;\n\t\ts[i+3] = y = ((y * rnd) | 0) / rnd;\n\t\tif (anchor.smooth) {\n\t\t\tif (_ALT) {\n\t\t\t\tanchor.smooth = false;\n\t\t\t\tanchor.element.setAttribute(\"d\", this._squareHandle);\n\t\t\t\tthis._handle1.setAttribute(\"d\", this._squareHandle);\n\t\t\t\tthis._handle2.setAttribute(\"d\", this._squareHandle);\n\t\t\t} else {\n\t\t\t\tangle = Math.atan2(s[i+1] - y, s[i] - x);\n\t\t\t\tx = this._oppositeHandleLength * Math.cos(angle);\n\t\t\t\ty = this._oppositeHandleLength * Math.sin(angle);\n\t\t\t\ts[pi] = (((s[i] + x) * rnd) | 0) / rnd;\n\t\t\t\ts[pi+1] = (((s[i+1] + y) * rnd) | 0) / rnd;\n\t\t\t}\n\n\t\t}\n\t\tthis.update();\n\t}\n\n\t_onDragAnchor(anchor, changeX, changeY) {\n\t\tlet anchors = this._selectedAnchors,\n\t\t\tl = anchors.length,\n\t\t\trnd = 1000,\n\t\t\ti, j, s, a, pi;\n\t\tfor (j = 0; j < l; j++) {\n\t\t\ta = anchors[j];\n\t\t\ti = a.i;\n\t\t\ts = a.segment;\n\t\t\tif (i) {\n\t\t\t\ts[i-2] = (((s[i-2] + changeX) * rnd) | 0) / rnd;\n\t\t\t\ts[i-1] = (((s[i-1] + changeY) * rnd) | 0) / rnd;\n\t\t\t} else if (a.isClosedStart) {\n\t\t\t\tpi = s.length-2;\n\t\t\t\ts[pi] = _round(s[pi] + changeX);\n\t\t\t\ts[pi+1] = _round(s[pi+1] + changeY);\n\t\t\t\ts[pi-2] = _round(s[pi-2] + changeX);\n\t\t\t\ts[pi-1] = _round(s[pi-1] + changeY);\n\t\t\t}\n\t\t\ts[i] = (((s[i] + changeX) * rnd) | 0) / rnd;\n\t\t\ts[i+1] = (((s[i+1] + changeY) * rnd) | 0) / rnd;\n\t\t\tif (i < s.length - 2) {\n\t\t\t\ts[i+2] = (((s[i+2] + changeX) * rnd) | 0) / rnd;\n\t\t\t\ts[i+3] = (((s[i+3] + changeY) * rnd) | 0) / rnd;\n\t\t\t}\n\t\t\tif (a !== anchor) {\n\t\t\t\ta.element.setAttribute(\"transform\", \"translate(\" + (s[i]) + _comma + (s[i+1]) + \")\");\n\t\t\t}\n\t\t}\n\t\tthis.update();\n\t}\n\n\tenabled(enabled) {\n\t\tif (!arguments.length) {\n\t\t\treturn this._enabled;\n\t\t}\n\t\tlet i = this._anchors.length;\n\t\twhile (--i > -1) {\n\t\t\tthis._anchors[i]._draggable.enabled(enabled);\n\t\t}\n\t\tthis._enabled = enabled;\n\t\tthis._handle1._draggable.enabled(enabled);\n\t\tthis._handle2._draggable.enabled(enabled);\n\t\tif (this._draggable) {\n\t\t\tthis._draggable.enabled(enabled);\n\t\t}\n\t\tif (!enabled) {\n\t\t\tthis.deselect();\n\t\t\tthis._selectionHittest.parentNode && this._selectionHittest.parentNode.removeChild(this._selectionHittest);\n\t\t\tthis._selection.parentNode && this._selection.parentNode.removeChild(this._selection);\n\t\t} else if (!this._selection.parentNode) {\n\t\t\tthis.path.ownerSVGElement.appendChild(this._selectionHittest);\n\t\t\tthis.path.ownerSVGElement.appendChild(this._selection);\n\t\t\tthis.init();\n\t\t\tthis._saveState();\n\t\t}\n\t\tthis._updateAnchors();\n\t\treturn this.update();\n\t}\n\n\tupdate(readPath) {\n\t\tlet d = \"\",\n\t\t\tanchor = this._editingAnchor,\n\t\t\ti, s, x, y, pi;\n\t\tif (readPath) {\n\t\t\tthis.init();\n\t\t}\n\t\tif (anchor) {\n\t\t\ti = anchor.i;\n\t\t\ts = anchor.segment;\n\t\t\tif (i || anchor.isClosedStart) {\n\t\t\t\tpi = anchor.isClosedStart ? s.length-4 : i-2;\n\t\t\t\tx = s[pi];\n\t\t\t\ty = s[pi+1];\n\t\t\t\tthis._handle1.setAttribute(\"transform\", \"translate(\" + x + _comma + y + \")\");\n\t\t\t\tthis._line1.setAttribute(\"points\", x + _comma + y + _comma + s[i] + _comma + s[i+1]);\n\t\t\t}\n\t\t\tif (i < s.length - 2) {\n\t\t\t\tx = s[i+2];\n\t\t\t\ty = s[i+3];\n\t\t\t\tthis._handle2.setAttribute(\"transform\", \"translate(\" + (x) + _comma + (y) + \")\");\n\t\t\t\tthis._line2.setAttribute(\"points\", s[i] + _comma + s[i+1] + _comma + x + _comma + y);\n\t\t\t}\n\t\t}\n\n\t\tif (readPath) {\n\t\t\td = this.path.getAttribute(\"d\");\n\t\t} else {\n\t\t\tfor (i = 0; i < this._rawPath.length; i++) {\n\t\t\t\ts = this._rawPath[i];\n\t\t\t\tif (s.length > 7) {\n\t\t\t\t\td += \"M\" + s[0] + _comma + s[1] + \"C\" + s.slice(2).join(_comma);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.path.setAttribute(\"d\", d);\n\t\t\tthis._selectionPath.setAttribute(\"d\", d);\n\t\t\tthis._selectionHittest.setAttribute(\"d\", d);\n\t\t}\n\n\t\tif (this.vars.onUpdate && this._enabled) {\n\t\t\t_callback(\"onUpdate\", this, d);\n\t\t}\n\t\treturn this;\n\t}\n\n\tgetRawPath(applyTransforms, offsetX, offsetY) {\n\t\tif (applyTransforms) {\n\t\t\tlet m = _getConsolidatedMatrix(this.path);\n\t\t\treturn transformRawPath(copyRawPath(this._rawPath), 1, 0, 0, 1, m.e + (offsetX || 0), m.f + (offsetY || 0));\n\t\t}\n\t\treturn this._rawPath;\n\t}\n\n\tgetString(applyTransforms, offsetX, offsetY) {\n\t\tif (applyTransforms) {\n\t\t\tlet m = _getConsolidatedMatrix(this.path);\n\t\t\treturn rawPathToString(transformRawPath(copyRawPath(this._rawPath), 1, 0, 0, 1, m.e + (offsetX || 0), m.f + (offsetY || 0)));\n\t\t}\n\t\treturn this.path.getAttribute(\"d\");\n\t}\n\n\tgetNormalizedSVG(height, originY, shorten, onEaseError) {\n\t\tlet s = this._rawPath[0],\n\t\t\ttx = s[0] * -1,\n\t\t\tty = (originY === 0) ? 0 : -(originY || s[1]),\n\t\t\tl = s.length,\n\t\t\tsx = 1 / (s[l-2] + tx),\n\t\t\tsy = -height || (s[l-1] + ty),\n\t\t\trnd = 1000,\n\t\t\tpoints, i, x1, y1, x2, y2;\n\t\t_temp.length = 0;\n\t\tif (sy) { //typically y ends at 1 (so that the end values are reached)\n\t\t\tsy = 1 / sy;\n\t\t} else { //in case the ease returns to its beginning value, scale everything proportionally\n\t\t\tsy = -sx;\n\t\t}\n\t\tsx *= rnd;\n\t\tsy *= rnd;\n\t\tfor (i = 0; i < l; i += 2) {\n\t\t\t_temp[i] = (((s[i] + tx) * sx) | 0) / rnd;\n\t\t\t_temp[i+1] = (((s[i+1] + ty) * sy) | 0) / rnd;\n\t\t}\n\n\t\tif (onEaseError) {\n\t\t\tpoints = [];\n\t\t\tl = _temp.length;\n\t\t\tfor (i = 2; i < l; i+=6) {\n\t\t\t\tx1 = _temp[i-2];\n\t\t\t\ty1 = _temp[i-1];\n\t\t\t\tx2 = _temp[i+4];\n\t\t\t\ty2 = _temp[i+5];\n\t\t\t\tpoints.push(x1, y1, x2, y2);\n\t\t\t\tbezierToPoints(x1, y1, _temp[i], _temp[i+1], _temp[i+2], _temp[i+3], x2, y2, 0.001, points, points.length - 2);\n\t\t\t}\n\t\t\tx1 = points[0];\n\t\t\tl = points.length;\n\t\t\tfor (i = 2; i < l; i+=2) {\n\t\t\t\tx2 = points[i];\n\t\t\t\tif (x2 < x1 || x2 > 1 || x2 < 0) {\n\t\t\t\t\tonEaseError();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tx1 = x2;\n\t\t\t}\n\t\t}\n\n\t\tif (shorten && l === 8 && _temp[0] === 0 && _temp[1] === 0 && _temp[l-2] === 1 && _temp[l-1] === 1) {\n\t\t\treturn _temp.slice(2, 6).join(\",\");\n\t\t}\n\t\t_temp[2] = \"C\" + _temp[2];\n\t\treturn \"M\" + _temp.join(\",\");\n\t}\n\n\tkill() {\n\t\tthis.enabled(false);\n\t\tthis._g.parentNode && this._g.parentNode.removeChild(this._g);\n\t}\n\n\trevert() {\n\t\tthis.kill();\n\t}\n\n}\n\n\n\n\n\nPathEditor.simplifyPoints = simplifyPoints;\nPathEditor.pointsToSegment = pointsToSegment;\nPathEditor.simplifySVG = (data, vars) => {  //takes a <path> element or data string and simplifies it according to whatever tolerance you set (default:1, the bigger the number the more variance there can be). vars: {tolerance:1, cornerThreshold:degrees, curved:true}\n\tlet element, points, i, x1, x2, y1, y2, bezier, precision, tolerance, l, cornerThreshold;\n\tvars = vars || {};\n\ttolerance = vars.tolerance || 1;\n\tprecision = vars.precision || (1 / tolerance);\n\tcornerThreshold = (vars.cornerThreshold === undefined ? 18 : +vars.cornerThreshold) * _DEG2RAD;\n\tif (typeof(data) !== \"string\") { //element\n\t\telement = data;\n\t\tdata = element.getAttribute(\"d\");\n\t}\n\tif (data.charAt(0) === \"#\" || data.charAt(0) === \".\") { //selector text\n\t\telement = _doc.querySelector(data);\n\t\tif (element) {\n\t\t\tdata = element.getAttribute(\"d\");\n\t\t}\n\t}\n\tpoints = (vars.curved === false && !/[achqstvz]/ig.test(data)) ? data.match(_numbersExp) : stringToRawPath(data)[0];\n\tif (vars.curved !== false) {\n\t\tbezier = points;\n\t\tpoints = [];\n\t\tl = bezier.length;\n\t\tfor (i = 2; i < l; i+=6) {\n\t\t\tx1 = +bezier[i-2];\n\t\t\ty1 = +bezier[i-1];\n\t\t\tx2 = +bezier[i+4];\n\t\t\ty2 = +bezier[i+5];\n\t\t\tpoints.push(_round(x1), _round(y1), _round(x2), _round(y2));\n\t\t\tbezierToPoints(x1, y1, +bezier[i], +bezier[i+1], +bezier[i+2], +bezier[i+3], x2, y2, 1 / (precision * 200000), points, points.length - 2);\n\t\t}\n\t\tpoints = pointsToSegment(simplifyPoints(points, tolerance), vars.curviness, cornerThreshold);\n\t\tpoints[2] = \"C\" + points[2];\n\t} else {\n\t\tpoints = simplifyPoints(points, tolerance);\n\t}\n\tdata = \"M\" + points.join(\",\");\n\tif (element) {\n\t\telement.setAttribute(\"d\", data);\n\t}\n\treturn data;\n};\n\nPathEditor.create = (target, vars) => new PathEditor(target, vars);\n\nPathEditor.editingAxis = _editingAxis;\n\nPathEditor.getSnapFunction = (vars) => { //{gridSize, radius, x, y, width, height}\n\tlet r = vars.radius || 2,\n\t\tbig = 1e20,\n\t\tminX = (vars.x || vars.x === 0) ? vars.x : vars.width ? 0 : -big,\n\t\tminY = (vars.y || vars.y === 0) ? vars.y : vars.height ? 0 : -big,\n\t\tmaxX = minX + (vars.width || big*big),\n\t\tmaxY = minY + (vars.height || big*big),\n\t\tcontainX = (vars.containX !== false),\n\t\tcontainY = (vars.containY !== false),\n\t\taxis = vars.axis,\n\t\tgrid = vars.gridSize;\n\tr *= r;\n\treturn p => {\n\t\tlet x = p.x,\n\t\t\ty = p.y,\n\t\t\tgridX, gridY, dx, dy;\n\t\tif ((containX && x < minX) || (dx = x - minX) * dx < r) {\n\t\t\tx = minX;\n\t\t} else if ((containX && x > maxX) || (dx = maxX - x) * dx < r) {\n\t\t\tx = maxX;\n\t\t}\n\t\tif ((containY && y < minY) || (dy = y - minY) * dy < r) {\n\t\t\ty = minY;\n\t\t} else if ((containY && y > maxY) || (dy = maxY - y) * dy < r) {\n\t\t\ty = maxY;\n\t\t}\n\t\tif (axis) {\n\t\t\tdx = x - axis.x;\n\t\t\tdy = y - axis.y;\n\t\t\tif (dx * dx < r) {\n\t\t\t\tx = axis.x;\n\t\t\t}\n\t\t\tif (dy * dy < r) {\n\t\t\t\ty = axis.y;\n\t\t\t}\n\t\t}\n\t\tif (grid) {\n\t\t\tgridX = minX + Math.round((x - minX) / grid) * grid; //closest grid slot on x-axis\n\t\t\tdx = gridX - x;\n\t\t\tgridY = minY + Math.round((y - minY) / grid) * grid; //closest grid slot on y-axis\n\t\t\tdy = gridY - y;\n\t\t\tif (dx * dx + dy * dy < r) {\n\t\t\t\tx = gridX;\n\t\t\t\ty = gridY;\n\t\t\t}\n\t\t}\n\t\tp.x = x;\n\t\tp.y = y;\n\t};\n};\n\nPathEditor.version = \"3.13.0\";\n\nPathEditor.register = _initCore;\n\nexport { PathEditor as default };"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,eAAe,EAAEC,eAAe,EAAEC,cAAc,EAAEC,cAAc,EAAEC,eAAe,EAAEC,gBAAgB,EAAEC,cAAc,EAAEC,WAAW,EAAEC,gBAAgB,QAAQ,YAAY;AAC/K,SAASC,eAAe,EAAEC,QAAQ,QAAQ,aAAa;AAEvD,IAAIC,WAAW,GAAG,yCAAyC;EAC1DC,IAAI;EAAEC,gBAAgB;EAAEC,IAAI;EAAEC,KAAK;EAAEC,IAAI;EAAEC,QAAQ;EACnDC,eAAe,GAAG,SAAS;EAC3BC,gBAAgB,GAAG,CAAC;EACpBC,QAAQ,GAAGC,IAAI,CAACC,EAAE,GAAG,GAAG;EACxBC,QAAQ,GAAGC,IAAI,CAACC,GAAG,KAAK,MAAM,IAAID,IAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,CAAC;EACnDC,gBAAgB,GAAG,CAAC;EACpBC,UAAU,GAAG,CAAC;EACdC,UAAU,GAAGA,CAAA,KAAM,KAAK;EACxBC,WAAW,GAAGA,CAAA,KAAMH,gBAAgB,GAAGJ,QAAQ,CAAC,CAAC;EACjDQ,KAAK;EAAEC,IAAI;EAAEC,MAAM;EAAEC,IAAI;EACzBC,oBAAoB;EACpBC,YAAY,GAAG,CAAC,CAAC;EAAE;EACnBC,QAAQ,GAAG,EAAE;EACbC,MAAM,GAAG,CAAC,CAAC;EAAE;EACbC,KAAK,GAAG,EAAE;EAAE;EACZC,MAAM,GAAG,GAAG;EACZC,cAAc,GAAG,EAAE;EACnBC,eAAe,GAAGC,KAAK,IAAI;IAC1B,IAAIA,KAAK,CAACC,cAAc,EAAE;MACzBD,KAAK,CAACC,cAAc,CAAC,CAAC;MACtB,IAAID,KAAK,CAACE,mBAAmB,EAAE;QAC9BF,KAAK,CAACE,mBAAmB,CAAC,CAAC,CAAC,CAAE;MAC/B;IACD;EACD,CAAC;EACDC,cAAc,GAAGC,IAAI,IAAInC,IAAI,CAACoC,eAAe,GAAGpC,IAAI,CAACoC,eAAe,CAAC,8BAA8B,EAAED,IAAI,CAAC,GAAGnC,IAAI,CAACqC,aAAa,CAACF,IAAI,CAAC;EACrIG,UAAU,GAAGA,CAACH,IAAI,EAAEI,SAAS,EAAEC,UAAU,KAAK;IAC7C,IAAIC,OAAO,GAAGzC,IAAI,CAACoC,eAAe,CAAC,4BAA4B,EAAED,IAAI,CAAC;MACrEO,GAAG,GAAG,iBAAiB;MACvBC,CAAC;IACFH,UAAU,GAAGA,UAAU,IAAI,CAAC,CAAC;IAC7BA,UAAU,CAACI,KAAK,GAAGJ,UAAU,CAACI,KAAK,IAAI,aAAa;IACpD,KAAKD,CAAC,IAAIH,UAAU,EAAE;MACrB,IAAIC,OAAO,CAACI,KAAK,CAACF,CAAC,CAAC,KAAKG,SAAS,EAAE;QACnCL,OAAO,CAACI,KAAK,CAACF,CAAC,CAAC,GAAGH,UAAU,CAACG,CAAC,CAAC;MACjC,CAAC,MAAM;QACNF,OAAO,CAACM,cAAc,CAAC,IAAI,EAAEJ,CAAC,CAACK,OAAO,CAACN,GAAG,EAAE,OAAO,CAAC,CAACO,WAAW,CAAC,CAAC,EAAET,UAAU,CAACG,CAAC,CAAC,CAAC;MACnF;IACD;IACAJ,SAAS,CAACW,WAAW,CAACT,OAAO,CAAC;IAC9B,OAAOA,OAAO;EACf,CAAC;EACDU,qBAAqB,GAAG;IAACC,MAAM,EAAC,IAAItD,QAAQ,CAAC;EAAC,CAAC;EAC/CuD,sBAAsB,GAAGC,MAAM,IAAI,CAAEA,MAAM,CAACC,SAAS,IAAID,MAAM,CAACC,SAAS,CAACC,OAAO,CAACC,WAAW,CAAC,CAAC,IAAKN,qBAAqB,EAAEC,MAAM;EACjIM,0BAA0B,GAAGJ,MAAM,IAAI;IACtC,IAAIK,CAAC,GAAGN,sBAAsB,CAACC,MAAM,CAAC;MACrCM,KAAK,GAAGN,MAAM,CAACO,eAAe;IAC/B,OAAO,CAACP,MAAM,GAAGA,MAAM,CAACQ,UAAU,KAAKR,MAAM,CAACO,eAAe,KAAKD,KAAK,EAAE;MACxED,CAAC,CAACI,QAAQ,CAACV,sBAAsB,CAACC,MAAM,CAAC,CAAC;IAC3C;IACA,OAAO,SAAS,GAAGK,CAAC,CAACK,CAAC,GAAG,GAAG,GAAGL,CAAC,CAACM,CAAC,GAAG,GAAG,GAAGN,CAAC,CAACO,CAAC,GAAG,GAAG,GAAGP,CAAC,CAACQ,CAAC,GAAG,GAAG,GAAGR,CAAC,CAACS,CAAC,GAAG,GAAG,GAAGT,CAAC,CAACU,CAAC,GAAG,GAAG;EACzF,CAAC;EACDC,WAAW,GAAGC,UAAU,IAAI;IAC3B,IAAIC,eAAe,GAAG,EAAE;MACvBR,CAAC,GAAGO,UAAU,CAACE,gBAAgB;MAC/BC,CAAC;IACF,KAAKA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGV,CAAC,CAACW,MAAM,EAAED,CAAC,EAAE,EAAE;MAC9BF,eAAe,CAACE,CAAC,CAAC,GAAGV,CAAC,CAACU,CAAC,CAAC,CAACA,CAAC;IAC5B;IACAjD,QAAQ,CAACmD,OAAO,CAAC;MAACC,IAAI,EAACN,UAAU;MAAEJ,CAAC,EAACI,UAAU,CAACM,IAAI,CAACC,YAAY,CAAC,GAAG,CAAC;MAAEvB,SAAS,EAACgB,UAAU,CAACM,IAAI,CAACC,YAAY,CAAC,WAAW,CAAC,IAAI,EAAE;MAAEN,eAAe,EAACA;IAAe,CAAC,CAAC;IACpK,IAAI/C,QAAQ,CAACkD,MAAM,GAAG,EAAE,EAAE;MACzBlD,QAAQ,CAACkD,MAAM,GAAG,EAAE;IACrB;EACD,CAAC;EACDI,MAAM,GAAGC,KAAK,IAAK,CAAC,EAAEA,KAAK,GAAG,IAAI,IAAIA,KAAK,GAAG,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,IAAI;EACnEC,kBAAkB,GAAGC,IAAI,IAAI;IAC5BA,IAAI,GAAGH,MAAM,CAACG,IAAI,CAAC;IACnB,OAAO,CAAC,IAAI,GAAGA,IAAI,EAAE,CAACA,IAAI,EAAEA,IAAI,EAAE,CAACA,IAAI,EAAEA,IAAI,EAAEA,IAAI,EAAE,CAACA,IAAI,EAAEA,IAAI,GAAG,GAAG,CAAC,CAACC,IAAI,CAACvD,MAAM,CAAC;EACrF,CAAC;EACDwD,kBAAkB,GAAGF,IAAI,IAAI;IAC5B,IAAIG,IAAI,GAAG,cAAc;MACxBC,KAAK,GAAGP,MAAM,CAACG,IAAI,GAAGG,IAAI,CAAC;IAC5BH,IAAI,GAAGH,MAAM,CAACG,IAAI,CAAC;IACnB,OAAO,GAAG,GAAGA,IAAI,GAAG,KAAK,GAAG,CAACA,IAAI,EAAEI,KAAK,EAAEA,KAAK,EAAEJ,IAAI,EAAE,CAAC,EAAEA,IAAI,EAAG,CAACI,KAAK,EAAEJ,IAAI,EAAE,CAACA,IAAI,EAAEI,KAAK,EAAE,CAACJ,IAAI,EAAE,CAAC,EAAE,CAACA,IAAI,EAAE,CAACI,KAAK,EAAE,CAACA,KAAK,EAAE,CAACJ,IAAI,EAAE,CAAC,EAAE,CAACA,IAAI,EAAEI,KAAK,EAAE,CAACJ,IAAI,EAAEA,IAAI,EAAE,CAACI,KAAK,EAAEJ,IAAI,EAAE,CAAC,CAAC,CAACC,IAAI,CAACvD,MAAM,CAAC,GAAG,GAAG;EACvM,CAAC;EACD2D,cAAc,GAAG,SAAAA,CAASnB,CAAC,EAAE;IAC5B,IAAI,CAACA,CAAC,CAACd,MAAM,CAACkC,YAAY,IAAI,CAACxE,UAAU,IAAIL,QAAQ,CAAC,CAAC,GAAGI,gBAAgB,GAAG,GAAG,EAAE;MACjF,IAAI2D,CAAC,GAAG7C,cAAc,CAAC8C,MAAM;MAC7B,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;QAChB7C,cAAc,CAAC6C,CAAC,CAAC,CAACe,QAAQ,CAAC,CAAC;MAC7B;MACA5D,cAAc,CAAC8C,MAAM,GAAG,CAAC;IAC1B;EACD,CAAC;EACDe,QAAQ;EAAEC,iBAAiB;EAC3BC,gBAAgB,GAAG,CAAC;EACpBC,YAAY,GAAGA,CAACpD,OAAO,EAAEN,IAAI,EAAE2D,IAAI,EAAEC,OAAO,KAAK;IAChD,IAAItD,OAAO,CAACuD,gBAAgB,EAAE;MAC7B,IAAIC,SAAS,GAAGN,iBAAiB,CAACxD,IAAI,CAAC;MACvC4D,OAAO,GAAGA,OAAO,IAAI;QAACG,OAAO,EAAC;MAAK,CAAC;MACpCzD,OAAO,CAACuD,gBAAgB,CAACC,SAAS,IAAI9D,IAAI,EAAE2D,IAAI,EAAEC,OAAO,CAAC;MAC1D,IAAIE,SAAS,IAAI9D,IAAI,KAAK8D,SAAS,IAAIA,SAAS,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,SAAS,EAAE;QAAE;QAC9E1D,OAAO,CAACuD,gBAAgB,CAAC7D,IAAI,EAAE2D,IAAI,EAAEC,OAAO,CAAC;MAC9C;IACD,CAAC,MAAM,IAAItD,OAAO,CAAC2D,WAAW,EAAE;MAC/B3D,OAAO,CAAC2D,WAAW,CAAC,IAAI,GAAGjE,IAAI,EAAE2D,IAAI,CAAC;IACvC;EACD,CAAC;EACDO,eAAe,GAAGA,CAAC5D,OAAO,EAAEN,IAAI,EAAE2D,IAAI,KAAK;IAC1C,IAAIrD,OAAO,CAAC6D,mBAAmB,EAAE;MAChC,IAAIL,SAAS,GAAGN,iBAAiB,CAACxD,IAAI,CAAC;MACvCM,OAAO,CAAC6D,mBAAmB,CAACL,SAAS,IAAI9D,IAAI,EAAE2D,IAAI,CAAC;MACpD,IAAIG,SAAS,IAAI9D,IAAI,KAAK8D,SAAS,IAAIA,SAAS,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,SAAS,EAAE;QAC5E1D,OAAO,CAAC6D,mBAAmB,CAACnE,IAAI,EAAE2D,IAAI,CAAC;MACxC;IACD,CAAC,MAAM,IAAIrD,OAAO,CAAC8D,WAAW,EAAE;MAC/B9D,OAAO,CAAC8D,WAAW,CAAC,IAAI,GAAGpE,IAAI,EAAE2D,IAAI,CAAC;IACvC;EACD,CAAC;EACDU,WAAW,GAAGA,CAACC,IAAI,EAAEC,EAAE,KAAK;IAC3B,IAAIhC,CAAC,GAAG+B,IAAI,CAAC9B,MAAM;IACnB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;MAChB,IAAI+B,IAAI,CAAC/B,CAAC,CAAC,CAACiC,UAAU,KAAKD,EAAE,EAAE;QAC9B,OAAO,IAAI;MACZ;IACD;IACA,OAAO,KAAK;EACb,CAAC;EACDE,wBAAwB,GAAGxC,CAAC,IAAI;IAC/BwB,gBAAgB,GAAIxB,CAAC,CAACyC,OAAO,IAAIC,UAAU,GAAG1C,CAAC,CAACyC,OAAO,CAAClC,MAAO;IAC/D0B,eAAe,CAACjC,CAAC,CAACd,MAAM,EAAE,UAAU,EAAEsD,wBAAwB,CAAC;EAChE,CAAC;EACDG,qBAAqB,GAAG3C,CAAC,IAAI;IAC5BwB,gBAAgB,GAAIxB,CAAC,CAACyC,OAAO,IAAIC,UAAU,GAAG1C,CAAC,CAACyC,OAAO,CAAClC,MAAO;IAC/DkB,YAAY,CAACzB,CAAC,CAACd,MAAM,EAAE,UAAU,EAAEsD,wBAAwB,CAAC;EAC7D,CAAC;EACDI,KAAK,GAAGA,CAAClB,IAAI,EAAEmB,KAAK,KAAK7C,CAAC,IAAI0B,IAAI,CAACoB,IAAI,CAACD,KAAK,EAAE7C,CAAC,CAAC;EACjD+C,SAAS,GAAGA,CAAChF,IAAI,EAAEiF,IAAI,EAAEC,KAAK,KAAK;IAClC,IAAIC,QAAQ,GAAGF,IAAI,CAACG,IAAI,CAACpF,IAAI,CAAC;IAC9B,IAAImF,QAAQ,EAAE;MACbA,QAAQ,CAACJ,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEC,KAAK,IAAID,IAAI,CAAC;IAC9D;IACA,OAAOA,IAAI;EACZ,CAAC;EACDK,YAAY;EACZC,eAAe,GAAGA,CAAA,KAAM;IACvBD,YAAY,CAAC5E,KAAK,CAAC8E,OAAO,GAAG,OAAO;IACpCF,YAAY,CAACG,MAAM,CAAC,CAAC;IACrBH,YAAY,CAAC5E,KAAK,CAAC8E,OAAO,GAAG,MAAM;EACpC,CAAC;EACDE,YAAY;EACZC,SAAS,GAAIC,IAAI,IAAK;IACrB/H,IAAI,GAAGgI,QAAQ;IACf9H,IAAI,GAAG+H,MAAM;IACb9H,KAAK,GAAGH,IAAI,CAACkI,IAAI;IACjB9H,IAAI,GAAGA,IAAI,IAAI2H,IAAI,IAAI7H,IAAI,CAACE,IAAI,IAAI+H,OAAO,CAACC,IAAI,CAAC,wCAAwC,CAAC;IAC1F/H,QAAQ,GAAID,IAAI,IAAIA,IAAI,CAAC2H,IAAI,CAACM,OAAO,IAAK,YAAW,CAAC,CAAC;IACvD3C,QAAQ,GAAGxD,cAAc,CAAC,KAAK,CAAC;IAChCuF,YAAY,GAAGvF,cAAc,CAAC,UAAU,CAAC;IACzCuF,YAAY,CAAC5E,KAAK,CAAC8E,OAAO,GAAG,MAAM;IACnCxH,KAAK,IAAIA,KAAK,CAAC+C,WAAW,CAACuE,YAAY,CAAC;IACxC9B,iBAAiB,GAAI,UAAS2C,KAAK,EAAE;MAAE;MACtC,IAAIC,QAAQ,GAAGD,KAAK,CAACE,KAAK,CAAC,GAAG,CAAC;QAC9BC,SAAS,GAAG,CAAE/C,QAAQ,CAACgD,aAAa,KAAK5F,SAAS,GAAI,iDAAiD,GAAI4C,QAAQ,CAACiD,eAAe,KAAK7F,SAAS,GAAI,yDAAyD,GAAGwF,KAAK,EAAEE,KAAK,CAAC,GAAG,CAAC;QAClOI,GAAG,GAAG,CAAC,CAAC;QACRlE,CAAC,GAAG,CAAC;MACN,OAAO,EAAEA,CAAC,GAAG,CAAC,CAAC,EAAE;QAChBkE,GAAG,CAACL,QAAQ,CAAC7D,CAAC,CAAC,CAAC,GAAG+D,SAAS,CAAC/D,CAAC,CAAC;QAC/BkE,GAAG,CAACH,SAAS,CAAC/D,CAAC,CAAC,CAAC,GAAG6D,QAAQ,CAAC7D,CAAC,CAAC;MAChC;MACA,OAAOkE,GAAG;IACX,CAAC,CAAC,2CAA2C,CAAE;IAC/CC,UAAU,CAACC,SAAS,CAACC,qBAAqB,GAAGF,UAAU,CAACC,SAAS,CAACC,qBAAqB,IAAI,UAAS3E,CAAC,EAAE;MAAE;MACxG,OAAOA,CAAC,CAAC4E,YAAY,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAClF,QAAQ,CAAC,IAAI,CAACiF,YAAY,CAAC,CAAC,CAAC;IAChE,CAAC;IACDhJ,IAAI,CAACgG,gBAAgB,CAAC,SAAS,EAAE,UAAS5B,CAAC,EAAE;MAC5C,IAAI8E,GAAG,GAAG9E,CAAC,CAAC+E,OAAO,IAAI/E,CAAC,CAACgF,KAAK;QAC7BC,SAAS,GAAGjF,CAAC,CAAC8E,GAAG,IAAIA,GAAG;QACxBxE,CAAC;QAAE4E,KAAK;QAAEtF,CAAC;QAAEa,IAAI;MAClB,IAAIwE,SAAS,KAAK,OAAO,IAAIH,GAAG,KAAK,EAAE,EAAE;QACxC7H,MAAM,GAAG,IAAI;MACd,CAAC,MAAM,IAAIgI,SAAS,KAAK,SAAS,IAAIH,GAAG,KAAK,EAAE,EAAE;QACjD/H,KAAK,GAAG,IAAI;MACb,CAAC,MAAM,IAAIkI,SAAS,KAAK,MAAM,IAAIH,GAAG,KAAK,EAAE,EAAE;QAC9C5H,IAAI,GAAG,IAAI;MACZ,CAAC,MAAM,IAAI+H,SAAS,KAAK,KAAK,IAAIH,GAAG,KAAK,EAAE,EAAE;QAC7C9H,IAAI,GAAG,IAAI;QACXsD,CAAC,GAAG7C,cAAc,CAAC8C,MAAM;QACzB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;UAChB7C,cAAc,CAAC6C,CAAC,CAAC,CAAC6E,WAAW,CAAC,CAAC;QAChC;MACD,CAAC,MAAM,IAAI,CAACF,SAAS,KAAK,GAAG,IAAIH,GAAG,KAAK,EAAE,MAAM/H,KAAK,IAAIG,IAAI,CAAC,IAAIG,QAAQ,CAACkD,MAAM,GAAG,CAAC,EAAE;QAAE;QACzFlD,QAAQ,CAAC+H,KAAK,CAAC,CAAC;QAChBF,KAAK,GAAG7H,QAAQ,CAAC,CAAC,CAAC;QACnB,IAAI6H,KAAK,EAAE;UACVzE,IAAI,GAAGyE,KAAK,CAACzE,IAAI;UACjBA,IAAI,CAACA,IAAI,CAAC4E,YAAY,CAAC,GAAG,EAAEH,KAAK,CAACnF,CAAC,CAAC;UACpCU,IAAI,CAACA,IAAI,CAAC4E,YAAY,CAAC,WAAW,EAAEH,KAAK,CAAC/F,SAAS,CAAC;UACpDsB,IAAI,CAAC6E,IAAI,CAAC,CAAC;UACX1F,CAAC,GAAGa,IAAI,CAAC8E,QAAQ;UACjB,KAAKjF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGV,CAAC,CAACW,MAAM,EAAED,CAAC,EAAE,EAAE;YAC9B,IAAI4E,KAAK,CAAC9E,eAAe,CAACoF,OAAO,CAAC5F,CAAC,CAACU,CAAC,CAAC,CAACA,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;cACjDG,IAAI,CAACJ,gBAAgB,CAACoF,IAAI,CAAC7F,CAAC,CAACU,CAAC,CAAC,CAAC;YACjC;UACD;UACAG,IAAI,CAACiF,cAAc,CAAC,CAAC;UACrBjF,IAAI,CAACkF,MAAM,CAAC,CAAC;UACb,IAAIlF,IAAI,CAAC0C,IAAI,CAACyC,MAAM,EAAE;YACrBnF,IAAI,CAAC0C,IAAI,CAACyC,MAAM,CAAC9C,IAAI,CAACrC,IAAI,CAAC;UAC5B;QACD;MACD,CAAC,MAAM,IAAIwE,SAAS,KAAK,QAAQ,IAAIA,SAAS,KAAK,WAAW,IAAIH,GAAG,KAAK,CAAC,IAAIA,GAAG,KAAK,EAAE,IAAIA,GAAG,KAAK,KAAK,IAAKA,GAAG,KAAK,GAAG,KAAK/H,KAAK,IAAIG,IAAI,CAAE,EAAE;QAAE;QACjJoD,CAAC,GAAG7C,cAAc,CAAC8C,MAAM;QACzB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;UAChB7C,cAAc,CAAC6C,CAAC,CAAC,CAACuF,sBAAsB,CAAC,CAAC;QAC3C;MACD,CAAC,MAAM,IAAI,CAACZ,SAAS,KAAK,GAAG,IAAIH,GAAG,KAAK,EAAE,MAAM5H,IAAI,IAAIH,KAAK,CAAC,EAAE;QAAE;QAClEuD,CAAC,GAAG7C,cAAc,CAAC8C,MAAM;QACzB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;UAChB7C,cAAc,CAAC6C,CAAC,CAAC,CAACkD,MAAM,CAAC,IAAI,CAAC;QAC/B;MACD;IACD,CAAC,EAAE,IAAI,CAAC;IACR5H,IAAI,CAACgG,gBAAgB,CAAC,OAAO,EAAE,UAAS5B,CAAC,EAAE;MAC1C,IAAI8E,GAAG,GAAG9E,CAAC,CAAC8E,GAAG,IAAI9E,CAAC,CAAC+E,OAAO,IAAI/E,CAAC,CAACgF,KAAK;MACvC,IAAIF,GAAG,KAAK,OAAO,IAAIA,GAAG,KAAK,EAAE,EAAE;QAClC7H,MAAM,GAAG,KAAK;MACf,CAAC,MAAM,IAAI6H,GAAG,KAAK,SAAS,IAAIA,GAAG,KAAK,EAAE,EAAE;QAC3C/H,KAAK,GAAG,KAAK;MACd,CAAC,MAAM,IAAI+H,GAAG,KAAK,MAAM,IAAIA,GAAG,KAAK,EAAE,EAAE;QACxC5H,IAAI,GAAG,KAAK;MACb,CAAC,MAAM,IAAI4H,GAAG,KAAK,KAAK,IAAIA,GAAG,KAAK,EAAE,EAAE;QACvC9H,IAAI,GAAG,KAAK;QACZ,IAAIsD,CAAC,GAAG7C,cAAc,CAAC8C,MAAM;QAC7B,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;UAChB7C,cAAc,CAAC6C,CAAC,CAAC,CAACwF,aAAa,CAAC,CAAC;QAClC;MACD;IACD,CAAC,EAAE,IAAI,CAAC;IACRjK,gBAAgB,GAAG,CAAC,CAACC,IAAI,CAACiK,YAAY;IACtCtE,YAAY,CAAC7F,IAAI,EAAE,SAAS,EAAEuF,cAAc,CAAC;IAC7CM,YAAY,CAAC7F,IAAI,EAAE,UAAU,EAAEuF,cAAc,CAAC;IAC9CM,YAAY,CAAC7F,IAAI,EAAE,aAAa,EAAEiB,UAAU,CAAC,CAAC,CAAC;IAC/C4E,YAAY,CAAC3F,IAAI,EAAE,WAAW,EAAEe,UAAU,CAAC,CAAC,CAAC;IAC7Cd,KAAK,IAAIA,KAAK,CAAC6F,gBAAgB,CAAC,YAAY,EAAE/E,UAAU,CAAC,CAAC,CAAC;IAC3D4G,YAAY,GAAG,CAAC;EACjB,CAAC;EACDuC,QAAQ,GAAG,SAAAA,CAAShG,CAAC,EAAE;IACtB,IAAIgD,IAAI,GAAG,IAAI;MACdiD,GAAG,GAAGxK,eAAe,CAACuH,IAAI,CAAC9D,MAAM,CAACQ,UAAU,EAAE,IAAI,CAAC;MAAE;MACrDwG,gBAAgB;MAAEC,IAAI;IACvB,IAAI,CAACC,OAAO,GAAG,IAAI,CAAClH,MAAM,CAACC,SAAS,CAACC,OAAO,CAACiH,OAAO,CAAC,CAAC,CAAC,CAACrH,MAAM;IAC9D,IAAI,CAACsH,IAAI,GAAGL,GAAG;IACf,IAAI1E,iBAAiB,CAACvB,CAAC,CAACjC,IAAI,CAAC,EAAE;MAAE;MAChCmI,gBAAgB,GAAIlG,CAAC,CAACjC,IAAI,CAACyH,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAKxF,CAAC,CAACuG,aAAa,IAAIvG,CAAC,CAACd,MAAM,GAAItD,IAAI,CAAC,CAAC;MAC5F6F,YAAY,CAACyE,gBAAgB,EAAE,UAAU,EAAElD,IAAI,CAACwD,UAAU,CAAC;MAC3D/E,YAAY,CAACyE,gBAAgB,EAAE,WAAW,EAAElD,IAAI,CAACyD,OAAO,CAAC;MACzDhF,YAAY,CAACyE,gBAAgB,EAAE,aAAa,EAAElD,IAAI,CAACwD,UAAU,CAAC;MAC9D/E,YAAY,CAAC7F,IAAI,EAAE,YAAY,EAAE+G,qBAAqB,CAAC;MACvDlB,YAAY,CAAC3F,IAAI,EAAE,kBAAkB,EAAE4B,eAAe,CAAC,CAAC,CAAC;IAC1D,CAAC,MAAM;MACNwI,gBAAgB,GAAG,IAAI;MACvBzE,YAAY,CAAC7F,IAAI,EAAE,WAAW,EAAEoH,IAAI,CAACyD,OAAO,CAAC,CAAC,CAAC;IAChD;IACA,IAAI,CAAC5K,gBAAgB,EAAE;MACtB4F,YAAY,CAAC7F,IAAI,EAAE,SAAS,EAAEoH,IAAI,CAACwD,UAAU,CAAC;IAC/C;IACA9I,eAAe,CAACsC,CAAC,CAAC;IAClBsD,eAAe,CAAC,CAAC,CAAC,CAAC;IACnB,IAAItD,CAAC,CAAC0G,cAAc,EAAE;MAAE;MACvB1G,CAAC,GAAGgD,IAAI,CAAC2D,KAAK,GAAG3G,CAAC,CAAC0G,cAAc,CAAC,CAAC,CAAC;MACpC1D,IAAI,CAAC4D,OAAO,GAAG5G,CAAC,CAACuC,UAAU;IAC5B,CAAC,MAAM,IAAIvC,CAAC,CAAC6G,SAAS,EAAE;MACvB7D,IAAI,CAAC4D,OAAO,GAAG5G,CAAC,CAAC6G,SAAS,CAAC,CAAC;IAC7B,CAAC,MAAM;MACN7D,IAAI,CAAC2D,KAAK,GAAG3D,IAAI,CAAC4D,OAAO,GAAG,IAAI;IACjC;IACA5D,IAAI,CAAC8D,cAAc,GAAG9D,IAAI,CAAC+D,QAAQ,GAAG/G,CAAC,CAACgH,KAAK,CAAC,CAAC;IAC/ChE,IAAI,CAACiE,cAAc,GAAGjE,IAAI,CAACkE,QAAQ,GAAGlH,CAAC,CAACmH,KAAK;IAC7CnE,IAAI,CAACoE,cAAc,GAAGpE,IAAI,CAACoD,OAAO,CAACpG,CAAC;IACpCgD,IAAI,CAACqE,cAAc,GAAGrE,IAAI,CAACoD,OAAO,CAACnG,CAAC;IAEpC,IAAI,IAAI,CAACqG,IAAI,CAAC1G,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC0G,IAAI,CAACzG,CAAC,KAAK,CAAC,IAAI,IAAI,CAACyG,IAAI,CAACxG,CAAC,KAAK,CAAC,IAAI,IAAI,CAACwG,IAAI,CAACvG,CAAC,KAAK,CAAC,EAAE;MACrF,IAAI,CAACuG,IAAI,GAAG,IAAI;IACjB,CAAC,MAAM;MACNH,IAAI,GAAGnD,IAAI,CAACiE,cAAc,GAAG,IAAI,CAACX,IAAI,CAAC1G,CAAC,GAAGoD,IAAI,CAAC8D,cAAc,GAAG,IAAI,CAACR,IAAI,CAACxG,CAAC,GAAG,IAAI,CAACwG,IAAI,CAACtG,CAAC;MAC1FgD,IAAI,CAAC8D,cAAc,GAAG9D,IAAI,CAACiE,cAAc,GAAG,IAAI,CAACX,IAAI,CAACzG,CAAC,GAAGmD,IAAI,CAAC8D,cAAc,GAAG,IAAI,CAACR,IAAI,CAACvG,CAAC,GAAG,IAAI,CAACuG,IAAI,CAACrG,CAAC;MACzG+C,IAAI,CAACiE,cAAc,GAAGd,IAAI;IAC3B;IAEAnD,IAAI,CAACsE,SAAS,GAAG1K,UAAU,GAAG,IAAI;IAClCoG,IAAI,CAACkD,gBAAgB,GAAGA,gBAAgB;IACxC,IAAIlD,IAAI,CAACG,IAAI,CAACoE,OAAO,EAAE;MACtBvE,IAAI,CAACG,IAAI,CAACoE,OAAO,CAACzE,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEA,IAAI,CAACwE,YAAY,CAAC;IAC3E;EACD,CAAC;EACDf,OAAO,GAAG,SAAAA,CAASzG,CAAC,EAAE;IACrB,IAAIgD,IAAI,GAAG,IAAI;MACdyE,aAAa,GAAGzH,CAAC;MACjByC,OAAO;MAAEnC,CAAC;IACX,IAAI,CAAC0C,IAAI,CAAC0E,QAAQ,IAAIlG,gBAAgB,IAAI,CAACwB,IAAI,CAACsE,SAAS,IAAI,CAACtH,CAAC,EAAE;MAChE;IACD;IACAgD,IAAI,CAACwE,YAAY,GAAGxH,CAAC;IACrByC,OAAO,GAAGzC,CAAC,CAAC0G,cAAc;IAC1B,IAAIjE,OAAO,EAAE;MAAE;MACdzC,CAAC,GAAGyC,OAAO,CAAC,CAAC,CAAC;MACd,IAAIzC,CAAC,KAAKgD,IAAI,CAAC2D,KAAK,IAAI3G,CAAC,CAACuC,UAAU,KAAKS,IAAI,CAAC4D,OAAO,EAAE;QAAE;QACxDtG,CAAC,GAAGmC,OAAO,CAAClC,MAAM;QAClB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,IAAI,CAACN,CAAC,GAAGyC,OAAO,CAACnC,CAAC,CAAC,EAAEiC,UAAU,KAAKS,IAAI,CAAC4D,OAAO,EAAE,CAAC;QAClE,IAAItG,CAAC,GAAG,CAAC,EAAE;UACV;QACD;MACD;IACD,CAAC,MAAM,IAAIN,CAAC,CAAC6G,SAAS,IAAI7D,IAAI,CAAC4D,OAAO,IAAI5G,CAAC,CAAC6G,SAAS,KAAK7D,IAAI,CAAC4D,OAAO,EAAE;MAAE;MACzE;IACD;IACAlJ,eAAe,CAAC+J,aAAa,CAAC;IAC9BzE,IAAI,CAAC2E,kBAAkB,CAAC3H,CAAC,CAACmH,KAAK,EAAEnH,CAAC,CAACgH,KAAK,CAAC;IACzC,IAAIhE,IAAI,CAACG,IAAI,CAACyE,MAAM,EAAE;MACrB5E,IAAI,CAACG,IAAI,CAACyE,MAAM,CAAC9E,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEA,IAAI,CAACwE,YAAY,CAAC;IAC1E;EACD,CAAC;EACDhB,UAAU,GAAG,SAAAA,CAASxG,CAAC,EAAE6H,KAAK,EAAE;IAC/B,IAAI7E,IAAI,GAAG,IAAI;IACf,IAAI,CAACA,IAAI,CAAC0E,QAAQ,IAAI,CAAC1E,IAAI,CAACsE,SAAS,IAAKtH,CAAC,IAAIgD,IAAI,CAAC4D,OAAO,IAAI,IAAI,IAAI,CAACiB,KAAK,KAAM7H,CAAC,CAAC6G,SAAS,IAAI7G,CAAC,CAAC6G,SAAS,KAAK7D,IAAI,CAAC4D,OAAO,IAAM5G,CAAC,CAAC0G,cAAc,IAAI,CAACtE,WAAW,CAACpC,CAAC,CAAC0G,cAAc,EAAE1D,IAAI,CAAC4D,OAAO,CAAE,CAAE,EAAE;MAAG;MAC3M;IACD;IACA9J,WAAW,CAAC,CAAC;IACbkG,IAAI,CAACsE,SAAS,GAAG1K,UAAU,GAAG,KAAK,CAAC,CAAC;IACrC,IAAI6K,aAAa,GAAGzH,CAAC;MACpB8H,WAAW,GAAG9E,IAAI,CAAC+E,UAAU;MAC7B7B,gBAAgB,GAAGlD,IAAI,CAACkD,gBAAgB;MACxCzD,OAAO;MAAEnC,CAAC;IACX,IAAI4F,gBAAgB,EAAE;MACrBjE,eAAe,CAACiE,gBAAgB,EAAE,UAAU,EAAElD,IAAI,CAACwD,UAAU,CAAC;MAC9DvE,eAAe,CAACiE,gBAAgB,EAAE,WAAW,EAAElD,IAAI,CAACyD,OAAO,CAAC;MAC5DxE,eAAe,CAACiE,gBAAgB,EAAE,aAAa,EAAElD,IAAI,CAACwD,UAAU,CAAC;MACjEvE,eAAe,CAACrG,IAAI,EAAE,YAAY,EAAE+G,qBAAqB,CAAC;IAC3D,CAAC,MAAM;MACNV,eAAe,CAACrG,IAAI,EAAE,WAAW,EAAEoH,IAAI,CAACyD,OAAO,CAAC;IACjD;IACA,IAAI,CAAC5K,gBAAgB,EAAE;MACtBoG,eAAe,CAACrG,IAAI,EAAE,SAAS,EAAEoH,IAAI,CAACwD,UAAU,CAAC;MACjD,IAAIxG,CAAC,IAAIA,CAAC,CAACd,MAAM,EAAE;QAClB+C,eAAe,CAACjC,CAAC,CAACd,MAAM,EAAE,SAAS,EAAE8D,IAAI,CAACwD,UAAU,CAAC;MACtD;IACD;IACA,IAAIsB,WAAW,EAAE;MAChB9E,IAAI,CAAC+E,UAAU,GAAG,KAAK;IACxB,CAAC,MAAM,IAAI/E,IAAI,CAACG,IAAI,CAAC6E,OAAO,EAAE;MAC7BhF,IAAI,CAACG,IAAI,CAAC6E,OAAO,CAAClF,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEyE,aAAa,CAAC;IACvE;IACA,IAAIzH,CAAC,EAAE;MACNyC,OAAO,GAAGzC,CAAC,CAAC0G,cAAc;MAC1B,IAAIjE,OAAO,EAAE;QAAE;QACdzC,CAAC,GAAGyC,OAAO,CAAC,CAAC,CAAC;QACd,IAAIzC,CAAC,KAAKgD,IAAI,CAAC2D,KAAK,IAAI3G,CAAC,CAACuC,UAAU,KAAKS,IAAI,CAAC4D,OAAO,EAAE;UAAE;UACxDtG,CAAC,GAAGmC,OAAO,CAAClC,MAAM;UAClB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,IAAI,CAACN,CAAC,GAAGyC,OAAO,CAACnC,CAAC,CAAC,EAAEiC,UAAU,KAAKS,IAAI,CAAC4D,OAAO,EAAE,CAAC;UAClE,IAAItG,CAAC,GAAG,CAAC,EAAE;YACV;UACD;QACD;MACD;MACA0C,IAAI,CAACwE,YAAY,GAAGC,aAAa;MACjCzE,IAAI,CAACkE,QAAQ,GAAGlH,CAAC,CAACmH,KAAK;MACvBnE,IAAI,CAAC+D,QAAQ,GAAG/G,CAAC,CAACgH,KAAK;IACxB;IACA,IAAIS,aAAa,IAAI,CAACK,WAAW,IAAI9E,IAAI,CAACG,IAAI,CAAC8E,aAAa,EAAE;MAC7DjF,IAAI,CAACG,IAAI,CAAC8E,aAAa,CAACnF,IAAI,CAACE,IAAI,EAAEA,IAAI,CAACwE,YAAY,CAAC;IAEtD,CAAC,MAAM;MACN,IAAIC,aAAa,EAAE;QAClB/J,eAAe,CAAC+J,aAAa,CAAC;MAC/B;MACA,IAAIzE,IAAI,CAACG,IAAI,CAAC+E,SAAS,EAAE;QACxBlF,IAAI,CAACG,IAAI,CAAC+E,SAAS,CAACpF,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEA,IAAI,CAACwE,YAAY,CAAC;MAC7E;IACD;IACA,IAAIM,WAAW,IAAI9E,IAAI,CAACG,IAAI,CAACgF,SAAS,EAAE;MACvCnF,IAAI,CAACG,IAAI,CAACgF,SAAS,CAACrF,IAAI,CAACE,IAAI,CAACG,IAAI,CAACC,aAAa,IAAIJ,IAAI,EAAEA,IAAI,CAACwE,YAAY,CAAC;IAC7E;IACA,OAAO,IAAI;EACZ,CAAC;EACDY,qBAAqB,GAAGA,CAACC,OAAO,EAAEC,CAAC,EAAEC,MAAM,EAAEpF,IAAI,KAAK;IACrD,IAAIqF,OAAO,GAAGH,OAAO,CAACC,CAAC,CAAC;MACvBG,CAAC,GAAGD,OAAO,CAACjI,MAAM,IAAIiI,OAAO,CAACE,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC;MAC7C9I,CAAC,GAAG,EAAE;MACNU,CAAC;IACF,KAAKA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,IAAE,CAAC,EAAE;MACxBV,CAAC,CAAC6F,IAAI,CAAC,IAAIkD,MAAM,CAACJ,MAAM,EAAEF,OAAO,EAAEC,CAAC,EAAEhI,CAAC,EAAE6C,IAAI,CAAC,CAAC;IAChD;IACAqF,OAAO,CAACE,MAAM,KAAK9I,CAAC,CAAC,CAAC,CAAC,CAACgJ,aAAa,GAAG,IAAI,CAAC;IAC7C,OAAOhJ,CAAC;EACT,CAAC;EACDiJ,UAAU,GAAGA,CAACL,OAAO,EAAElI,CAAC,EAAEwI,EAAE,KAAK;IAAE;IAClC,IAAIC,CAAC,GAAGP,OAAO,CAACM,EAAE,CAAC,GAAGN,OAAO,CAAClI,CAAC,CAAC;MAC/B0I,CAAC,GAAGR,OAAO,CAACM,EAAE,GAAC,CAAC,CAAC,GAAGN,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;IACjC,OAAOjE,IAAI,CAAC4M,IAAI,CAACF,CAAC,GAAGA,CAAC,GAAGC,CAAC,GAAGA,CAAC,CAAC;EAChC,CAAC;AAGF,MAAME,YAAY,CAAC;EAElBC,WAAWA,CAACjK,MAAM,EAAEiE,IAAI,EAAE;IACzB,IAAI,CAACjE,MAAM,GAAI,OAAOA,MAAO,KAAK,QAAQ,GAAItD,IAAI,CAACwN,gBAAgB,CAAClK,MAAM,CAAC,CAAC,CAAC,CAAC,GAAGA,MAAM;IACvF,IAAI,CAACiE,IAAI,GAAGA,IAAI,IAAI,CAAC,CAAC;IACtB,IAAI,CAAC6C,QAAQ,GAAGpD,KAAK,CAACoD,QAAQ,EAAE,IAAI,CAAC;IACrC,IAAI,CAACS,OAAO,GAAG7D,KAAK,CAAC6D,OAAO,EAAE,IAAI,CAAC;IACnC,IAAI,CAACD,UAAU,GAAG5D,KAAK,CAAC4D,UAAU,EAAE,IAAI,CAAC;IACzC,IAAI,CAACtH,MAAM,CAACmG,YAAY,CAAC,WAAW,EAAE,CAAC,IAAI,CAACnG,MAAM,CAACwB,YAAY,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,iBAAiB,CAAC;IACxG,IAAI,CAAC0F,OAAO,GAAGnH,sBAAsB,CAAC,IAAI,CAACC,MAAM,CAAC;IAClD,IAAI,CAAC6J,CAAC,GAAG,IAAI,CAAC3C,OAAO,CAACpG,CAAC;IACvB,IAAI,CAACgJ,CAAC,GAAG,IAAI,CAAC5C,OAAO,CAACnG,CAAC;IACvB,IAAI,CAACoJ,IAAI,GAAGlG,IAAI,CAACkG,IAAI;IACrB,IAAI,CAACC,KAAK,CAACnG,IAAI,CAACoG,IAAI,CAAC,IAAI,CAACD,KAAK,CAACnG,IAAI,CAACqG,IAAI,CAAC,EAAE;MAC3C,IAAI,CAACC,OAAO,GAAG,CAAC;MAChB,IAAI,CAACF,IAAI,GAAG,CAACpG,IAAI,CAACoG,IAAI;MACtB,IAAI,CAACC,IAAI,GAAG,CAACrG,IAAI,CAACqG,IAAI;IACvB,CAAC,MAAM;MACN,IAAI,CAACC,OAAO,GAAG,CAAC;IACjB;IACA,IAAI,CAACC,OAAO,CAAC,IAAI,CAAC;EACnB;EAEA/B,kBAAkBA,CAACT,QAAQ,EAAEH,QAAQ,EAAE;IACtC,IAAI4C,GAAG,GAAG,IAAI;MACbC,OAAO;MAAEC,OAAO;MAAEd,CAAC;MAAEC,CAAC;MAAE7C,IAAI;IAC7B,IAAI,CAACe,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACH,QAAQ,GAAGA,QAAQ;IACxB,IAAI,IAAI,CAACT,IAAI,EAAE;MACdH,IAAI,GAAGe,QAAQ,GAAG,IAAI,CAACZ,IAAI,CAAC1G,CAAC,GAAGmH,QAAQ,GAAG,IAAI,CAACT,IAAI,CAACxG,CAAC,GAAG,IAAI,CAACwG,IAAI,CAACtG,CAAC;MACpE+G,QAAQ,GAAGG,QAAQ,GAAG,IAAI,CAACZ,IAAI,CAACzG,CAAC,GAAGkH,QAAQ,GAAG,IAAI,CAACT,IAAI,CAACvG,CAAC,GAAG,IAAI,CAACuG,IAAI,CAACrG,CAAC;MACxEiH,QAAQ,GAAGf,IAAI;IAChB;IACA0D,OAAO,GAAI9C,QAAQ,GAAG,IAAI,CAACD,cAAe;IAC1C8C,OAAO,GAAI1C,QAAQ,GAAG,IAAI,CAACD,cAAe;IAC1C,IAAI4C,OAAO,GAAG1N,gBAAgB,IAAI0N,OAAO,GAAG,CAAC1N,gBAAgB,EAAE;MAC9D0N,OAAO,GAAG,CAAC;IACZ;IACA,IAAID,OAAO,GAAGzN,gBAAgB,IAAIyN,OAAO,GAAG,CAACzN,gBAAgB,EAAE;MAC9DyN,OAAO,GAAG,CAAC;IACZ;IACAb,CAAC,GAAG,CAAE,CAAC,IAAI,CAAC3B,cAAc,GAAGwC,OAAO,IAAID,GAAG,GAAI,CAAC,IAAIA,GAAG;IACvDX,CAAC,GAAG,CAAE,CAAC,IAAI,CAAC3B,cAAc,GAAGwC,OAAO,IAAIF,GAAG,GAAI,CAAC,IAAIA,GAAG;IACvD,IAAI,IAAI,CAACN,IAAI,IAAI,CAACpM,MAAM,EAAE;MACzBK,MAAM,CAACyL,CAAC,GAAGA,CAAC;MACZzL,MAAM,CAAC0L,CAAC,GAAGA,CAAC;MACZ,IAAI,CAACK,IAAI,CAACvG,IAAI,CAAC,IAAI,EAAExF,MAAM,CAAC;MAC5ByL,CAAC,GAAGzL,MAAM,CAACyL,CAAC;MACZC,CAAC,GAAG1L,MAAM,CAAC0L,CAAC;IACb;IACA,IAAI,IAAI,CAACD,CAAC,KAAKA,CAAC,IAAI,IAAI,CAACC,CAAC,KAAKA,CAAC,EAAE;MACjC,IAAI,CAAC5C,OAAO,CAACnG,CAAC,GAAG,IAAI,CAAC+I,CAAC,GAAGA,CAAC;MAC3B,IAAI,CAAC5C,OAAO,CAACpG,CAAC,GAAG,IAAI,CAAC+I,CAAC,GAAGA,CAAC;MAC3B,IAAI,CAAC,IAAI,CAAChB,UAAU,IAAI,IAAI,CAACT,SAAS,EAAE;QACvC,IAAI,CAACS,UAAU,GAAG,IAAI;QACtBhF,SAAS,CAAC,aAAa,EAAE,IAAI,EAAE,IAAI,CAACyE,YAAY,CAAC;MAClD;IACD;EACD;EAEAkC,OAAOA,CAACA,OAAO,EAAE;IAChB,IAAI,CAACI,SAAS,CAACvJ,MAAM,EAAE;MACtB,OAAO,IAAI,CAACmH,QAAQ;IACrB;IACA,IAAIqC,QAAQ;IACZ,IAAI,CAACrC,QAAQ,GAAGgC,OAAO;IACvB,IAAIA,OAAO,EAAE;MACZ,IAAI,CAAC7N,gBAAgB,EAAE;QACtB4F,YAAY,CAAC,IAAI,CAACvC,MAAM,EAAE,WAAW,EAAE,IAAI,CAAC8G,QAAQ,CAAC;MACtD;MACAvE,YAAY,CAAC,IAAI,CAACvC,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC8G,QAAQ,CAAC;MACtDvE,YAAY,CAAC,IAAI,CAACvC,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC8K,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;IAC1D,CAAC,MAAM;MACND,QAAQ,GAAG,IAAI,CAAChC,UAAU;MAC1B9F,eAAe,CAAC,IAAI,CAAC/C,MAAM,EAAE,WAAW,EAAE,IAAI,CAAC8G,QAAQ,CAAC;MACxD/D,eAAe,CAAC,IAAI,CAAC/C,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC8G,QAAQ,CAAC;MACzD/D,eAAe,CAACnG,IAAI,EAAE,kBAAkB,EAAE4B,eAAe,CAAC;MAC1DuE,eAAe,CAAC,IAAI,CAAC/C,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC8K,QAAQ,CAAC;MACpD,IAAI,IAAI,CAAC9D,gBAAgB,EAAE;QAC1BjE,eAAe,CAAC,IAAI,CAACiE,gBAAgB,EAAE,aAAa,EAAE,IAAI,CAACM,UAAU,CAAC;QACtEvE,eAAe,CAAC,IAAI,CAACiE,gBAAgB,EAAE,UAAU,EAAE,IAAI,CAACM,UAAU,CAAC;QACnEvE,eAAe,CAAC,IAAI,CAACiE,gBAAgB,EAAE,WAAW,EAAE,IAAI,CAACO,OAAO,CAAC;MAClE;MACAxE,eAAe,CAACrG,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC4K,UAAU,CAAC;MACjDvE,eAAe,CAACrG,IAAI,EAAE,WAAW,EAAE,IAAI,CAAC6K,OAAO,CAAC;MAChD,IAAI,CAACsB,UAAU,GAAG,IAAI,CAACT,SAAS,GAAG,KAAK;MACxC,IAAIyC,QAAQ,EAAE;QACbhH,SAAS,CAAC,WAAW,EAAE,IAAI,EAAE,IAAI,CAACyE,YAAY,CAAC;MAChD;IACD;IACA,OAAO,IAAI;EACZ;EAEAyC,OAAOA,CAACjK,CAAC,EAAE;IACV,IAAI,CAACwG,UAAU,CAACxG,CAAC,CAAC;EACnB;AAED;AAMA,MAAM2I,MAAM,CAAC;EAEZQ,WAAWA,CAACZ,MAAM,EAAEF,OAAO,EAAEC,CAAC,EAAEhI,CAAC,EAAE6C,IAAI,EAAE;IACxC,IAAI,CAACoF,MAAM,GAAGA,MAAM;IACpB,IAAI,CAAClK,OAAO,GAAGH,UAAU,CAAC,MAAM,EAAEqK,MAAM,CAAC2B,UAAU,EAAE;MAACC,IAAI,EAACjO,eAAe;MAAEkO,MAAM,EAAClO,eAAe;MAAEmO,WAAW,EAAC,CAAC;MAAEC,YAAY,EAAC;IAAoB,CAAC,CAAC;IACtJ,IAAI,CAAC3E,MAAM,CAAC0C,OAAO,EAAEC,CAAC,EAAEhI,CAAC,CAAC;IAC1B,IAAI,CAACjC,OAAO,CAAC+C,YAAY,GAAG,IAAI;IAChC,IAAI,CAAC+B,IAAI,GAAGA,IAAI,IAAI,CAAC,CAAC;IACtB,IAAI,CAACoH,UAAU,GAAG,IAAIrB,YAAY,CAAC,IAAI,CAAC7K,OAAO,EAAE;MAAC+E,aAAa,EAAC,IAAI;MAAEwE,MAAM,EAAC,IAAI,CAACA,MAAM;MAAEyB,IAAI,EAAC,IAAI,CAAClG,IAAI,CAACkG,IAAI;MAAE9B,OAAO,EAAC,IAAI,CAACA,OAAO;MAAEW,SAAS,EAAC,IAAI,CAACA,SAAS;MAAEF,OAAO,EAAC,IAAI,CAACA,OAAO;MAAEG,SAAS,EAAC,IAAI,CAACA;IAAS,CAAC,CAAC;EAChN;EAEAZ,OAAOA,CAAA,EAAG;IACTxE,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEAiF,OAAOA,CAAA,EAAG;IACTjF,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEA6E,MAAMA,CAAA,EAAG;IACR,IAAI4C,CAAC,GAAG,IAAI,CAAChC,OAAO;IACpB,IAAI,CAACrF,IAAI,CAACyE,MAAM,CAAC9E,IAAI,CAAC,IAAI,CAACK,IAAI,CAACC,aAAa,IAAI,IAAI,EAAE,IAAI,EAAE,IAAI,CAACmH,UAAU,CAACxB,CAAC,GAAGyB,CAAC,CAAC,IAAI,CAAClK,CAAC,CAAC,EAAE,IAAI,CAACiK,UAAU,CAACvB,CAAC,GAAGwB,CAAC,CAAC,IAAI,CAAClK,CAAC,GAAC,CAAC,CAAC,CAAC;EAC7H;EAEA6H,SAASA,CAAA,EAAG;IACXpF,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC;EAC7B;EAEAmF,SAASA,CAAA,EAAG;IACXnF,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC;EAC7B;EAEA4C,MAAMA,CAAC0C,OAAO,EAAEC,CAAC,EAAEhI,CAAC,EAAE;IACrB,IAAI+H,OAAO,EAAE;MACZ,IAAI,CAACA,OAAO,GAAGA,OAAO;IACvB;IACA,IAAIyB,SAAS,CAACvJ,MAAM,IAAI,CAAC,EAAE;MAC1B+H,CAAC,GAAG,IAAI,CAACA,CAAC;MACVhI,CAAC,GAAG,IAAI,CAACA,CAAC;IACX,CAAC,MAAM;MACN,IAAI,CAACgI,CAAC,GAAGA,CAAC;MACV,IAAI,CAAChI,CAAC,GAAGA,CAAC;IACX;IACA,IAAImK,UAAU,GAAG,IAAI,CAACC,MAAM;MAC3BlC,OAAO,GAAG,IAAI,CAACH,OAAO,CAACC,CAAC,CAAC;MACzBqC,EAAE,GAAGrK,CAAC,KAAK,CAAC,IAAIkI,OAAO,CAACE,MAAM,GAAGF,OAAO,CAACjI,MAAM,GAAG,CAAC,GAAGD,CAAC,GAAG,CAAC;IAC5D,IAAI,CAACkI,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACkC,MAAM,GAAIpK,CAAC,GAAG,CAAC,IAAIA,CAAC,GAAGkI,OAAO,CAACjI,MAAM,GAAG,CAAC,IAAIlE,IAAI,CAACuO,GAAG,CAACvO,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,EAAEnC,OAAO,CAAClI,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,CAAC,CAAC,GAAGtO,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,EAAEkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,GAAI,CAAC,GAAG,CAAC,CAAC,CAAC;IACrN,IAAI,IAAI,CAACoK,MAAM,KAAKD,UAAU,EAAE;MAC/B,IAAI,CAACpM,OAAO,CAACgH,YAAY,CAAC,GAAG,EAAE,IAAI,CAACqF,MAAM,GAAG,IAAI,CAACnC,MAAM,CAACuC,aAAa,GAAG,IAAI,CAACvC,MAAM,CAACwC,aAAa,CAAC;IACpG;IACA,IAAI,CAAC1M,OAAO,CAACgH,YAAY,CAAC,WAAW,EAAE,YAAY,GAAGmD,OAAO,CAAClI,CAAC,CAAC,GAAG,GAAG,GAAGkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAG,GAAG,CAAC;EAC7F;AACD;AAKA,OAAO,MAAM0K,UAAU,CAAC;EAEvB7B,WAAWA,CAACjK,MAAM,EAAEiE,IAAI,EAAE;IACzBA,IAAI,GAAGA,IAAI,IAAI,CAAC,CAAC;IACjBM,YAAY,IAAIC,SAAS,CAAC,CAAC;IAC3B,IAAI,CAACP,IAAI,GAAGA,IAAI;IAChB,IAAI,CAAC1C,IAAI,GAAI,OAAOvB,MAAO,KAAK,QAAQ,GAAItD,IAAI,CAACwN,gBAAgB,CAAClK,MAAM,CAAC,CAAC,CAAC,CAAC,GAAGA,MAAM;IACrF,IAAI,CAAC+L,EAAE,GAAG/M,UAAU,CAAC,GAAG,EAAE,IAAI,CAACuC,IAAI,CAAChB,eAAe,EAAE;MAACjB,KAAK,EAAC;IAA2B,CAAC,CAAC;IACzF,IAAI,CAAC0M,iBAAiB,GAAGhN,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC+M,EAAE,EAAE;MAACb,MAAM,EAAC,aAAa;MAAEC,WAAW,EAAC,EAAE;MAAEF,IAAI,EAAC,MAAM;MAAEG,YAAY,EAAC;IAAoB,CAAC,CAAC;IAC5I,IAAI,CAACJ,UAAU,GAAG/G,IAAI,CAAC+G,UAAU,IAAIhM,UAAU,CAAC,GAAG,EAAE,IAAI,CAAC+M,EAAE,EAAE;MAACzM,KAAK,EAAC;IAAmC,CAAC,CAAC;IAC1G,IAAI,CAAC2M,cAAc,GAAGjN,UAAU,CAAC,MAAM,EAAE,IAAI,CAACgM,UAAU,EAAE;MAACE,MAAM,EAAClO,eAAe;MAAEmO,WAAW,EAAC,CAAC;MAAEF,IAAI,EAAC,MAAM;MAAEG,YAAY,EAAC;IAAoB,CAAC,CAAC;IAClJ,IAAI,CAACjK,gBAAgB,GAAG,EAAE;IAC1B,IAAI,CAAC+K,MAAM,GAAGlN,UAAU,CAAC,UAAU,EAAE,IAAI,CAACgM,UAAU,EAAE;MAACE,MAAM,EAAClO,eAAe;MAAEmO,WAAW,EAAC,CAAC;MAAEC,YAAY,EAAC;IAAoB,CAAC,CAAC;IACjI,IAAI,CAACe,MAAM,GAAGnN,UAAU,CAAC,UAAU,EAAE,IAAI,CAACgM,UAAU,EAAE;MAACE,MAAM,EAAClO,eAAe;MAAEmO,WAAW,EAAC,CAAC;MAAEC,YAAY,EAAC;IAAoB,CAAC,CAAC;IACjI,IAAI,CAACc,MAAM,CAAC3M,KAAK,CAAC6M,aAAa,GAAG,IAAI,CAACD,MAAM,CAAC5M,KAAK,CAAC6M,aAAa,GAAG,IAAI,CAACH,cAAc,CAAC1M,KAAK,CAAC6M,aAAa,GAAG,MAAM;IACpH,IAAI,CAAC5D,QAAQ,GAAG,IAAI;IACpB,IAAIzB,GAAG,GAAG,IAAI,CAACxF,IAAI,CAACf,UAAU,CAACkF,YAAY,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MACtD/D,IAAI,GAAG,CAACmF,GAAG,CAACrG,CAAC,GAAGqG,GAAG,CAAClG,CAAC,IAAI,CAAC,IAAIoD,IAAI,CAACoI,UAAU,IAAI,CAAC,CAAC;IACpD,IAAI,CAACR,aAAa,GAAGlK,kBAAkB,CAACC,IAAI,CAAC;IAC7C,IAAI,CAACgK,aAAa,GAAG9J,kBAAkB,CAACF,IAAI,GAAG,IAAI,CAAC;IACpD,IAAI,CAAC0K,QAAQ,GAAGtN,UAAU,CAAC,MAAM,EAAE,IAAI,CAACgM,UAAU,EAAE;MAACnK,CAAC,EAAC,IAAI,CAACgL,aAAa;MAAEZ,IAAI,EAACjO,eAAe;MAAEkO,MAAM,EAAC,aAAa;MAAEC,WAAW,EAAC;IAAC,CAAC,CAAC;IACtI,IAAI,CAACoB,QAAQ,GAAGvN,UAAU,CAAC,MAAM,EAAE,IAAI,CAACgM,UAAU,EAAE;MAACnK,CAAC,EAAC,IAAI,CAACgL,aAAa;MAAEZ,IAAI,EAACjO,eAAe;MAAEkO,MAAM,EAAC,aAAa;MAAEC,WAAW,EAAC;IAAC,CAAC,CAAC;IACtI,IAAI,CAACmB,QAAQ,CAACjB,UAAU,GAAG,IAAIrB,YAAY,CAAC,IAAI,CAACsC,QAAQ,EAAE;MAAC5D,MAAM,EAAC,IAAI,CAAC8D,cAAc;MAAEtI,aAAa,EAAC,IAAI;MAAEmE,OAAO,EAAC,IAAI,CAACoE,eAAe;MAAEzD,SAAS,EAAC,IAAI,CAAC0D,gBAAgB;MAAE5D,OAAO,EAAC,IAAI,CAAC6D,eAAe;MAAExC,IAAI,EAAClG,IAAI,CAAC2I;IAAU,CAAC,CAAC;IAC/N,IAAI,CAACL,QAAQ,CAAClB,UAAU,GAAG,IAAIrB,YAAY,CAAC,IAAI,CAACuC,QAAQ,EAAE;MAAC7D,MAAM,EAAC,IAAI,CAACmE,cAAc;MAAE3I,aAAa,EAAC,IAAI;MAAEmE,OAAO,EAAC,IAAI,CAACyE,eAAe;MAAE9D,SAAS,EAAC,IAAI,CAAC0D,gBAAgB;MAAE5D,OAAO,EAAC,IAAI,CAACiE,eAAe;MAAE5C,IAAI,EAAClG,IAAI,CAAC2I;IAAU,CAAC,CAAC;IAC/N,IAAI,CAACN,QAAQ,CAAC/M,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACT,QAAQ,CAAChN,KAAK,CAACyN,UAAU,GAAG,QAAQ;IAC1E,IAAIC,cAAc,GAAG,CAAC,IAAI,CAACX,QAAQ,EAAE,IAAI,CAACC,QAAQ,EAAE,IAAI,CAACL,MAAM,EAAE,IAAI,CAACC,MAAM,EAAE,IAAI,CAACnB,UAAU,EAAE,IAAI,CAACiB,cAAc,EAAE,IAAI,CAACD,iBAAiB,CAAC;MAC1I5K,CAAC,GAAG6L,cAAc,CAAC5L,MAAM;IAC1B,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;MAChB6L,cAAc,CAAC7L,CAAC,CAAC,CAACc,YAAY,GAAG,IAAI,CAAC,CAAC;IACxC;IACA,IAAI+B,IAAI,CAACiJ,SAAS,KAAK,KAAK,EAAE;MAC7B,IAAI,CAAC7B,UAAU,GAAG,IAAIrB,YAAY,CAAC,IAAI,CAACgC,iBAAiB,EAAE;QAAC9H,aAAa,EAAC,IAAI;QAAEmE,OAAO,EAAC,IAAI,CAAC/D,MAAM;QAAE0E,SAAS,EAAC,IAAI,CAAC1B,UAAU;QAAEoB,MAAM,EAAC,IAAI,CAACyE,WAAW;QAAElE,SAAS,EAAC,IAAI,CAACmE,UAAU;QAAE/C,IAAI,EAAC,IAAI,CAACpG,IAAI,CAACoG,IAAI;QAAEC,IAAI,EAAC,IAAI,CAACrG,IAAI,CAACqG;MAAI,CAAC,CAAC;IAC/N;IACA,IAAI,CAAClE,IAAI,CAAC,CAAC;IACX,IAAI,CAAC4E,UAAU,CAACzL,KAAK,CAACyN,UAAU,GAAI/I,IAAI,CAACoJ,QAAQ,KAAK,KAAK,GAAI,QAAQ,GAAG,SAAS;IACnF,IAAIpJ,IAAI,CAACoJ,QAAQ,KAAK,KAAK,EAAE;MAC5B,IAAI,CAAC9L,IAAI,CAACW,YAAY,GAAG,IAAI;MAC7B3D,cAAc,CAACgI,IAAI,CAAC,IAAI,CAAC;IAC1B;IACA,IAAI,CAAC6G,UAAU,CAAC,CAAC;IACjB,IAAI,CAACzQ,gBAAgB,EAAE;MACtB4F,YAAY,CAAC,IAAI,CAACyJ,iBAAiB,EAAE,WAAW,EAAEtI,KAAK,CAAC,IAAI,CAAC4J,qBAAqB,EAAE,IAAI,CAAC,CAAC;MAC1F/K,YAAY,CAAC,IAAI,CAACyJ,iBAAiB,EAAE,SAAS,EAAEtI,KAAK,CAAC,IAAI,CAAC4D,UAAU,EAAE,IAAI,CAAC,CAAC;IAC9E;IACA/E,YAAY,CAAC,IAAI,CAACyJ,iBAAiB,EAAE,YAAY,EAAEtI,KAAK,CAAC,IAAI,CAAC4J,qBAAqB,EAAE,IAAI,CAAC,CAAC;IAC3F/K,YAAY,CAAC,IAAI,CAACyJ,iBAAiB,EAAE,UAAU,EAAEtI,KAAK,CAAC,IAAI,CAAC4D,UAAU,EAAE,IAAI,CAAC,CAAC;IAC9EvK,QAAQ,CAAC,IAAI,CAAC;EACf;EAEAuK,UAAUA,CAACxG,CAAC,EAAE;IACb,IAAIyM,MAAM,GAAG,IAAI,CAACC,cAAc;IAChC,IAAID,MAAM,EAAE;MACXrP,YAAY,CAAC2L,CAAC,GAAG0D,MAAM,CAACjE,OAAO,CAACiE,MAAM,CAACnM,CAAC,CAAC;MACzClD,YAAY,CAAC4L,CAAC,GAAGyD,MAAM,CAACjE,OAAO,CAACiE,MAAM,CAACnM,CAAC,GAAC,CAAC,CAAC;IAC5C;IACA2B,eAAe,CAACnG,IAAI,EAAE,kBAAkB,EAAE4B,eAAe,CAAC,CAAC,CAAC;IAC5DqF,SAAS,CAAC,WAAW,EAAE,IAAI,EAAE/C,CAAC,CAAC;EAChC;EAEAsF,IAAIA,CAAA,EAAG;IACN,IAAIqH,QAAQ,GAAG,IAAI,CAAClM,IAAI,CAACC,YAAY,CAAC,GAAG,CAAC;MACzC2H,OAAO,GAAGrN,eAAe,CAAC2R,QAAQ,CAAC;MACnCxN,SAAS,GAAG,IAAI,CAACsB,IAAI,CAACC,YAAY,CAAC,WAAW,CAAC,IAAI,gBAAgB;MACnEkM,aAAa,GAAI,CAAC,IAAI,CAACC,QAAQ,IAAIxE,OAAO,CAACyE,WAAW,KAAK,IAAI,CAACD,QAAQ,CAACC,WAAW,IAAIzE,OAAO,CAAC9H,MAAM,KAAK,IAAI,CAACsM,QAAQ,CAACtM,MAAO;MAChIwM,UAAU,GAAG;QAAC3J,aAAa,EAAC,IAAI;QAAEiG,IAAI,EAAC,IAAI,CAAClG,IAAI,CAAC6J,UAAU;QAAEpF,MAAM,EAAC,IAAI,CAACqF,aAAa;QAAE1F,OAAO,EAAC,IAAI,CAAC2F,cAAc;QAAEhF,SAAS,EAAC,IAAI,CAAC1B,UAAU;QAAEwB,OAAO,EAAC,IAAI,CAACmF,cAAc;QAAEhF,SAAS,EAAC,IAAI,CAACiF,gBAAgB;QAAE7D,IAAI,EAAC,IAAI,CAACpG,IAAI,CAACoG,IAAI;QAAEC,IAAI,EAAC,IAAI,CAACrG,IAAI,CAACqG;MAAI,CAAC;MACvPf,CAAC;MAAEnI,CAAC;IAEL,IAAIsM,aAAa,IAAI,IAAI,CAACrH,QAAQ,IAAI,IAAI,CAACA,QAAQ,CAAChF,MAAM,EAAE;MAC3D,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM,EAAED,CAAC,EAAE,EAAE;QAC1C,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC,CAACjC,OAAO,CAACqB,UAAU,CAAC2N,WAAW,CAAC,IAAI,CAAC9H,QAAQ,CAACjF,CAAC,CAAC,CAACjC,OAAO,CAAC;QACzE,IAAI,CAACkH,QAAQ,CAACjF,CAAC,CAAC,CAACiK,UAAU,CAACb,OAAO,CAAC,KAAK,CAAC;MAC3C;MACA,IAAI,CAACrJ,gBAAgB,CAACE,MAAM,GAAG,CAAC;IACjC;IACA,IAAI,CAACsM,QAAQ,GAAGxE,OAAO;IACvB,IAAIuE,aAAa,EAAE;MAClB,IAAI,CAACrH,QAAQ,GAAG6C,qBAAqB,CAACC,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE0E,UAAU,CAAC;MACnEtE,CAAC,GAAGJ,OAAO,CAAC9H,MAAM;MAClB,IAAIkI,CAAC,GAAG,CAAC,EAAE;QACV,KAAKnI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,EAAE,EAAE;UACvB,IAAI,CAACiF,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAAC+H,MAAM,CAAClF,qBAAqB,CAACC,OAAO,EAAE/H,CAAC,EAAE,IAAI,EAAEyM,UAAU,CAAC,CAAC;QAC1F;MACD;IACD,CAAC,MAAM;MACNzM,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM;MACxB,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;QAChB,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC,CAACqF,MAAM,CAAC0C,OAAO,CAAC;MACjC;IACD;IAEA,IAAI,CAAC6B,UAAU,CAACpL,WAAW,CAAC,IAAI,CAAC0M,QAAQ,CAAC,CAAC,CAAC;IAC5C,IAAI,CAACtB,UAAU,CAACpL,WAAW,CAAC,IAAI,CAAC2M,QAAQ,CAAC;IAC1C;IACA,IAAI,CAACN,cAAc,CAAC9F,YAAY,CAAC,GAAG,EAAEsH,QAAQ,CAAC;IAC/C,IAAI,CAACzB,iBAAiB,CAAC7F,YAAY,CAAC,GAAG,EAAEsH,QAAQ,CAAC;IAClD,IAAI,CAAC1B,EAAE,CAAC5F,YAAY,CAAC,WAAW,EAAE/F,0BAA0B,CAAC,IAAI,CAACmB,IAAI,CAACf,UAAU,CAAC,IAAI,gBAAgB,CAAC;IACvG,IAAI,CAACwK,UAAU,CAAC7E,YAAY,CAAC,WAAW,EAAElG,SAAS,CAAC;IACpD,IAAI,CAAC+L,iBAAiB,CAAC7F,YAAY,CAAC,WAAW,EAAElG,SAAS,CAAC;IAC3D,IAAI,CAACuG,cAAc,CAAC,CAAC;IACrB,OAAO,IAAI;EACZ;EAEA4G,UAAUA,CAAA,EAAG;IACZpM,WAAW,CAAC,IAAI,CAAC;EAClB;EAEAsM,qBAAqBA,CAACxM,CAAC,EAAE;IACxB,IAAI,IAAI,CAACkK,UAAU,CAACzL,KAAK,CAACyN,UAAU,KAAK,QAAQ,EAAE;MAClD,IAAI,CAAC1I,MAAM,CAAC,CAAC;IACd,CAAC,MAAM,IAAIxG,IAAI,IAAKgD,CAAC,IAAIA,CAAC,CAACuN,MAAO,EAAE;MACnC,IAAIR,UAAU,GAAG;UAAC3J,aAAa,EAAC,IAAI;UAAEiG,IAAI,EAAC,IAAI,CAAClG,IAAI,CAAC6J,UAAU;UAAEpF,MAAM,EAAC,IAAI,CAACqF,aAAa;UAAE1F,OAAO,EAAC,IAAI,CAAC2F,cAAc;UAAEhF,SAAS,EAAC,IAAI,CAAC1B,UAAU;UAAEwB,OAAO,EAAC,IAAI,CAACmF,cAAc;UAAEhF,SAAS,EAAC,IAAI,CAACiF,gBAAgB;UAAE7D,IAAI,EAAC,IAAI,CAACpG,IAAI,CAACoG,IAAI;UAAEC,IAAI,EAAC,IAAI,CAACrG,IAAI,CAACqG;QAAI,CAAC;QAC1PvD,GAAG,GAAG,IAAI,CAACiE,UAAU,CAACtF,YAAY,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;QAC9C2I,QAAQ;QAAElN,CAAC;QAAEmM,MAAM;QAAE1D,CAAC;QAAEC,CAAC;QAAEyE,WAAW;MACvC,IAAI,IAAI,CAAClD,UAAU,EAAE;QACpB,IAAI,CAACA,UAAU,CAAC/D,UAAU,CAACxG,CAAC,CAAC,CAAC,CAAC;MAChC;MACA,IAAIiG,GAAG,EAAE;QACR8C,CAAC,GAAG/I,CAAC,CAAC0N,OAAO,GAAGzH,GAAG,CAACrG,CAAC,GAAGI,CAAC,CAAC2N,OAAO,GAAG1H,GAAG,CAACnG,CAAC,GAAGmG,GAAG,CAACjG,CAAC;QACjDgJ,CAAC,GAAGhJ,CAAC,CAAC0N,OAAO,GAAGzH,GAAG,CAACpG,CAAC,GAAGG,CAAC,CAAC2N,OAAO,GAAG1H,GAAG,CAAClG,CAAC,GAAGkG,GAAG,CAAChG,CAAC;MAClD;MACA;MACAwN,WAAW,GAAGnS,cAAc,CAAC,IAAI,CAACuR,QAAQ,EAAE9D,CAAC,EAAEC,CAAC,CAAC;MACjD3N,gBAAgB,CAAC,IAAI,CAACwR,QAAQ,CAACY,WAAW,CAACnF,CAAC,CAAC,EAAEmF,WAAW,CAACnN,CAAC,EAAEmN,WAAW,CAACG,CAAC,CAAC;MAC5EJ,QAAQ,GAAGC,WAAW,CAACnN,CAAC,GAAG,CAAC;MAC5B,KAAKA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM,EAAED,CAAC,EAAE,EAAE;QAC1C,IAAI,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC,CAACA,CAAC,IAAIkN,QAAQ,IAAI,IAAI,CAACjI,QAAQ,CAACjF,CAAC,CAAC,CAACgI,CAAC,KAAKmF,WAAW,CAACnF,CAAC,EAAE;UAC3E,IAAI,CAAC/C,QAAQ,CAACjF,CAAC,CAAC,CAACA,CAAC,IAAI,CAAC;QACxB;MACD;MACAmM,MAAM,GAAG,IAAI9D,MAAM,CAAC,IAAI,EAAE,IAAI,CAACkE,QAAQ,EAAEY,WAAW,CAACnF,CAAC,EAAEkF,QAAQ,EAAET,UAAU,CAAC;MAC7E,IAAI,CAAC7C,UAAU,CAACpL,WAAW,CAAC,IAAI,CAAC0M,QAAQ,CAAC,CAAC,CAAC;MAC5C,IAAI,CAACtB,UAAU,CAACpL,WAAW,CAAC,IAAI,CAAC2M,QAAQ,CAAC;MAC1CgB,MAAM,CAAClC,UAAU,CAACvE,QAAQ,CAAChG,CAAC,CAAC;MAC7B7C,oBAAoB,GAAGsP,MAAM;MAC7B,IAAI,CAAClH,QAAQ,CAACE,IAAI,CAACgH,MAAM,CAAC;MAC1B,IAAI,CAACpM,gBAAgB,CAACE,MAAM,GAAG,CAAC;MAChC,IAAI,CAACF,gBAAgB,CAACoF,IAAI,CAACgH,MAAM,CAAC;MAClC,IAAI,CAAC/G,cAAc,CAAC,CAAC;MACrB,IAAI,CAACC,MAAM,CAAC,CAAC;MACb,IAAI,CAAC2G,UAAU,CAAC,CAAC;IAClB;IACAhJ,eAAe,CAAC,CAAC;IACjB7B,YAAY,CAAC3F,IAAI,EAAE,kBAAkB,EAAE4B,eAAe,CAAC,CAAC,CAAC;IACzDqF,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEA8I,eAAeA,CAAA,EAAG;IACjB,IAAIY,MAAM,GAAG,IAAI,CAACC,cAAc;MAC/BpM,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZkK,CAAC,GAAGiC,MAAM,CAACjE,OAAO;MAClBmC,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAG4B,CAAC,CAACjK,MAAM,GAAG,CAAC,GAAGD,CAAC,GAAG,CAAC;IACjD,IAAItD,IAAI,IAAIX,IAAI,CAACuO,GAAG,CAACJ,CAAC,CAAClK,CAAC,CAAC,GAAGkK,CAAC,CAACG,EAAE,CAAC,CAAC,GAAG,CAAC,IAAItO,IAAI,CAACuO,GAAG,CAACJ,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGkK,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;MACzE,IAAI,CAACwC,cAAc,CAACV,MAAM,CAAC;IAC5B;EACD;EAEAR,eAAeA,CAAA,EAAG;IACjB,IAAIQ,MAAM,GAAG,IAAI,CAACC,cAAc;MAC/BpM,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZkK,CAAC,GAAGiC,MAAM,CAACjE,OAAO;IACnB,IAAIxL,IAAI,IAAIX,IAAI,CAACuO,GAAG,CAACJ,CAAC,CAAClK,CAAC,CAAC,GAAGkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAIjE,IAAI,CAACuO,GAAG,CAACJ,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;MACzE,IAAI,CAAC6M,cAAc,CAACV,MAAM,CAAC;IAC5B;EACD;EAEAW,gBAAgBA,CAACpN,CAAC,EAAE;IACnB7C,oBAAoB,GAAG,IAAI;IAC3B,IAAI,CAACmP,UAAU,CAAC,CAAC;EAClB;EAEAuB,UAAUA,CAAA,EAAG;IACZ,OAAQ,IAAI,CAACxN,gBAAgB,CAACE,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC2J,UAAU,CAACzL,KAAK,CAACyN,UAAU,KAAK,SAAS;EAC3F;EAEA1I,MAAMA,CAACsK,UAAU,EAAE;IAClB,IAAI,CAAC5D,UAAU,CAACzL,KAAK,CAACyN,UAAU,GAAG,SAAS;IAC5C,IAAI,CAACQ,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACjM,IAAI,CAACW,YAAY,GAAG,IAAI;IAC7B,IAAI0M,UAAU,KAAK,IAAI,EAAE;MACxB,IAAIxN,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM;MAC5B,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;QAChB,IAAI,CAACD,gBAAgB,CAACC,CAAC,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC;MAC5C;IACD;IACA,IAAI7C,cAAc,CAAC+H,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;MACxC/H,cAAc,CAACgI,IAAI,CAAC,IAAI,CAAC;IAC1B;IACA,IAAI,CAACC,cAAc,CAAC,CAAC;IACrB,OAAO,IAAI;EACZ;EAEArE,QAAQA,CAAA,EAAG;IACV,IAAI,CAAC6I,UAAU,CAACzL,KAAK,CAACyN,UAAU,GAAG,QAAQ;IAC3C,IAAI,CAAC7L,gBAAgB,CAACE,MAAM,GAAG,CAAC;IAChC,IAAI,CAACmM,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACjM,IAAI,CAACW,YAAY,GAAG,KAAK;IAC9B3D,cAAc,CAACsQ,MAAM,CAACtQ,cAAc,CAAC+H,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACtD,IAAI,CAACE,cAAc,CAAC,CAAC;IACrB,OAAO,IAAI;EACZ;EAEA2G,WAAWA,CAACrM,CAAC,EAAE;IACd,IAAIb,SAAS,GAAG,IAAI,CAAC+L,iBAAiB,CAACxK,YAAY,CAAC,WAAW,CAAC,IAAI,gBAAgB;IACpF,IAAI,CAACwJ,UAAU,CAAC7E,YAAY,CAAC,WAAW,EAAElG,SAAS,CAAC;IACpD,IAAI,CAACsB,IAAI,CAAC4E,YAAY,CAAC,WAAW,EAAElG,SAAS,CAAC;EAC/C;EAEA+N,cAAcA,CAACT,MAAM,EAAE;IACtB,IAAI,IAAI,CAACpM,gBAAgB,CAACmF,OAAO,CAACiH,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;MAAE;MACnD,IAAI,CAACxP,MAAM,EAAE;QACZ,IAAI,CAACoD,gBAAgB,CAACE,MAAM,GAAG,CAAC;MACjC;MACA,IAAI,CAACF,gBAAgB,CAACoF,IAAI,CAACgH,MAAM,CAAC;IACnC,CAAC,MAAM,IAAIxP,MAAM,EAAE;MAClB,IAAI,CAACoD,gBAAgB,CAAC0N,MAAM,CAAC,IAAI,CAAC1N,gBAAgB,CAACmF,OAAO,CAACiH,MAAM,CAAC,EAAE,CAAC,CAAC;MACtEA,MAAM,CAAClC,UAAU,CAACN,OAAO,CAAC,CAAC;IAC5B;IACA7M,YAAY,CAAC2L,CAAC,GAAG0D,MAAM,CAACjE,OAAO,CAACiE,MAAM,CAACnM,CAAC,CAAC;IACzClD,YAAY,CAAC4L,CAAC,GAAGyD,MAAM,CAACjE,OAAO,CAACiE,MAAM,CAACnM,CAAC,GAAC,CAAC,CAAC;IAC3C,IAAI,CAACoF,cAAc,CAAC,CAAC;IACrB3C,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEA8C,sBAAsBA,CAAA,EAAG;IACxB,IAAImI,OAAO,GAAG,IAAI,CAAC3N,gBAAgB;MAClCC,CAAC,GAAG0N,OAAO,CAACzN,MAAM;MAClBkM,MAAM;MAAEwB,KAAK;MAAE3F,CAAC;MAAE4F,MAAM;IACzB,OAAO,EAAE5N,CAAC,GAAG,CAAC,CAAC,EAAE;MAChBmM,MAAM,GAAGuB,OAAO,CAAC1N,CAAC,CAAC;MACnBmM,MAAM,CAACpO,OAAO,CAACqB,UAAU,CAAC2N,WAAW,CAACZ,MAAM,CAACpO,OAAO,CAAC;MACrDoO,MAAM,CAAClC,UAAU,CAACb,OAAO,CAAC,KAAK,CAAC;MAChCuE,KAAK,GAAGxB,MAAM,CAACnM,CAAC;MAChB4N,MAAM,GAAGzB,MAAM,CAACnE,CAAC;MACjB,IAAI,CAAC2F,KAAK,EAAE;QAAE;QACbxB,MAAM,CAACjE,OAAO,CAACuF,MAAM,CAACE,KAAK,EAAE,CAAC,CAAC;MAChC,CAAC,MAAM,IAAIA,KAAK,GAAGxB,MAAM,CAACjE,OAAO,CAACjI,MAAM,GAAG,CAAC,EAAE;QAC7CkM,MAAM,CAACjE,OAAO,CAACuF,MAAM,CAACE,KAAK,GAAC,CAAC,EAAE,CAAC,CAAC;MAClC,CAAC,MAAM;QAAE;QACRxB,MAAM,CAACjE,OAAO,CAACuF,MAAM,CAACE,KAAK,GAAC,CAAC,EAAE,CAAC,CAAC;MAClC;MACAD,OAAO,CAACD,MAAM,CAACzN,CAAC,EAAE,CAAC,CAAC;MACpB,IAAI,CAACiF,QAAQ,CAACwI,MAAM,CAAC,IAAI,CAACxI,QAAQ,CAACC,OAAO,CAACiH,MAAM,CAAC,EAAE,CAAC,CAAC;MACtD,KAAKnE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC/C,QAAQ,CAAChF,MAAM,EAAE+H,CAAC,EAAE,EAAE;QAC1C,IAAI,IAAI,CAAC/C,QAAQ,CAAC+C,CAAC,CAAC,CAAChI,CAAC,IAAI2N,KAAK,IAAI,IAAI,CAAC1I,QAAQ,CAAC+C,CAAC,CAAC,CAACA,CAAC,KAAK4F,MAAM,EAAE;UACjE,IAAI,CAAC3I,QAAQ,CAAC+C,CAAC,CAAC,CAAChI,CAAC,IAAI,CAAC;QACxB;MACD;IACD;IACA,IAAI,CAACoF,cAAc,CAAC,CAAC;IACrB,IAAI,CAACC,MAAM,CAAC,CAAC;IACb,IAAI,CAAC2G,UAAU,CAAC,CAAC;IACjB,IAAI,IAAI,CAACnJ,IAAI,CAACgL,cAAc,EAAE;MAC7B,IAAI,CAAChL,IAAI,CAACgL,cAAc,CAACrL,IAAI,CAAC,IAAI,CAACK,IAAI,CAACC,aAAa,IAAI,IAAI,CAAC;IAC/D;EACD;EAEA+J,cAAcA,CAACV,MAAM,EAAE;IACtB,IAAInM,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACfkI,OAAO,GAAGiE,MAAM,CAACjE,OAAO;MACxBmC,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAGJ,OAAO,CAACjI,MAAM,GAAG,CAAC,GAAGD,CAAC,GAAG,CAAC;MACtDqJ,GAAG,GAAG,IAAI;MACVyE,KAAK,GAAI,CAAC9N,CAAC,IAAIA,CAAC,IAAIkI,OAAO,CAACjI,MAAM,GAAG,CAAE;MACvC8N,MAAM;MAAEC,MAAM;MAAEC,OAAO;MAAEC,OAAO;MAAEC,GAAG;MAAEC,GAAG;IAC3C,IAAI1R,IAAI,IAAIG,oBAAoB,KAAKsP,MAAM,IAAI,IAAI,CAACC,cAAc,EAAE;MACnED,MAAM,CAAC/B,MAAM,GAAG,CAAC+B,MAAM,CAAC/B,MAAM;MAC9B,IAAI0D,KAAK,IAAI,CAAC3B,MAAM,CAAC7D,aAAa,EAAE;QAAE;QACrC6D,MAAM,CAAC/B,MAAM,GAAG,KAAK;MACtB;MACA+B,MAAM,CAACpO,OAAO,CAACgH,YAAY,CAAC,GAAG,EAAEoH,MAAM,CAAC/B,MAAM,GAAG,IAAI,CAACI,aAAa,GAAG,IAAI,CAACC,aAAa,CAAC;MACzF,IAAI0B,MAAM,CAAC/B,MAAM,KAAK,CAAC0D,KAAK,IAAI3B,MAAM,CAAC7D,aAAa,CAAC,EAAE;QACtDyF,MAAM,GAAGhS,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,EAAEnC,OAAO,CAAClI,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,CAAC,CAAC;QAC3E2D,MAAM,GAAGjS,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,EAAEkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,CAAC,CAAC;QAC3E+N,MAAM,GAAG,CAACA,MAAM,GAAGC,MAAM,IAAI,CAAC;QAC9BC,OAAO,GAAG1F,UAAU,CAACL,OAAO,EAAEmC,EAAE,EAAErK,CAAC,CAAC;QACpCkO,OAAO,GAAG3F,UAAU,CAACL,OAAO,EAAElI,CAAC,EAAEA,CAAC,GAAC,CAAC,CAAC;QACrC,IAAIiO,OAAO,GAAG,GAAG,EAAE;UAClBA,OAAO,GAAI1F,UAAU,CAACL,OAAO,EAAElI,CAAC,EAAEqK,EAAE,GAAC,CAAC,CAAC,GAAG,CAAE;UAC5C0D,MAAM,GAAGC,MAAM,IAAIjS,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,EAAEnC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,CAAC;QAC1F;QACA,IAAI6D,OAAO,GAAG,GAAG,EAAE;UAClBA,OAAO,GAAI3F,UAAU,CAACL,OAAO,EAAElI,CAAC,EAAEA,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE;UAC3CgO,MAAM,GAAGD,MAAM,IAAIhS,IAAI,CAACwO,KAAK,CAACrC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,EAAEnC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,CAAC;QAC1F;QACA8D,GAAG,GAAGpS,IAAI,CAACoS,GAAG,CAACJ,MAAM,CAAC;QACtBK,GAAG,GAAGrS,IAAI,CAACqS,GAAG,CAACL,MAAM,CAAC;QACtB,IAAIhS,IAAI,CAACuO,GAAG,CAAC0D,MAAM,GAAGD,MAAM,CAAC,GAAGhS,IAAI,CAACC,EAAE,GAAG,CAAC,EAAE;UAC5CmS,GAAG,GAAG,CAACA,GAAG;UACVC,GAAG,GAAG,CAACA,GAAG;QACX;QACAlG,OAAO,CAACmC,EAAE,CAAC,GAAG,CAAE,CAACnC,OAAO,CAAClI,CAAC,CAAC,GAAGoO,GAAG,GAAGH,OAAO,IAAI5E,GAAG,GAAI,CAAC,IAAIA,GAAG;QAC9DnB,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,GAAG,CAAE,CAACnC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGmO,GAAG,GAAGF,OAAO,IAAI5E,GAAG,GAAI,CAAC,IAAIA,GAAG;QAClEnB,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkI,OAAO,CAAClI,CAAC,CAAC,GAAGoO,GAAG,GAAGF,OAAO,IAAI7E,GAAG,GAAI,CAAC,IAAIA,GAAG;QAC/DnB,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGmO,GAAG,GAAGD,OAAO,IAAI7E,GAAG,GAAI,CAAC,IAAIA,GAAG;QACjE,IAAI,CAACjE,cAAc,CAAC,CAAC;QACrB,IAAI,CAACC,MAAM,CAAC,CAAC;QACb,IAAI,CAAC2G,UAAU,CAAC,CAAC;MAClB,CAAC,MAAM,IAAI,CAACG,MAAM,CAAC/B,MAAM,KAAK,CAAC0D,KAAK,IAAI3B,MAAM,CAAC7D,aAAa,CAAC,EAAE;QAC9D,IAAItI,CAAC,IAAImM,MAAM,CAAC7D,aAAa,EAAE;UAC9BJ,OAAO,CAACmC,EAAE,CAAC,GAAGnC,OAAO,CAAClI,CAAC,CAAC;UACxBkI,OAAO,CAACmC,EAAE,GAAC,CAAC,CAAC,GAAGnC,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;QAC7B;QACA,IAAIA,CAAC,GAAGkI,OAAO,CAACjI,MAAM,GAAG,CAAC,EAAE;UAC3BiI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,CAAC;UACzBkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAGkI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;QAC5B;QACA,IAAI,CAACoF,cAAc,CAAC,CAAC;QACrB,IAAI,CAACC,MAAM,CAAC,CAAC;QACb,IAAI,CAAC2G,UAAU,CAAC,CAAC;MAClB;IACD,CAAC,MAAM,IAAI,CAACrP,MAAM,EAAE;MACnB,IAAI,CAACoD,gBAAgB,CAACE,MAAM,GAAG,CAAC;MAChC,IAAI,CAACF,gBAAgB,CAACoF,IAAI,CAACgH,MAAM,CAAC;IACnC;IACAtP,oBAAoB,GAAG,IAAI;IAC3B,IAAI,CAACuI,cAAc,CAAC,CAAC;EACtB;EAEAA,cAAcA,CAAA,EAAG;IAChB,IAAI+G,MAAM,GAAI,IAAI,CAACpM,gBAAgB,CAACE,MAAM,KAAK,CAAC,GAAI,IAAI,CAACF,gBAAgB,CAAC,CAAC,CAAC,GAAG,IAAI;MAClFmI,OAAO,GAAGiE,MAAM,GAAGA,MAAM,CAACjE,OAAO,GAAG,IAAI;MACxClI,CAAC;MAAEyI,CAAC;MAAEC,CAAC;IACR,IAAI,CAAC0D,cAAc,GAAGD,MAAM;IAC5B,KAAKnM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM,EAAED,CAAC,EAAE,EAAE;MAC1C,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC,CAACjC,OAAO,CAACI,KAAK,CAAC0L,IAAI,GAAI,IAAI,CAAC9J,gBAAgB,CAACmF,OAAO,CAAC,IAAI,CAACD,QAAQ,CAACjF,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,GAAIpE,eAAe,GAAG,OAAO;MAC1H;IACD;IACA,IAAIuQ,MAAM,EAAE;MACX,IAAI,CAACjB,QAAQ,CAACnG,YAAY,CAAC,GAAG,EAAEoH,MAAM,CAAC/B,MAAM,GAAG,IAAI,CAACI,aAAa,GAAG,IAAI,CAACC,aAAa,CAAC;MACxF,IAAI,CAACU,QAAQ,CAACpG,YAAY,CAAC,GAAG,EAAEoH,MAAM,CAAC/B,MAAM,GAAG,IAAI,CAACI,aAAa,GAAG,IAAI,CAACC,aAAa,CAAC;IACzF;IACAzK,CAAC,GAAGmM,MAAM,GAAGA,MAAM,CAACnM,CAAC,GAAG,CAAC;IACzB,IAAImM,MAAM,KAAKnM,CAAC,IAAImM,MAAM,CAAC7D,aAAa,CAAC,EAAE;MAC1CG,CAAC,GAAG0D,MAAM,CAAC7D,aAAa,GAAGJ,OAAO,CAACA,OAAO,CAACjI,MAAM,GAAC,CAAC,CAAC,GAAGiI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;MACnE0I,CAAC,GAAGyD,MAAM,CAAC7D,aAAa,GAAGJ,OAAO,CAACA,OAAO,CAACjI,MAAM,GAAC,CAAC,CAAC,GAAGiI,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC;MACrE,IAAI,CAACkL,QAAQ,CAAC/M,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACd,MAAM,CAAC3M,KAAK,CAACyN,UAAU,GAAI,CAAClP,IAAI,IAAI+L,CAAC,KAAKP,OAAO,CAAClI,CAAC,CAAC,IAAI0I,CAAC,KAAKR,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAI,QAAQ,GAAG,SAAS;MACxI,IAAI,CAACkL,QAAQ,CAACnG,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG0D,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,GAAG,GAAG,CAAC;MAC5E,IAAI,CAACoC,MAAM,CAAC/F,YAAY,CAAC,QAAQ,EAAG0D,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,GAAGxL,MAAM,GAAGgL,OAAO,CAAClI,CAAC,CAAC,GAAG9C,MAAM,GAAGgL,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,CAAC;IAClG,CAAC,MAAM;MACN,IAAI,CAACkL,QAAQ,CAAC/M,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACd,MAAM,CAAC3M,KAAK,CAACyN,UAAU,GAAG,QAAQ;IACzE;IACA,IAAIO,MAAM,IAAInM,CAAC,GAAGkI,OAAO,CAACjI,MAAM,GAAG,CAAC,EAAE;MACrCwI,CAAC,GAAGP,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;MAChB0I,CAAC,GAAGR,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC;MAChB,IAAI,CAACmL,QAAQ,CAAChN,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACb,MAAM,CAAC5M,KAAK,CAACyN,UAAU,GAAI,CAAClP,IAAI,IAAI+L,CAAC,KAAKP,OAAO,CAAClI,CAAC,CAAC,IAAI0I,CAAC,KAAKR,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAI,QAAQ,GAAG,SAAS;MACxI,IAAI,CAACmL,QAAQ,CAACpG,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG0D,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,GAAG,GAAG,CAAC;MAC5E,IAAI,CAACqC,MAAM,CAAChG,YAAY,CAAC,QAAQ,EAAGmD,OAAO,CAAClI,CAAC,CAAC,GAAG9C,MAAM,GAAGgL,OAAO,CAAClI,CAAC,GAAC,CAAC,CAAC,GAAG9C,MAAM,GAAGuL,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,CAAC;IAElG,CAAC,MAAM;MACN,IAAI,CAACyC,QAAQ,CAAChN,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACb,MAAM,CAAC5M,KAAK,CAACyN,UAAU,GAAG,QAAQ;IACzE;EACD;EAEA/G,WAAWA,CAAA,EAAG;IACb,IAAIsH,MAAM,GAAG,IAAI,CAACC,cAAc;IAChC,IAAID,MAAM,EAAE;MACX,IAAIA,MAAM,CAACnM,CAAC,IAAImM,MAAM,CAAC7D,aAAa,EAAE;QACrC,IAAI,CAAC4C,QAAQ,CAAC/M,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACd,MAAM,CAAC3M,KAAK,CAACyN,UAAU,GAAG,SAAS;MAC1E;MACA,IAAIO,MAAM,CAACnM,CAAC,GAAGmM,MAAM,CAACjE,OAAO,CAACjI,MAAM,GAAG,CAAC,EAAE;QACzC,IAAI,CAACkL,QAAQ,CAAChN,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACb,MAAM,CAAC5M,KAAK,CAACyN,UAAU,GAAG,SAAS;MAC1E;IACD;EACD;EAEApG,aAAaA,CAAA,EAAG;IACf,IAAI2G,MAAM,GAAG,IAAI,CAACC,cAAc;MAC/BlC,CAAC;MAAElK,CAAC;MAAEqK,EAAE;IACT,IAAI8B,MAAM,EAAE;MACXjC,CAAC,GAAGiC,MAAM,CAACjE,OAAO;MAClBlI,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZqK,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAG4B,CAAC,CAACjK,MAAM,GAAG,CAAC,GAAGD,CAAC,GAAG,CAAC;MAChD,IAAIkK,CAAC,CAAClK,CAAC,CAAC,KAAKkK,CAAC,CAACG,EAAE,CAAC,IAAIH,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,KAAKkK,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,EAAE;QACzC,IAAI,CAACa,QAAQ,CAAC/M,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACd,MAAM,CAAC3M,KAAK,CAACyN,UAAU,GAAG,QAAQ;MACzE;MACA,IAAI1B,CAAC,CAAClK,CAAC,CAAC,KAAKkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,IAAIkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,KAAKkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,EAAE;QACzC,IAAI,CAACmL,QAAQ,CAAChN,KAAK,CAACyN,UAAU,GAAG,IAAI,CAACb,MAAM,CAAC5M,KAAK,CAACyN,UAAU,GAAG,QAAQ;MACzE;IACD;EACD;EAEAP,eAAeA,CAAA,EAAG;IACjB,IAAI,IAAI,CAACe,cAAc,CAAChC,MAAM,EAAE;MAC/B,IAAI,CAACiE,qBAAqB,GAAG9F,UAAU,CAAC,IAAI,CAAC6D,cAAc,CAAClE,OAAO,EAAE,IAAI,CAACkE,cAAc,CAACpM,CAAC,EAAE,IAAI,CAACoM,cAAc,CAACpM,CAAC,GAAC,CAAC,CAAC;IACrH;IACAyC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEAiJ,eAAeA,CAAA,EAAG;IACjB,IAAI,IAAI,CAACU,cAAc,CAAChC,MAAM,EAAE;MAC/B,IAAI,CAACiE,qBAAqB,GAAG9F,UAAU,CAAC,IAAI,CAAC6D,cAAc,CAAClE,OAAO,EAAE,IAAI,CAACkE,cAAc,CAAC9D,aAAa,GAAG,IAAI,CAAC8D,cAAc,CAAClE,OAAO,CAACjI,MAAM,GAAG,CAAC,GAAG,IAAI,CAACmM,cAAc,CAACpM,CAAC,GAAC,CAAC,EAAE,IAAI,CAACoM,cAAc,CAACpM,CAAC,CAAC;IAClM;IACAyC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC;EAC3B;EAEA6I,gBAAgBA,CAAC5L,CAAC,EAAE;IACnB,IAAI,CAACwG,UAAU,CAACxG,CAAC,CAAC;IAClB,IAAI,CAACsM,UAAU,CAAC,CAAC;EAClB;EAEAZ,cAAcA,CAAA,EAAG;IAChB,IAAIe,MAAM,GAAG,IAAI,CAACC,cAAc;MAC/BlC,CAAC,GAAGiC,MAAM,CAACjE,OAAO;MAClBlI,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZqK,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAG4B,CAAC,CAACjK,MAAM,GAAC,CAAC,GAAGD,CAAC,GAAC,CAAC;MAC5CqJ,GAAG,GAAG,IAAI;MACVZ,CAAC,GAAG,IAAI,CAACyC,QAAQ,CAACjB,UAAU,CAACxB,CAAC;MAC9BC,CAAC,GAAG,IAAI,CAACwC,QAAQ,CAACjB,UAAU,CAACvB,CAAC;MAC9B4F,KAAK;IACNpE,CAAC,CAACG,EAAE,CAAC,GAAG5B,CAAC,GAAG,CAAEA,CAAC,GAAGY,GAAG,GAAI,CAAC,IAAIA,GAAG;IACjCa,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAG3B,CAAC,GAAG,CAAEA,CAAC,GAAGW,GAAG,GAAI,CAAC,IAAIA,GAAG;IACnC,IAAI8C,MAAM,CAAC/B,MAAM,EAAE;MAClB,IAAI1N,IAAI,EAAE;QACTyP,MAAM,CAAC/B,MAAM,GAAG,KAAK;QACrB+B,MAAM,CAACpO,OAAO,CAACgH,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;QACpD,IAAI,CAACS,QAAQ,CAACnG,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;QACnD,IAAI,CAACU,QAAQ,CAACpG,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;MACpD,CAAC,MAAM;QACN6D,KAAK,GAAGvS,IAAI,CAACwO,KAAK,CAACL,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG0I,CAAC,EAAEwB,CAAC,CAAClK,CAAC,CAAC,GAAGyI,CAAC,CAAC;QACxCA,CAAC,GAAG,IAAI,CAAC4F,qBAAqB,GAAGtS,IAAI,CAACqS,GAAG,CAACE,KAAK,CAAC;QAChD5F,CAAC,GAAG,IAAI,CAAC2F,qBAAqB,GAAGtS,IAAI,CAACoS,GAAG,CAACG,KAAK,CAAC;QAChDpE,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,CAAC,GAAGyI,CAAC,IAAIY,GAAG,GAAI,CAAC,IAAIA,GAAG;QACvCa,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG0I,CAAC,IAAIW,GAAG,GAAI,CAAC,IAAIA,GAAG;MAC1C;IAED;IACA,IAAI,CAAChE,MAAM,CAAC,CAAC;EACd;EAEAoG,cAAcA,CAAA,EAAG;IAChB,IAAIU,MAAM,GAAG,IAAI,CAACC,cAAc;MAC/BlC,CAAC,GAAGiC,MAAM,CAACjE,OAAO;MAClBlI,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZqK,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAG4B,CAAC,CAACjK,MAAM,GAAC,CAAC,GAAGD,CAAC,GAAC,CAAC;MAC5CqJ,GAAG,GAAG,IAAI;MACVZ,CAAC,GAAG,IAAI,CAAC0C,QAAQ,CAAClB,UAAU,CAACxB,CAAC;MAC9BC,CAAC,GAAG,IAAI,CAACyC,QAAQ,CAAClB,UAAU,CAACvB,CAAC;MAC9B4F,KAAK;IACNpE,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGyI,CAAC,GAAG,CAAEA,CAAC,GAAGY,GAAG,GAAI,CAAC,IAAIA,GAAG;IAClCa,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG0I,CAAC,GAAG,CAAEA,CAAC,GAAGW,GAAG,GAAI,CAAC,IAAIA,GAAG;IAClC,IAAI8C,MAAM,CAAC/B,MAAM,EAAE;MAClB,IAAI1N,IAAI,EAAE;QACTyP,MAAM,CAAC/B,MAAM,GAAG,KAAK;QACrB+B,MAAM,CAACpO,OAAO,CAACgH,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;QACpD,IAAI,CAACS,QAAQ,CAACnG,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;QACnD,IAAI,CAACU,QAAQ,CAACpG,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC0F,aAAa,CAAC;MACpD,CAAC,MAAM;QACN6D,KAAK,GAAGvS,IAAI,CAACwO,KAAK,CAACL,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG0I,CAAC,EAAEwB,CAAC,CAAClK,CAAC,CAAC,GAAGyI,CAAC,CAAC;QACxCA,CAAC,GAAG,IAAI,CAAC4F,qBAAqB,GAAGtS,IAAI,CAACqS,GAAG,CAACE,KAAK,CAAC;QAChD5F,CAAC,GAAG,IAAI,CAAC2F,qBAAqB,GAAGtS,IAAI,CAACoS,GAAG,CAACG,KAAK,CAAC;QAChDpE,CAAC,CAACG,EAAE,CAAC,GAAG,CAAE,CAACH,CAAC,CAAClK,CAAC,CAAC,GAAGyI,CAAC,IAAIY,GAAG,GAAI,CAAC,IAAIA,GAAG;QACtCa,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAG,CAAE,CAACH,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG0I,CAAC,IAAIW,GAAG,GAAI,CAAC,IAAIA,GAAG;MAC3C;IAED;IACA,IAAI,CAAChE,MAAM,CAAC,CAAC;EACd;EAEAsH,aAAaA,CAACR,MAAM,EAAEoC,OAAO,EAAEC,OAAO,EAAE;IACvC,IAAId,OAAO,GAAG,IAAI,CAAC3N,gBAAgB;MAClCoI,CAAC,GAAGuF,OAAO,CAACzN,MAAM;MAClBoJ,GAAG,GAAG,IAAI;MACVrJ,CAAC;MAAEgI,CAAC;MAAEkC,CAAC;MAAE5K,CAAC;MAAE+K,EAAE;IACf,KAAKrC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGG,CAAC,EAAEH,CAAC,EAAE,EAAE;MACvB1I,CAAC,GAAGoO,OAAO,CAAC1F,CAAC,CAAC;MACdhI,CAAC,GAAGV,CAAC,CAACU,CAAC;MACPkK,CAAC,GAAG5K,CAAC,CAAC4I,OAAO;MACb,IAAIlI,CAAC,EAAE;QACNkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGuO,OAAO,IAAIlF,GAAG,GAAI,CAAC,IAAIA,GAAG;QAC/Ca,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGwO,OAAO,IAAInF,GAAG,GAAI,CAAC,IAAIA,GAAG;MAChD,CAAC,MAAM,IAAI/J,CAAC,CAACgJ,aAAa,EAAE;QAC3B+B,EAAE,GAAGH,CAAC,CAACjK,MAAM,GAAC,CAAC;QACfiK,CAAC,CAACG,EAAE,CAAC,GAAGhK,MAAM,CAAC6J,CAAC,CAACG,EAAE,CAAC,GAAGkE,OAAO,CAAC;QAC/BrE,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGhK,MAAM,CAAC6J,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGmE,OAAO,CAAC;QACnCtE,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGhK,MAAM,CAAC6J,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGkE,OAAO,CAAC;QACnCrE,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGhK,MAAM,CAAC6J,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC,GAAGmE,OAAO,CAAC;MACpC;MACAtE,CAAC,CAAClK,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,CAAC,GAAGuO,OAAO,IAAIlF,GAAG,GAAI,CAAC,IAAIA,GAAG;MAC3Ca,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGwO,OAAO,IAAInF,GAAG,GAAI,CAAC,IAAIA,GAAG;MAC/C,IAAIrJ,CAAC,GAAGkK,CAAC,CAACjK,MAAM,GAAG,CAAC,EAAE;QACrBiK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGuO,OAAO,IAAIlF,GAAG,GAAI,CAAC,IAAIA,GAAG;QAC/Ca,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGwO,OAAO,IAAInF,GAAG,GAAI,CAAC,IAAIA,GAAG;MAChD;MACA,IAAI/J,CAAC,KAAK6M,MAAM,EAAE;QACjB7M,CAAC,CAACvB,OAAO,CAACgH,YAAY,CAAC,WAAW,EAAE,YAAY,GAAImF,CAAC,CAAClK,CAAC,CAAE,GAAG9C,MAAM,GAAIgN,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAE,GAAG,GAAG,CAAC;MACrF;IACD;IACA,IAAI,CAACqF,MAAM,CAAC,CAAC;EACd;EAEA+D,OAAOA,CAACA,OAAO,EAAE;IAChB,IAAI,CAACI,SAAS,CAACvJ,MAAM,EAAE;MACtB,OAAO,IAAI,CAACmH,QAAQ;IACrB;IACA,IAAIpH,CAAC,GAAG,IAAI,CAACiF,QAAQ,CAAChF,MAAM;IAC5B,OAAO,EAAED,CAAC,GAAG,CAAC,CAAC,EAAE;MAChB,IAAI,CAACiF,QAAQ,CAACjF,CAAC,CAAC,CAACiK,UAAU,CAACb,OAAO,CAACA,OAAO,CAAC;IAC7C;IACA,IAAI,CAAChC,QAAQ,GAAGgC,OAAO;IACvB,IAAI,CAAC8B,QAAQ,CAACjB,UAAU,CAACb,OAAO,CAACA,OAAO,CAAC;IACzC,IAAI,CAAC+B,QAAQ,CAAClB,UAAU,CAACb,OAAO,CAACA,OAAO,CAAC;IACzC,IAAI,IAAI,CAACa,UAAU,EAAE;MACpB,IAAI,CAACA,UAAU,CAACb,OAAO,CAACA,OAAO,CAAC;IACjC;IACA,IAAI,CAACA,OAAO,EAAE;MACb,IAAI,CAACrI,QAAQ,CAAC,CAAC;MACf,IAAI,CAAC6J,iBAAiB,CAACxL,UAAU,IAAI,IAAI,CAACwL,iBAAiB,CAACxL,UAAU,CAAC2N,WAAW,CAAC,IAAI,CAACnC,iBAAiB,CAAC;MAC1G,IAAI,CAAChB,UAAU,CAACxK,UAAU,IAAI,IAAI,CAACwK,UAAU,CAACxK,UAAU,CAAC2N,WAAW,CAAC,IAAI,CAACnD,UAAU,CAAC;IACtF,CAAC,MAAM,IAAI,CAAC,IAAI,CAACA,UAAU,CAACxK,UAAU,EAAE;MACvC,IAAI,CAACe,IAAI,CAAChB,eAAe,CAACX,WAAW,CAAC,IAAI,CAACoM,iBAAiB,CAAC;MAC7D,IAAI,CAACzK,IAAI,CAAChB,eAAe,CAACX,WAAW,CAAC,IAAI,CAACoL,UAAU,CAAC;MACtD,IAAI,CAAC5E,IAAI,CAAC,CAAC;MACX,IAAI,CAACgH,UAAU,CAAC,CAAC;IAClB;IACA,IAAI,CAAC5G,cAAc,CAAC,CAAC;IACrB,OAAO,IAAI,CAACC,MAAM,CAAC,CAAC;EACrB;EAEAA,MAAMA,CAACoJ,QAAQ,EAAE;IAChB,IAAIhP,CAAC,GAAG,EAAE;MACT0M,MAAM,GAAG,IAAI,CAACC,cAAc;MAC5BpM,CAAC;MAAEkK,CAAC;MAAEzB,CAAC;MAAEC,CAAC;MAAE2B,EAAE;IACf,IAAIoE,QAAQ,EAAE;MACb,IAAI,CAACzJ,IAAI,CAAC,CAAC;IACZ;IACA,IAAImH,MAAM,EAAE;MACXnM,CAAC,GAAGmM,MAAM,CAACnM,CAAC;MACZkK,CAAC,GAAGiC,MAAM,CAACjE,OAAO;MAClB,IAAIlI,CAAC,IAAImM,MAAM,CAAC7D,aAAa,EAAE;QAC9B+B,EAAE,GAAG8B,MAAM,CAAC7D,aAAa,GAAG4B,CAAC,CAACjK,MAAM,GAAC,CAAC,GAAGD,CAAC,GAAC,CAAC;QAC5CyI,CAAC,GAAGyB,CAAC,CAACG,EAAE,CAAC;QACT3B,CAAC,GAAGwB,CAAC,CAACG,EAAE,GAAC,CAAC,CAAC;QACX,IAAI,CAACa,QAAQ,CAACnG,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG0D,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,GAAG,GAAG,CAAC;QAC5E,IAAI,CAACoC,MAAM,CAAC/F,YAAY,CAAC,QAAQ,EAAE0D,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,GAAGxL,MAAM,GAAGgN,CAAC,CAAClK,CAAC,CAAC,GAAG9C,MAAM,GAAGgN,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,CAAC;MACrF;MACA,IAAIA,CAAC,GAAGkK,CAAC,CAACjK,MAAM,GAAG,CAAC,EAAE;QACrBwI,CAAC,GAAGyB,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC;QACV0I,CAAC,GAAGwB,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC;QACV,IAAI,CAACmL,QAAQ,CAACpG,YAAY,CAAC,WAAW,EAAE,YAAY,GAAI0D,CAAE,GAAGvL,MAAM,GAAIwL,CAAE,GAAG,GAAG,CAAC;QAChF,IAAI,CAACqC,MAAM,CAAChG,YAAY,CAAC,QAAQ,EAAEmF,CAAC,CAAClK,CAAC,CAAC,GAAG9C,MAAM,GAAGgN,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAG9C,MAAM,GAAGuL,CAAC,GAAGvL,MAAM,GAAGwL,CAAC,CAAC;MACrF;IACD;IAEA,IAAI+F,QAAQ,EAAE;MACbhP,CAAC,GAAG,IAAI,CAACU,IAAI,CAACC,YAAY,CAAC,GAAG,CAAC;IAChC,CAAC,MAAM;MACN,KAAKJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACuM,QAAQ,CAACtM,MAAM,EAAED,CAAC,EAAE,EAAE;QAC1CkK,CAAC,GAAG,IAAI,CAACqC,QAAQ,CAACvM,CAAC,CAAC;QACpB,IAAIkK,CAAC,CAACjK,MAAM,GAAG,CAAC,EAAE;UACjBR,CAAC,IAAI,GAAG,GAAGyK,CAAC,CAAC,CAAC,CAAC,GAAGhN,MAAM,GAAGgN,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,CAAC,CAACwE,KAAK,CAAC,CAAC,CAAC,CAACjO,IAAI,CAACvD,MAAM,CAAC;QAChE;MACD;MACA,IAAI,CAACiD,IAAI,CAAC4E,YAAY,CAAC,GAAG,EAAEtF,CAAC,CAAC;MAC9B,IAAI,CAACoL,cAAc,CAAC9F,YAAY,CAAC,GAAG,EAAEtF,CAAC,CAAC;MACxC,IAAI,CAACmL,iBAAiB,CAAC7F,YAAY,CAAC,GAAG,EAAEtF,CAAC,CAAC;IAC5C;IAEA,IAAI,IAAI,CAACoD,IAAI,CAAC8L,QAAQ,IAAI,IAAI,CAACvH,QAAQ,EAAE;MACxC3E,SAAS,CAAC,UAAU,EAAE,IAAI,EAAEhD,CAAC,CAAC;IAC/B;IACA,OAAO,IAAI;EACZ;EAEAmP,UAAUA,CAACC,eAAe,EAAEC,OAAO,EAAEC,OAAO,EAAE;IAC7C,IAAIF,eAAe,EAAE;MACpB,IAAI5P,CAAC,GAAGN,sBAAsB,CAAC,IAAI,CAACwB,IAAI,CAAC;MACzC,OAAOjF,gBAAgB,CAACD,WAAW,CAAC,IAAI,CAACsR,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEtN,CAAC,CAACS,CAAC,IAAIoP,OAAO,IAAI,CAAC,CAAC,EAAE7P,CAAC,CAACU,CAAC,IAAIoP,OAAO,IAAI,CAAC,CAAC,CAAC;IAC5G;IACA,OAAO,IAAI,CAACxC,QAAQ;EACrB;EAEAyC,SAASA,CAACH,eAAe,EAAEC,OAAO,EAAEC,OAAO,EAAE;IAC5C,IAAIF,eAAe,EAAE;MACpB,IAAI5P,CAAC,GAAGN,sBAAsB,CAAC,IAAI,CAACwB,IAAI,CAAC;MACzC,OAAOxF,eAAe,CAACO,gBAAgB,CAACD,WAAW,CAAC,IAAI,CAACsR,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEtN,CAAC,CAACS,CAAC,IAAIoP,OAAO,IAAI,CAAC,CAAC,EAAE7P,CAAC,CAACU,CAAC,IAAIoP,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7H;IACA,OAAO,IAAI,CAAC5O,IAAI,CAACC,YAAY,CAAC,GAAG,CAAC;EACnC;EAEA6O,gBAAgBA,CAACC,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAEC,WAAW,EAAE;IACvD,IAAInF,CAAC,GAAG,IAAI,CAACqC,QAAQ,CAAC,CAAC,CAAC;MACvB+C,EAAE,GAAGpF,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MACdqF,EAAE,GAAIJ,OAAO,KAAK,CAAC,GAAI,CAAC,GAAG,EAAEA,OAAO,IAAIjF,CAAC,CAAC,CAAC,CAAC,CAAC;MAC7C/B,CAAC,GAAG+B,CAAC,CAACjK,MAAM;MACZuP,EAAE,GAAG,CAAC,IAAItF,CAAC,CAAC/B,CAAC,GAAC,CAAC,CAAC,GAAGmH,EAAE,CAAC;MACtBG,EAAE,GAAG,CAACP,MAAM,IAAKhF,CAAC,CAAC/B,CAAC,GAAC,CAAC,CAAC,GAAGoH,EAAG;MAC7BlG,GAAG,GAAG,IAAI;MACVqG,MAAM;MAAE1P,CAAC;MAAE2P,EAAE;MAAEC,EAAE;MAAEC,EAAE;MAAEC,EAAE;IAC1B7S,KAAK,CAACgD,MAAM,GAAG,CAAC;IAChB,IAAIwP,EAAE,EAAE;MAAE;MACTA,EAAE,GAAG,CAAC,GAAGA,EAAE;IACZ,CAAC,MAAM;MAAE;MACRA,EAAE,GAAG,CAACD,EAAE;IACT;IACAA,EAAE,IAAInG,GAAG;IACToG,EAAE,IAAIpG,GAAG;IACT,KAAKrJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,IAAI,CAAC,EAAE;MAC1B/C,KAAK,CAAC+C,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,CAAC,GAAGsP,EAAE,IAAIE,EAAE,GAAI,CAAC,IAAInG,GAAG;MACzCpM,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC,GAAG,CAAE,CAACkK,CAAC,CAAClK,CAAC,GAAC,CAAC,CAAC,GAAGuP,EAAE,IAAIE,EAAE,GAAI,CAAC,IAAIpG,GAAG;IAC9C;IAEA,IAAIgG,WAAW,EAAE;MAChBK,MAAM,GAAG,EAAE;MACXvH,CAAC,GAAGlL,KAAK,CAACgD,MAAM;MAChB,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,IAAE,CAAC,EAAE;QACxB2P,EAAE,GAAG1S,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC;QACf4P,EAAE,GAAG3S,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC;QACf6P,EAAE,GAAG5S,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC;QACf8P,EAAE,GAAG7S,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC;QACf0P,MAAM,CAACvK,IAAI,CAACwK,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,CAAC;QAC3BlV,cAAc,CAAC+U,EAAE,EAAEC,EAAE,EAAE3S,KAAK,CAAC+C,CAAC,CAAC,EAAE/C,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC,EAAE/C,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC,EAAE/C,KAAK,CAAC+C,CAAC,GAAC,CAAC,CAAC,EAAE6P,EAAE,EAAEC,EAAE,EAAE,KAAK,EAAEJ,MAAM,EAAEA,MAAM,CAACzP,MAAM,GAAG,CAAC,CAAC;MAC/G;MACA0P,EAAE,GAAGD,MAAM,CAAC,CAAC,CAAC;MACdvH,CAAC,GAAGuH,MAAM,CAACzP,MAAM;MACjB,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,IAAE,CAAC,EAAE;QACxB6P,EAAE,GAAGH,MAAM,CAAC1P,CAAC,CAAC;QACd,IAAI6P,EAAE,GAAGF,EAAE,IAAIE,EAAE,GAAG,CAAC,IAAIA,EAAE,GAAG,CAAC,EAAE;UAChCR,WAAW,CAAC,CAAC;UACb;QACD;QACAM,EAAE,GAAGE,EAAE;MACR;IACD;IAEA,IAAIT,OAAO,IAAIjH,CAAC,KAAK,CAAC,IAAIlL,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,KAAK,CAACkL,CAAC,GAAC,CAAC,CAAC,KAAK,CAAC,IAAIlL,KAAK,CAACkL,CAAC,GAAC,CAAC,CAAC,KAAK,CAAC,EAAE;MACnG,OAAOlL,KAAK,CAACyR,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACjO,IAAI,CAAC,GAAG,CAAC;IACnC;IACAxD,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,KAAK,CAAC,CAAC,CAAC;IACzB,OAAO,GAAG,GAAGA,KAAK,CAACwD,IAAI,CAAC,GAAG,CAAC;EAC7B;EAEAsP,IAAIA,CAAA,EAAG;IACN,IAAI,CAAC3G,OAAO,CAAC,KAAK,CAAC;IACnB,IAAI,CAACuB,EAAE,CAACvL,UAAU,IAAI,IAAI,CAACuL,EAAE,CAACvL,UAAU,CAAC2N,WAAW,CAAC,IAAI,CAACpC,EAAE,CAAC;EAC9D;EAEAqF,MAAMA,CAAA,EAAG;IACR,IAAI,CAACD,IAAI,CAAC,CAAC;EACZ;AAED;AAMArF,UAAU,CAAC7P,cAAc,GAAGA,cAAc;AAC1C6P,UAAU,CAAC5P,eAAe,GAAGA,eAAe;AAC5C4P,UAAU,CAACuF,WAAW,GAAG,CAACC,IAAI,EAAErN,IAAI,KAAK;EAAG;EAC3C,IAAI9E,OAAO,EAAE2R,MAAM,EAAE1P,CAAC,EAAE2P,EAAE,EAAEE,EAAE,EAAED,EAAE,EAAEE,EAAE,EAAEK,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAElI,CAAC,EAAEmI,eAAe;EACxFzN,IAAI,GAAGA,IAAI,IAAI,CAAC,CAAC;EACjBwN,SAAS,GAAGxN,IAAI,CAACwN,SAAS,IAAI,CAAC;EAC/BD,SAAS,GAAGvN,IAAI,CAACuN,SAAS,IAAK,CAAC,GAAGC,SAAU;EAC7CC,eAAe,GAAG,CAACzN,IAAI,CAACyN,eAAe,KAAKlS,SAAS,GAAG,EAAE,GAAG,CAACyE,IAAI,CAACyN,eAAe,IAAIxU,QAAQ;EAC9F,IAAI,OAAOoU,IAAK,KAAK,QAAQ,EAAE;IAAE;IAChCnS,OAAO,GAAGmS,IAAI;IACdA,IAAI,GAAGnS,OAAO,CAACqC,YAAY,CAAC,GAAG,CAAC;EACjC;EACA,IAAI8P,IAAI,CAACK,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,IAAIL,IAAI,CAACK,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IAAE;IACvDxS,OAAO,GAAGzC,IAAI,CAACkV,aAAa,CAACN,IAAI,CAAC;IAClC,IAAInS,OAAO,EAAE;MACZmS,IAAI,GAAGnS,OAAO,CAACqC,YAAY,CAAC,GAAG,CAAC;IACjC;EACD;EACAsP,MAAM,GAAI7M,IAAI,CAAC4N,MAAM,KAAK,KAAK,IAAI,CAAC,cAAc,CAACC,IAAI,CAACR,IAAI,CAAC,GAAIA,IAAI,CAACS,KAAK,CAACtV,WAAW,CAAC,GAAGX,eAAe,CAACwV,IAAI,CAAC,CAAC,CAAC,CAAC;EACnH,IAAIrN,IAAI,CAAC4N,MAAM,KAAK,KAAK,EAAE;IAC1BN,MAAM,GAAGT,MAAM;IACfA,MAAM,GAAG,EAAE;IACXvH,CAAC,GAAGgI,MAAM,CAAClQ,MAAM;IACjB,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmI,CAAC,EAAEnI,CAAC,IAAE,CAAC,EAAE;MACxB2P,EAAE,GAAG,CAACQ,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC;MACjB4P,EAAE,GAAG,CAACO,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC;MACjB6P,EAAE,GAAG,CAACM,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC;MACjB8P,EAAE,GAAG,CAACK,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC;MACjB0P,MAAM,CAACvK,IAAI,CAAC9E,MAAM,CAACsP,EAAE,CAAC,EAAEtP,MAAM,CAACuP,EAAE,CAAC,EAAEvP,MAAM,CAACwP,EAAE,CAAC,EAAExP,MAAM,CAACyP,EAAE,CAAC,CAAC;MAC3DlV,cAAc,CAAC+U,EAAE,EAAEC,EAAE,EAAE,CAACO,MAAM,CAACnQ,CAAC,CAAC,EAAE,CAACmQ,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC,EAAE,CAACmQ,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC,EAAE,CAACmQ,MAAM,CAACnQ,CAAC,GAAC,CAAC,CAAC,EAAE6P,EAAE,EAAEC,EAAE,EAAE,CAAC,IAAIM,SAAS,GAAG,MAAM,CAAC,EAAEV,MAAM,EAAEA,MAAM,CAACzP,MAAM,GAAG,CAAC,CAAC;IAC1I;IACAyP,MAAM,GAAG5U,eAAe,CAACD,cAAc,CAAC6U,MAAM,EAAEW,SAAS,CAAC,EAAExN,IAAI,CAAC+N,SAAS,EAAEN,eAAe,CAAC;IAC5FZ,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,MAAM,CAAC,CAAC,CAAC;EAC5B,CAAC,MAAM;IACNA,MAAM,GAAG7U,cAAc,CAAC6U,MAAM,EAAEW,SAAS,CAAC;EAC3C;EACAH,IAAI,GAAG,GAAG,GAAGR,MAAM,CAACjP,IAAI,CAAC,GAAG,CAAC;EAC7B,IAAI1C,OAAO,EAAE;IACZA,OAAO,CAACgH,YAAY,CAAC,GAAG,EAAEmL,IAAI,CAAC;EAChC;EACA,OAAOA,IAAI;AACZ,CAAC;AAEDxF,UAAU,CAACmG,MAAM,GAAG,CAACjS,MAAM,EAAEiE,IAAI,KAAK,IAAI6H,UAAU,CAAC9L,MAAM,EAAEiE,IAAI,CAAC;AAElE6H,UAAU,CAACoG,WAAW,GAAGhU,YAAY;AAErC4N,UAAU,CAACqG,eAAe,GAAIlO,IAAI,IAAK;EAAE;EACxC,IAAImO,CAAC,GAAGnO,IAAI,CAACoO,MAAM,IAAI,CAAC;IACvBC,GAAG,GAAG,IAAI;IACVhI,IAAI,GAAIrG,IAAI,CAAC4F,CAAC,IAAI5F,IAAI,CAAC4F,CAAC,KAAK,CAAC,GAAI5F,IAAI,CAAC4F,CAAC,GAAG5F,IAAI,CAACsO,KAAK,GAAG,CAAC,GAAG,CAACD,GAAG;IAChEE,IAAI,GAAIvO,IAAI,CAAC6F,CAAC,IAAI7F,IAAI,CAAC6F,CAAC,KAAK,CAAC,GAAI7F,IAAI,CAAC6F,CAAC,GAAG7F,IAAI,CAACqM,MAAM,GAAG,CAAC,GAAG,CAACgC,GAAG;IACjEjI,IAAI,GAAGC,IAAI,IAAIrG,IAAI,CAACsO,KAAK,IAAID,GAAG,GAACA,GAAG,CAAC;IACrCG,IAAI,GAAGD,IAAI,IAAIvO,IAAI,CAACqM,MAAM,IAAIgC,GAAG,GAACA,GAAG,CAAC;IACtCI,QAAQ,GAAIzO,IAAI,CAACyO,QAAQ,KAAK,KAAM;IACpCC,QAAQ,GAAI1O,IAAI,CAAC0O,QAAQ,KAAK,KAAM;IACpCC,IAAI,GAAG3O,IAAI,CAAC2O,IAAI;IAChBC,IAAI,GAAG5O,IAAI,CAAC6O,QAAQ;EACrBV,CAAC,IAAIA,CAAC;EACN,OAAO/S,CAAC,IAAI;IACX,IAAIwK,CAAC,GAAGxK,CAAC,CAACwK,CAAC;MACVC,CAAC,GAAGzK,CAAC,CAACyK,CAAC;MACPiJ,KAAK;MAAEC,KAAK;MAAEC,EAAE;MAAEC,EAAE;IACrB,IAAKR,QAAQ,IAAI7I,CAAC,GAAGS,IAAI,IAAK,CAAC2I,EAAE,GAAGpJ,CAAC,GAAGS,IAAI,IAAI2I,EAAE,GAAGb,CAAC,EAAE;MACvDvI,CAAC,GAAGS,IAAI;IACT,CAAC,MAAM,IAAKoI,QAAQ,IAAI7I,CAAC,GAAGQ,IAAI,IAAK,CAAC4I,EAAE,GAAG5I,IAAI,GAAGR,CAAC,IAAIoJ,EAAE,GAAGb,CAAC,EAAE;MAC9DvI,CAAC,GAAGQ,IAAI;IACT;IACA,IAAKsI,QAAQ,IAAI7I,CAAC,GAAG0I,IAAI,IAAK,CAACU,EAAE,GAAGpJ,CAAC,GAAG0I,IAAI,IAAIU,EAAE,GAAGd,CAAC,EAAE;MACvDtI,CAAC,GAAG0I,IAAI;IACT,CAAC,MAAM,IAAKG,QAAQ,IAAI7I,CAAC,GAAG2I,IAAI,IAAK,CAACS,EAAE,GAAGT,IAAI,GAAG3I,CAAC,IAAIoJ,EAAE,GAAGd,CAAC,EAAE;MAC9DtI,CAAC,GAAG2I,IAAI;IACT;IACA,IAAIG,IAAI,EAAE;MACTK,EAAE,GAAGpJ,CAAC,GAAG+I,IAAI,CAAC/I,CAAC;MACfqJ,EAAE,GAAGpJ,CAAC,GAAG8I,IAAI,CAAC9I,CAAC;MACf,IAAImJ,EAAE,GAAGA,EAAE,GAAGb,CAAC,EAAE;QAChBvI,CAAC,GAAG+I,IAAI,CAAC/I,CAAC;MACX;MACA,IAAIqJ,EAAE,GAAGA,EAAE,GAAGd,CAAC,EAAE;QAChBtI,CAAC,GAAG8I,IAAI,CAAC9I,CAAC;MACX;IACD;IACA,IAAI+I,IAAI,EAAE;MACTE,KAAK,GAAGzI,IAAI,GAAGnN,IAAI,CAACgW,KAAK,CAAC,CAACtJ,CAAC,GAAGS,IAAI,IAAIuI,IAAI,CAAC,GAAGA,IAAI,CAAC,CAAC;MACrDI,EAAE,GAAGF,KAAK,GAAGlJ,CAAC;MACdmJ,KAAK,GAAGR,IAAI,GAAGrV,IAAI,CAACgW,KAAK,CAAC,CAACrJ,CAAC,GAAG0I,IAAI,IAAIK,IAAI,CAAC,GAAGA,IAAI,CAAC,CAAC;MACrDK,EAAE,GAAGF,KAAK,GAAGlJ,CAAC;MACd,IAAImJ,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,GAAGd,CAAC,EAAE;QAC1BvI,CAAC,GAAGkJ,KAAK;QACTjJ,CAAC,GAAGkJ,KAAK;MACV;IACD;IACA3T,CAAC,CAACwK,CAAC,GAAGA,CAAC;IACPxK,CAAC,CAACyK,CAAC,GAAGA,CAAC;EACR,CAAC;AACF,CAAC;AAEDgC,UAAU,CAACsH,OAAO,GAAG,QAAQ;AAE7BtH,UAAU,CAACuH,QAAQ,GAAG7O,SAAS;AAE/B,SAASsH,UAAU,IAAIwH,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}