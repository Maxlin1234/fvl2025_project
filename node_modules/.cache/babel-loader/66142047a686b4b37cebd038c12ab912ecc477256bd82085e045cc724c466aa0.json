{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  id: \"imageContainer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1);\n}","map":{"version":3,"names":["id","_createElementBlock","_hoisted_1"],"sources":["/Users/linhankuan/fvl2025/src/components/Banner.vue"],"sourcesContent":["<template>\n  <div id=\"imageContainer\">\n  </div>\n</template>\n\n<script>\nimport * as THREE from 'three';\n\nexport default {\n  name: 'Ban-ner',\n  mounted() {\n    const container = this.$el;\n\n    const loader = new THREE.TextureLoader();\n    loader.load(require('@/assets/2025banner.jpg'), (texture) => {\n      initScene(texture);\n    });\n\n    const vertexShader = `\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    `;\n\n    const fragmentShader = `\n      varying vec2 vUv;\n      uniform sampler2D u_texture;\n      uniform vec2 u_mouse;\n      uniform vec2 u_prevMouse;\n      uniform float u_aberrationIntensity;\n      // circle animation uniforms\n      uniform float u_time;\n      uniform vec2 u_circleCenter;      // 以 UV 座標表示 [0..1]\n      uniform float u_circleRadius;     // 圓半徑 (UV)\n      uniform float u_circleEdge;       // 邊緣羽化\n      uniform float u_circleMoveAmp;    // 平移幅度 (UV)\n      uniform float u_circleSpeed;      // 速度\n\n      void main() {\n        // 既有滑鼠位移造成的色差偏移\n        vec2 gridUV = floor(vUv * vec2(20.0)) / vec2(20.0);\n        vec2 centerOfPixel = gridUV + vec2(1.0 / 20.0);\n        vec2 mouseDirection = u_mouse - u_prevMouse;\n        vec2 pixelToMouse = centerOfPixel - u_mouse;\n        float dist = length(pixelToMouse);\n        float strength = smoothstep(0.2, 0.0, dist);\n        vec2 uvOffset = strength * -mouseDirection * 2.5;\n        vec2 uv = vUv - uvOffset;\n\n        // 圓形區域遮罩 (inside: 1 在圓內, 0 在圓外)\n        vec2 toCenter = uv - u_circleCenter;\n        float distC = length(toCenter);\n        float inside = 1.0 - smoothstep(u_circleRadius, u_circleRadius + u_circleEdge, distC);\n\n        // 圓內部的輕微平移 (你也可以改為縮放/脈動)\n        vec2 moveDir = vec2(sin(u_time * u_circleSpeed), cos(u_time * u_circleSpeed));\n        vec2 uvCircle = uv + moveDir * (u_circleMoveAmp * inside);\n\n        // 也可加入輕微脈動縮放效果 (若想啟用，解除下兩行註解並改用 uvCircleScaled 取樣)\n        // float pulse = 1.0 + 0.02 * inside * sin(u_time * (u_circleSpeed * 1.2));\n        // vec2 uvCircleScaled = u_circleCenter + (uvCircle - u_circleCenter) / pulse;\n\n        // 使用加入圓形位移後的 uv 取樣，並維持原本的簡單色差\n        vec4 r = texture2D(u_texture, uvCircle - vec2(strength * u_aberrationIntensity * 0.00, 0.0));\n        vec4 g = texture2D(u_texture, uvCircle + vec2(strength * u_aberrationIntensity * 0.02, 0.0));\n        vec4 b = texture2D(u_texture, uvCircle - vec2(strength * u_aberrationIntensity * 0.01, 0.0));\n\n        gl_FragColor = vec4(r.r, g.g, b.b, 1.0);\n      }\n    `;\n\n    let scene, camera, renderer, plane;\n    const mouse = new THREE.Vector2(0.2, 0.2);\n    const prevMouse = new THREE.Vector2(0.5, 0.5);\n    let aberration = 0;\n    const startTime = performance.now();\n\n    function initScene(texture) {\n      // renderer\n      renderer = new THREE.WebGLRenderer({ alpha: true });\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      renderer.setPixelRatio(window.devicePixelRatio);\n      renderer.domElement.style.position = 'absolute';\n      renderer.domElement.style.inset = '0';\n      container.appendChild(renderer.domElement);\n\n      // scene & camera\n      scene = new THREE.Scene();\n      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10);\n      camera.position.z = 1;\n\n      const uniforms = {\n        u_texture: { value: texture },\n        u_mouse: { value: mouse.clone() },\n        u_prevMouse: { value: prevMouse.clone() },\n        u_aberrationIntensity: { value: 0.0 },\n        // circle animation defaults (可依實際圖片微調 center 與 radius)\n        u_time: { value: 0.0 },\n        u_circleCenter: { value: new THREE.Vector2(0.5, 0.5) },\n        u_circleRadius: { value: 0.18 },\n        u_circleEdge: { value: 0.06 },\n        u_circleMoveAmp: { value: 0.015 },\n        u_circleSpeed: { value: 1.6 }\n      };\n      const fov = (camera.fov * Math.PI) / 180;\n      const height = 2 * Math.tan(fov / 2) * camera.position.z;\n      const width = height * camera.aspect;\n      const geometry = new THREE.PlaneGeometry(width, height);\n\n      const material = new THREE.ShaderMaterial({\n        uniforms,\n        vertexShader,\n        fragmentShader,\n        transparent: true\n      });\n\n      plane = new THREE.Mesh(geometry, material);\n      scene.add(plane);\n\n      animate();\n      window.addEventListener('resize', onResize);\n      container.addEventListener('mousemove', onMouseMove);\n    }\n\n    function onMouseMove(e) {\n      const rect = container.getBoundingClientRect();\n      prevMouse.copy(mouse);\n      mouse.x = (e.clientX - rect.left) / rect.width;\n      mouse.y = 1 - (e.clientY - rect.top) / rect.height;\n      aberration = 1.0;\n    }\n\n    function onResize() {\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n    }\n\n    function animate() {\n      requestAnimationFrame(animate);\n\n      const elapsed = (performance.now() - startTime) * 0.001; // seconds\n      plane.material.uniforms.u_time.value = elapsed;\n\n      plane.material.uniforms.u_mouse.value.copy(mouse);\n      plane.material.uniforms.u_prevMouse.value.copy(prevMouse);\n      aberration = Math.max(0.0, aberration - 0.005);\n      plane.material.uniforms.u_aberrationIntensity.value = aberration;\n\n      renderer.render(scene, camera);\n    }\n  }\n};\n</script>\n\n<style>\n#imageContainer {\n  position: relative;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n}\n\n@media (max-width:768px){\n  #imageContainer {\n    height: 100svh; /* 避免手機瀏覽器 UI 影響顯示高度 */\n  }\n}\n\ncanvas {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  pointer-events: none;\n  position: absolute;\n  display: block;\n  inset: 0;\n}\n</style>\n"],"mappings":";;EACOA,EAAE,EAAC;AAAgB;;uBAAxBC,mBAAA,CACM,OADNC,UACM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}